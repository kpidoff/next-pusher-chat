"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/chat";
exports.ids = ["pages/api/chat"];
exports.modules = {

/***/ "lodash":
/*!*************************!*\
  !*** external "lodash" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("lodash");

/***/ }),

/***/ "moment":
/*!*************************!*\
  !*** external "moment" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("moment");

/***/ }),

/***/ "moment/locale/fr":
/*!***********************************!*\
  !*** external "moment/locale/fr" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("moment/locale/fr");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "next/server":
/*!******************************!*\
  !*** external "next/server" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("next/server");

/***/ }),

/***/ "pusher":
/*!*************************!*\
  !*** external "pusher" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("pusher");

/***/ }),

/***/ "pusher-js":
/*!****************************!*\
  !*** external "pusher-js" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("pusher-js");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

module.exports = require("react");

/***/ }),

/***/ "react/jsx-runtime":
/*!************************************!*\
  !*** external "react/jsx-runtime" ***!
  \************************************/
/***/ ((module) => {

module.exports = require("react/jsx-runtime");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "@mui/icons-material/AttachFile":
/*!*************************************************!*\
  !*** external "@mui/icons-material/AttachFile" ***!
  \*************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/AttachFile");;

/***/ }),

/***/ "@mui/icons-material/Chat":
/*!*******************************************!*\
  !*** external "@mui/icons-material/Chat" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Chat");;

/***/ }),

/***/ "@mui/icons-material/CheckCircle":
/*!**************************************************!*\
  !*** external "@mui/icons-material/CheckCircle" ***!
  \**************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/CheckCircle");;

/***/ }),

/***/ "@mui/icons-material/CheckCircleOutline":
/*!*********************************************************!*\
  !*** external "@mui/icons-material/CheckCircleOutline" ***!
  \*********************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/CheckCircleOutline");;

/***/ }),

/***/ "@mui/icons-material/Close":
/*!********************************************!*\
  !*** external "@mui/icons-material/Close" ***!
  \********************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Close");;

/***/ }),

/***/ "@mui/icons-material/CloseFullscreen":
/*!******************************************************!*\
  !*** external "@mui/icons-material/CloseFullscreen" ***!
  \******************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/CloseFullscreen");;

/***/ }),

/***/ "@mui/icons-material/Download":
/*!***********************************************!*\
  !*** external "@mui/icons-material/Download" ***!
  \***********************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Download");;

/***/ }),

/***/ "@mui/icons-material/Group":
/*!********************************************!*\
  !*** external "@mui/icons-material/Group" ***!
  \********************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Group");;

/***/ }),

/***/ "@mui/icons-material/InsertDriveFile":
/*!******************************************************!*\
  !*** external "@mui/icons-material/InsertDriveFile" ***!
  \******************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/InsertDriveFile");;

/***/ }),

/***/ "@mui/icons-material/KeyboardArrowDown":
/*!********************************************************!*\
  !*** external "@mui/icons-material/KeyboardArrowDown" ***!
  \********************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/KeyboardArrowDown");;

/***/ }),

/***/ "@mui/icons-material/KeyboardArrowUp":
/*!******************************************************!*\
  !*** external "@mui/icons-material/KeyboardArrowUp" ***!
  \******************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/KeyboardArrowUp");;

/***/ }),

/***/ "@mui/icons-material/Link":
/*!*******************************************!*\
  !*** external "@mui/icons-material/Link" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Link");;

/***/ }),

/***/ "@mui/icons-material/Mic":
/*!******************************************!*\
  !*** external "@mui/icons-material/Mic" ***!
  \******************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Mic");;

/***/ }),

/***/ "@mui/icons-material/MoreVert":
/*!***********************************************!*\
  !*** external "@mui/icons-material/MoreVert" ***!
  \***********************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/MoreVert");;

/***/ }),

/***/ "@mui/icons-material/OpenInFull":
/*!*************************************************!*\
  !*** external "@mui/icons-material/OpenInFull" ***!
  \*************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/OpenInFull");;

/***/ }),

/***/ "@mui/icons-material/Pause":
/*!********************************************!*\
  !*** external "@mui/icons-material/Pause" ***!
  \********************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Pause");;

/***/ }),

/***/ "@mui/icons-material/PlayArrow":
/*!************************************************!*\
  !*** external "@mui/icons-material/PlayArrow" ***!
  \************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/PlayArrow");;

/***/ }),

/***/ "@mui/icons-material/Send":
/*!*******************************************!*\
  !*** external "@mui/icons-material/Send" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Send");;

/***/ }),

/***/ "@mui/icons-material/SentimentSatisfiedAlt":
/*!************************************************************!*\
  !*** external "@mui/icons-material/SentimentSatisfiedAlt" ***!
  \************************************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/SentimentSatisfiedAlt");;

/***/ }),

/***/ "@mui/icons-material/Stop":
/*!*******************************************!*\
  !*** external "@mui/icons-material/Stop" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/Stop");;

/***/ }),

/***/ "@mui/icons-material/ZoomIn":
/*!*********************************************!*\
  !*** external "@mui/icons-material/ZoomIn" ***!
  \*********************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/ZoomIn");;

/***/ }),

/***/ "@mui/icons-material/ZoomOut":
/*!**********************************************!*\
  !*** external "@mui/icons-material/ZoomOut" ***!
  \**********************************************/
/***/ ((module) => {

module.exports = import("@mui/icons-material/ZoomOut");;

/***/ }),

/***/ "@mui/material":
/*!********************************!*\
  !*** external "@mui/material" ***!
  \********************************/
/***/ ((module) => {

module.exports = import("@mui/material");;

/***/ }),

/***/ "@mui/material/styles":
/*!***************************************!*\
  !*** external "@mui/material/styles" ***!
  \***************************************/
/***/ ((module) => {

module.exports = import("@mui/material/styles");;

/***/ }),

/***/ "(api)/../../node_modules/.pnpm/next@14.2.28_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cchat%5Cindex.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@14.2.28_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cchat%5Cindex.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/../../node_modules/.pnpm/next@14.2.28_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/../../node_modules/.pnpm/next@14.2.28_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/../../node_modules/.pnpm/next@14.2.28_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\chat\\index.ts */ \"(api)/./pages/api/chat/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/chat\",\n        pathname: \"/api/chat\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL25leHRAMTQuMi4yOF9yZWFjdC1kb21AMTguMy4xX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNoYXQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2NoYXQlNUNpbmRleC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUN5RDtBQUN6RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMscURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHFEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Rlc3QtYXBwLTE0Lz9hODc1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcY2hhdFxcXFxpbmRleC50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXRcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/../../node_modules/.pnpm/next@14.2.28_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cchat%5Cindex.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/chat/index.ts":
/*!*********************************!*\
  !*** ./pages/api/chat/index.ts ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _next_pusher_chat_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @next-pusher-chat/core */ \"(api)/../../packages/next-pusher-chat/dist/index.mjs\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_next_pusher_chat_core__WEBPACK_IMPORTED_MODULE_0__]);\n_next_pusher_chat_core__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        res.status(405).json({\n            error: \"Method not allowed\"\n        });\n        return;\n    }\n    try {\n        const nextRequest = _next_pusher_chat_core__WEBPACK_IMPORTED_MODULE_0__.PagesRouterAdapter.convertRequest(req);\n        const response = await (0,_next_pusher_chat_core__WEBPACK_IMPORTED_MODULE_0__.POST)(nextRequest);\n        if (!response) {\n            res.status(500).json({\n                error: \"No response from Pusher handler\"\n            });\n            return;\n        }\n        await _next_pusher_chat_core__WEBPACK_IMPORTED_MODULE_0__.PagesRouterAdapter.convertResponse(response, res);\n    } catch (error) {\n        console.error(\"Error in chat handler:\", error);\n        res.status(500).json({\n            error: \"Internal Server Error\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvY2hhdC9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUNnRjtBQUVqRSxlQUFlRyxRQUFRQyxHQUFtQixFQUFFQyxHQUFvQjtJQUM5RSxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUMxQkQsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXFCO1FBQ25EO0lBQ0Q7SUFFQSxJQUFJO1FBQ0gsTUFBTUMsY0FBY1Ysc0VBQWtCQSxDQUFDVyxjQUFjLENBQUNQO1FBQ3RELE1BQU1RLFdBQVcsTUFBTVYsNERBQVVBLENBQUNRO1FBRWxDLElBQUksQ0FBQ0UsVUFBVTtZQUNkUCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQWtDO1lBQ2hFO1FBQ0Q7UUFFQSxNQUFNVCxzRUFBa0JBLENBQUNhLGVBQWUsQ0FBQ0QsVUFBVVA7SUFDcEQsRUFBRSxPQUFPSSxPQUFPO1FBQ2ZLLFFBQVFMLEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDSixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBd0I7SUFDdkQ7QUFDRCIsInNvdXJjZXMiOlsid2VicGFjazovL3Rlc3QtYXBwLTE0Ly4vcGFnZXMvYXBpL2NoYXQvaW5kZXgudHM/ZTkyNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcclxuaW1wb3J0IHsgUGFnZXNSb3V0ZXJBZGFwdGVyLCBQT1NUIGFzIFB1c2hlclBPU1QgfSBmcm9tICdAbmV4dC1wdXNoZXItY2hhdC9jb3JlJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcclxuXHRpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XHJcblx0XHRyZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdHRyeSB7XHJcblx0XHRjb25zdCBuZXh0UmVxdWVzdCA9IFBhZ2VzUm91dGVyQWRhcHRlci5jb252ZXJ0UmVxdWVzdChyZXEpO1xyXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQdXNoZXJQT1NUKG5leHRSZXF1ZXN0KTtcclxuXHRcdFxyXG5cdFx0aWYgKCFyZXNwb25zZSkge1xyXG5cdFx0XHRyZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnTm8gcmVzcG9uc2UgZnJvbSBQdXNoZXIgaGFuZGxlcicgfSk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRhd2FpdCBQYWdlc1JvdXRlckFkYXB0ZXIuY29udmVydFJlc3BvbnNlKHJlc3BvbnNlLCByZXMpO1xyXG5cdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjaGF0IGhhbmRsZXI6JywgZXJyb3IpO1xyXG5cdFx0cmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIFNlcnZlciBFcnJvcicgfSk7XHJcblx0fVxyXG59XHJcbiJdLCJuYW1lcyI6WyJQYWdlc1JvdXRlckFkYXB0ZXIiLCJQT1NUIiwiUHVzaGVyUE9TVCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJuZXh0UmVxdWVzdCIsImNvbnZlcnRSZXF1ZXN0IiwicmVzcG9uc2UiLCJjb252ZXJ0UmVzcG9uc2UiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/chat/index.ts\n");

/***/ }),

/***/ "(api)/../../packages/next-pusher-chat/dist/index.mjs":
/*!******************************************************!*\
  !*** ../../packages/next-pusher-chat/dist/index.mjs ***!
  \******************************************************/
/***/ ((__webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(__webpack_module__, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Chat: () => (/* binding */ Chat),\n/* harmony export */   ChatBubble: () => (/* binding */ ChatBubble),\n/* harmony export */   FileItem: () => (/* binding */ FileItem),\n/* harmony export */   NextPusherChatProvider: () => (/* binding */ NextPusherChatProvider),\n/* harmony export */   POST: () => (/* binding */ POST3),\n/* harmony export */   PagesRouterAdapter: () => (/* binding */ PagesRouterAdapter),\n/* harmony export */   getOrCreateSubscription: () => (/* binding */ getOrCreateSubscription),\n/* harmony export */   pusherEvent: () => (/* binding */ pusherEvent),\n/* harmony export */   pusherSubscriptions: () => (/* binding */ pusherSubscriptions),\n/* harmony export */   useChat: () => (/* binding */ useChat),\n/* harmony export */   useChatSubscribe: () => (/* binding */ useChatSubscribe),\n/* harmony export */   useNextPusherChat: () => (/* binding */ useNextPusherChat)\n/* harmony export */ });\n/* harmony import */ var pusher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pusher */ \"pusher\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"(api)/../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm/v4.js\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/server */ \"next/server\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var pusher_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pusher-js */ \"pusher-js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react/jsx-runtime */ \"react/jsx-runtime\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @mui/material */ \"@mui/material\");\n/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @mui/material/styles */ \"@mui/material/styles\");\n/* harmony import */ var _mui_icons_material_KeyboardArrowDown__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @mui/icons-material/KeyboardArrowDown */ \"@mui/icons-material/KeyboardArrowDown\");\n/* harmony import */ var _mui_icons_material_KeyboardArrowUp__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @mui/icons-material/KeyboardArrowUp */ \"@mui/icons-material/KeyboardArrowUp\");\n/* harmony import */ var emoji_picker_react__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! emoji-picker-react */ \"(api)/../../node_modules/.pnpm/emoji-picker-react@4.12.2_react@18.3.1/node_modules/emoji-picker-react/dist/index.js\");\n/* harmony import */ var _mui_icons_material_SentimentSatisfiedAlt__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @mui/icons-material/SentimentSatisfiedAlt */ \"@mui/icons-material/SentimentSatisfiedAlt\");\n/* harmony import */ var _mui_icons_material_AttachFile__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @mui/icons-material/AttachFile */ \"@mui/icons-material/AttachFile\");\n/* harmony import */ var _mui_icons_material_Send__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @mui/icons-material/Send */ \"@mui/icons-material/Send\");\n/* harmony import */ var _mui_icons_material_Mic__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @mui/icons-material/Mic */ \"@mui/icons-material/Mic\");\n/* harmony import */ var _mui_icons_material_Stop__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @mui/icons-material/Stop */ \"@mui/icons-material/Stop\");\n/* harmony import */ var moment_locale_fr__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! moment/locale/fr */ \"moment/locale/fr\");\n/* harmony import */ var _mui_icons_material_Link__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @mui/icons-material/Link */ \"@mui/icons-material/Link\");\n/* harmony import */ var _mui_icons_material_Pause__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @mui/icons-material/Pause */ \"@mui/icons-material/Pause\");\n/* harmony import */ var _mui_icons_material_PlayArrow__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @mui/icons-material/PlayArrow */ \"@mui/icons-material/PlayArrow\");\n/* harmony import */ var _mui_icons_material_Close__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @mui/icons-material/Close */ \"@mui/icons-material/Close\");\n/* harmony import */ var _mui_icons_material_Download__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @mui/icons-material/Download */ \"@mui/icons-material/Download\");\n/* harmony import */ var _mui_icons_material_ZoomIn__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! @mui/icons-material/ZoomIn */ \"@mui/icons-material/ZoomIn\");\n/* harmony import */ var _mui_icons_material_ZoomOut__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! @mui/icons-material/ZoomOut */ \"@mui/icons-material/ZoomOut\");\n/* harmony import */ var _mui_icons_material_InsertDriveFile__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! @mui/icons-material/InsertDriveFile */ \"@mui/icons-material/InsertDriveFile\");\n/* harmony import */ var _mui_icons_material_CheckCircle__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @mui/icons-material/CheckCircle */ \"@mui/icons-material/CheckCircle\");\n/* harmony import */ var _mui_icons_material_CheckCircleOutline__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! @mui/icons-material/CheckCircleOutline */ \"@mui/icons-material/CheckCircleOutline\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! moment */ \"moment\");\n/* harmony import */ var _mui_icons_material_Chat__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! @mui/icons-material/Chat */ \"@mui/icons-material/Chat\");\n/* harmony import */ var _mui_icons_material_CloseFullscreen__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! @mui/icons-material/CloseFullscreen */ \"@mui/icons-material/CloseFullscreen\");\n/* harmony import */ var _mui_icons_material_MoreVert__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! @mui/icons-material/MoreVert */ \"@mui/icons-material/MoreVert\");\n/* harmony import */ var _mui_icons_material_Group__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! @mui/icons-material/Group */ \"@mui/icons-material/Group\");\n/* harmony import */ var _mui_icons_material_OpenInFull__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! @mui/icons-material/OpenInFull */ \"@mui/icons-material/OpenInFull\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_mui_material__WEBPACK_IMPORTED_MODULE_7__, _mui_material_styles__WEBPACK_IMPORTED_MODULE_8__, _mui_icons_material_KeyboardArrowDown__WEBPACK_IMPORTED_MODULE_9__, _mui_icons_material_KeyboardArrowUp__WEBPACK_IMPORTED_MODULE_10__, _mui_icons_material_SentimentSatisfiedAlt__WEBPACK_IMPORTED_MODULE_12__, _mui_icons_material_AttachFile__WEBPACK_IMPORTED_MODULE_13__, _mui_icons_material_Send__WEBPACK_IMPORTED_MODULE_14__, _mui_icons_material_Mic__WEBPACK_IMPORTED_MODULE_15__, _mui_icons_material_Stop__WEBPACK_IMPORTED_MODULE_16__, _mui_icons_material_Link__WEBPACK_IMPORTED_MODULE_18__, _mui_icons_material_Pause__WEBPACK_IMPORTED_MODULE_19__, _mui_icons_material_PlayArrow__WEBPACK_IMPORTED_MODULE_20__, _mui_icons_material_Close__WEBPACK_IMPORTED_MODULE_21__, _mui_icons_material_Download__WEBPACK_IMPORTED_MODULE_22__, _mui_icons_material_ZoomIn__WEBPACK_IMPORTED_MODULE_23__, _mui_icons_material_ZoomOut__WEBPACK_IMPORTED_MODULE_24__, _mui_icons_material_InsertDriveFile__WEBPACK_IMPORTED_MODULE_25__, _mui_icons_material_CheckCircle__WEBPACK_IMPORTED_MODULE_26__, _mui_icons_material_CheckCircleOutline__WEBPACK_IMPORTED_MODULE_27__, _mui_icons_material_Chat__WEBPACK_IMPORTED_MODULE_29__, _mui_icons_material_CloseFullscreen__WEBPACK_IMPORTED_MODULE_30__, _mui_icons_material_MoreVert__WEBPACK_IMPORTED_MODULE_31__, _mui_icons_material_Group__WEBPACK_IMPORTED_MODULE_32__, _mui_icons_material_OpenInFull__WEBPACK_IMPORTED_MODULE_33__]);\n([_mui_material__WEBPACK_IMPORTED_MODULE_7__, _mui_material_styles__WEBPACK_IMPORTED_MODULE_8__, _mui_icons_material_KeyboardArrowDown__WEBPACK_IMPORTED_MODULE_9__, _mui_icons_material_KeyboardArrowUp__WEBPACK_IMPORTED_MODULE_10__, _mui_icons_material_SentimentSatisfiedAlt__WEBPACK_IMPORTED_MODULE_12__, _mui_icons_material_AttachFile__WEBPACK_IMPORTED_MODULE_13__, _mui_icons_material_Send__WEBPACK_IMPORTED_MODULE_14__, _mui_icons_material_Mic__WEBPACK_IMPORTED_MODULE_15__, _mui_icons_material_Stop__WEBPACK_IMPORTED_MODULE_16__, _mui_icons_material_Link__WEBPACK_IMPORTED_MODULE_18__, _mui_icons_material_Pause__WEBPACK_IMPORTED_MODULE_19__, _mui_icons_material_PlayArrow__WEBPACK_IMPORTED_MODULE_20__, _mui_icons_material_Close__WEBPACK_IMPORTED_MODULE_21__, _mui_icons_material_Download__WEBPACK_IMPORTED_MODULE_22__, _mui_icons_material_ZoomIn__WEBPACK_IMPORTED_MODULE_23__, _mui_icons_material_ZoomOut__WEBPACK_IMPORTED_MODULE_24__, _mui_icons_material_InsertDriveFile__WEBPACK_IMPORTED_MODULE_25__, _mui_icons_material_CheckCircle__WEBPACK_IMPORTED_MODULE_26__, _mui_icons_material_CheckCircleOutline__WEBPACK_IMPORTED_MODULE_27__, _mui_icons_material_Chat__WEBPACK_IMPORTED_MODULE_29__, _mui_icons_material_CloseFullscreen__WEBPACK_IMPORTED_MODULE_30__, _mui_icons_material_MoreVert__WEBPACK_IMPORTED_MODULE_31__, _mui_icons_material_Group__WEBPACK_IMPORTED_MODULE_32__, _mui_icons_material_OpenInFull__WEBPACK_IMPORTED_MODULE_33__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\n\n// src/server/api/auth/route.ts\n\nvar pusher = new pusher__WEBPACK_IMPORTED_MODULE_0__({\n  appId: process.env.PUSHER_APP_ID,\n  key: \"49552782eecabba5b112\",\n  secret: process.env.PUSHER_SECRET,\n  cluster: \"eu\"\n});\nasync function POST(request) {\n  const requestData = await request.formData();\n  const socketId = requestData.get(\"socket_id\");\n  const channel = requestData.get(\"channel_name\");\n  const userId = request.headers.get(\"x-user-id\");\n  if (!socketId || !channel || !userId) {\n    return new Response(JSON.stringify({ error: \"Param\\xE8tres manquants\" }), {\n      status: 400,\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n  }\n  try {\n    if (!channel.startsWith(\"private-\")) {\n      return new Response(JSON.stringify({ error: \"Canal non autoris\\xE9\" }), {\n        status: 403,\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n    const auth = pusher.authorizeChannel(socketId, channel);\n    return new Response(JSON.stringify(auth), {\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n  } catch (err) {\n    console.error(\"\\u26A0\\uFE0F Auth failed:\", err);\n    return new Response(\n      JSON.stringify({\n        error: \"\\xC9chec de l'authentification\",\n        details: err instanceof Error ? err.message : \"Inconnu\"\n      }),\n      { status: 401, headers: { \"Content-Type\": \"application/json\" } }\n    );\n  }\n}\n\n// src/server/api/events/route.ts\n\nvar pusher2 = new pusher__WEBPACK_IMPORTED_MODULE_0__({\n  appId: process.env.PUSHER_APP_ID,\n  key: \"49552782eecabba5b112\",\n  secret: process.env.PUSHER_SECRET,\n  cluster: \"eu\"\n});\nasync function POST2(request) {\n  try {\n    const { event, channel, data } = await request.json();\n    if (!event || !channel || !data) {\n      return new Response(JSON.stringify({ error: \"Event, channel, and data are required\" }), {\n        status: 400,\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n    const result = await pusher2.trigger(channel, event, data);\n    return new Response(JSON.stringify(result), {\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n  } catch (error) {\n    console.error(\"Error in POST /api/chat:\", error);\n    return new Response(JSON.stringify({\n      error: \"Internal Server Error\",\n      details: error instanceof Error ? error.message : \"Unknown error\"\n    }), {\n      status: 500,\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n  }\n}\n\n// src/server/api/index.ts\nasync function POST3(request) {\n  const contentType = request.headers.get(\"content-type\") || \"\";\n  if (contentType.includes(\"application/x-www-form-urlencoded\")) {\n    return POST(request);\n  }\n  return POST2(request);\n}\n\n// src/client/utils/logger.ts\nvar Logger = class {\n  constructor() {\n    this.config = {\n      enabled: \"true\" === \"true\",\n      level: \"info\" || 0\n    };\n  }\n  shouldLog(level) {\n    if (!this.config.enabled) return false;\n    const levels = [\"debug\", \"info\", \"warn\", \"error\"];\n    return levels.indexOf(level) >= levels.indexOf(this.config.level);\n  }\n  formatMessage(level, message, ...args) {\n    return `[${level.toUpperCase()}] ${message}`;\n  }\n  debug(message, ...args) {\n    if (this.shouldLog(\"debug\")) {\n      console.debug(this.formatMessage(\"debug\", message), ...args);\n    }\n  }\n  info(message, ...args) {\n    if (this.shouldLog(\"info\")) {\n      console.info(this.formatMessage(\"info\", message), ...args);\n    }\n  }\n  warn(message, ...args) {\n    if (this.shouldLog(\"warn\")) {\n      console.warn(this.formatMessage(\"warn\", message), ...args);\n    }\n  }\n  error(message, ...args) {\n    if (this.shouldLog(\"error\")) {\n      console.error(this.formatMessage(\"error\", message), ...args);\n    }\n  }\n};\nvar logger = new Logger();\n\n// src/server/service/event.ts\n\nvar pusherEvent = async ({ event, conversationId, data, eventId: providedEventId }) => {\n  try {\n    const eventId = providedEventId || (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n    logger.info(`\\u{1F504} Triggering Pusher event [${event}] id [${eventId}] for conversation [${conversationId}]:`, data);\n    const response = await fetch(\"/api/chat\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        channel: `private-${conversationId}`,\n        event,\n        data: __spreadValues({\n          eventId,\n          createdAt: /* @__PURE__ */ new Date()\n        }, data)\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.details || \"Erreur lors de l'envoi de l'\\xE9v\\xE9nement\");\n    }\n    const result = await response.json();\n    return {\n      eventId,\n      data: result\n    };\n  } catch (error) {\n    console.error(\"Error in pusherEvent:\", error);\n    throw error;\n  }\n};\n\n// src/adapters/pages-router.ts\n\nvar PagesRouterAdapter = class {\n  static convertRequest(req) {\n    const origin = req.headers.origin || \"http://localhost:3000\";\n    const url = new URL(req.url, origin);\n    const headers = new Headers();\n    Object.entries(req.headers).forEach(([key, value]) => {\n      if (value) {\n        headers.append(key, Array.isArray(value) ? value.join(\", \") : value);\n      }\n    });\n    let body;\n    const contentType = headers.get(\"content-type\") || \"\";\n    if (contentType.includes(\"application/x-www-form-urlencoded\")) {\n      const formData = new URLSearchParams();\n      if (req.body) {\n        Object.entries(req.body).forEach(([key, value]) => {\n          formData.append(key, String(value));\n        });\n      }\n      body = formData.toString();\n    } else if (req.body) {\n      body = JSON.stringify(req.body);\n    }\n    return new next_server__WEBPACK_IMPORTED_MODULE_2__.NextRequest(url.toString(), {\n      method: req.method || \"GET\",\n      headers,\n      body\n    });\n  }\n  static async convertResponse(response, res) {\n    response.headers.forEach((value, key) => {\n      res.setHeader(key, value);\n    });\n    res.status(response.status);\n    const data = await response.json();\n    res.json(data);\n  }\n};\n\n// src/client/services/chat/event.ts\nvar eventSendMessageEvent = async (conversationId, data) => {\n  const { data: result, eventId } = await pusherEvent({\n    eventId: data.id,\n    event: \"new-message\",\n    conversationId,\n    data: __spreadProps(__spreadValues({}, data), {\n      createdAt: /* @__PURE__ */ new Date()\n    })\n  });\n  return {\n    eventId,\n    data: result\n  };\n};\nvar eventTypingEvent = async (conversationId, data) => {\n  const { data: result, eventId } = await pusherEvent({\n    event: \"user-typing\",\n    conversationId,\n    data\n  });\n  return {\n    eventId,\n    data: result\n  };\n};\nvar eventMessageSeenEvent = async (conversationId, data) => {\n  const { data: result, eventId } = await pusherEvent({\n    event: \"message-seen\",\n    conversationId,\n    data\n  });\n  return {\n    eventId,\n    data: result\n  };\n};\n\n// src/client/hooks/useChatSubscribe.ts\n\n\n// src/client/services/chat/subscribe.ts\nvar processedEventIds = /* @__PURE__ */ new Set();\nvar createChatSubscribes = (pusher3, userId, handlers) => {\n  const activeChannels = /* @__PURE__ */ new Set();\n  const setupConversationSubscribes = (conversationId) => {\n    const channelName = `private-${conversationId}`;\n    if (activeChannels.has(channelName)) {\n      return () => {\n      };\n    }\n    const channel = pusher3.subscribe(channelName);\n    activeChannels.add(channelName);\n    logger.info(`\\u{1F4AC} [Subscribe] Nouveau canal actif: ${channelName}`);\n    channel.bind(\"new-message\", (props) => {\n      var _a;\n      const { eventId, userId: userIdReceived } = props;\n      if (!eventId || processedEventIds.has(eventId) || userIdReceived === userId) {\n        return;\n      }\n      processedEventIds.add(eventId);\n      logger.info(`\\u{1F4AC} [Message] Nouveau message`, props);\n      (_a = handlers == null ? void 0 : handlers.onMessageReceived) == null ? void 0 : _a.call(handlers, props);\n    });\n    channel.bind(\"user-typing\", (props) => {\n      var _a;\n      const { eventId, userId: userIdReceived } = props;\n      if (!eventId || processedEventIds.has(eventId) || userIdReceived === userId || !(handlers == null ? void 0 : handlers.onTypingStatus)) {\n        return;\n      }\n      processedEventIds.add(eventId);\n      logger.info(`\\u{1F4AC} [Typing] Entr\\xE9e de frappe`, props);\n      (_a = handlers == null ? void 0 : handlers.onTypingStatus) == null ? void 0 : _a.call(handlers, props);\n    });\n    channel.bind(\"message-seen\", (props) => {\n      var _a;\n      const { eventId, userId: userIdReceived } = props;\n      if (!eventId || processedEventIds.has(eventId) || userIdReceived === userId || !(handlers == null ? void 0 : handlers.onMessageSeen)) {\n        return;\n      }\n      processedEventIds.add(eventId);\n      logger.info(`\\u{1F4AC} [MessageSeen] Message marqu\\xE9 comme lu`, props);\n      (_a = handlers == null ? void 0 : handlers.onMessageSeen) == null ? void 0 : _a.call(handlers, props);\n    });\n    return () => {\n      channel.unbind_all();\n      pusher3.unsubscribe(channelName);\n      activeChannels.delete(channelName);\n      logger.info(`\\u{1F4AC} [Unsubscribe] Canal ${channelName} d\\xE9sactiv\\xE9`);\n    };\n  };\n  return {\n    setupConversationSubscribes\n  };\n};\n\n// src/client/providers/NextPusherChatProvider.tsx\n\n\n\n// src/client/services/pusher/subscribe.ts\nvar createPusherSubscribes = (pusher3, onConnectionStateChange) => {\n  const setupConnectionSubscribes = () => {\n    const connection = pusher3.connection;\n    connection.bind(\"connected\", () => {\n      logger.info(\"\\u2705 Pusher connect\\xE9 avec succ\\xE8s!\");\n      onConnectionStateChange({\n        isConnected: true,\n        isLoading: false,\n        error: null,\n        connectionState: \"connected\"\n      });\n    });\n    connection.bind(\"connecting\", () => {\n      logger.info(\"\\u{1F504} Tentative de connexion \\xE0 Pusher...\");\n      onConnectionStateChange({\n        isLoading: true,\n        connectionState: \"connecting\"\n      });\n    });\n    connection.bind(\"disconnected\", () => {\n      logger.info(\"\\u274C Pusher d\\xE9connect\\xE9\");\n      onConnectionStateChange({\n        isConnected: false,\n        isLoading: false,\n        connectionState: \"disconnected\"\n      });\n    });\n    connection.bind(\"error\", (err) => {\n      console.error(\"\\u26A0\\uFE0F Erreur de connexion Pusher:\", err);\n      onConnectionStateChange({\n        isConnected: false,\n        isLoading: false,\n        error: err.message || \"Erreur de connexion\",\n        connectionState: \"error\"\n      });\n    });\n    connection.bind(\"state_change\", (states) => {\n      logger.info(\"\\u{1F504} Changement d'\\xE9tat Pusher:\", states);\n    });\n  };\n  return {\n    setupConnectionSubscribes\n  };\n};\n\n// src/client/providers/NextPusherChatProvider.tsx\n\n\nvar PusherContext = (0,react__WEBPACK_IMPORTED_MODULE_3__.createContext)(null);\nvar NextPusherChatProvider = ({\n  userId,\n  options,\n  children\n}) => {\n  const [connectionState, setConnectionState] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(\n    {\n      isConnected: false,\n      isLoading: true,\n      error: null,\n      connectionState: \"initializing\"\n    }\n  );\n  const [pusher3, setPusher] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null);\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    logger.info(\"\\u{1F680} Initialisation de Pusher...\");\n    setConnectionState((prev) => __spreadProps(__spreadValues({}, prev), {\n      isLoading: true,\n      error: null,\n      connectionState: \"connecting\"\n    }));\n    const pusherClient = new pusher_js__WEBPACK_IMPORTED_MODULE_4__(\"49552782eecabba5b112\" || 0, __spreadValues({\n      cluster: \"eu\" || 0,\n      authEndpoint: \"/api/chat\",\n      auth: {\n        headers: {\n          \"X-User-Id\": userId\n        }\n      }\n    }, options));\n    const events = createPusherSubscribes(pusherClient, (newState) => {\n      setConnectionState((prev) => __spreadValues(__spreadValues({}, prev), newState));\n    });\n    events.setupConnectionSubscribes();\n    setPusher(pusherClient);\n    return () => {\n      logger.info(\"\\u{1F44B} D\\xE9connexion de Pusher...\");\n      pusherClient.disconnect();\n    };\n  }, [userId, options]);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(PusherContext.Provider, { value: __spreadProps(__spreadValues({}, connectionState), { pusher: pusher3, userId }), children });\n};\nvar useNextPusherChat = () => {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_3__.useContext)(PusherContext);\n  if (!context) {\n    throw new Error(\n      \"useNextPusherChat doit \\xEAtre utilis\\xE9 \\xE0 l'int\\xE9rieur d'un NextPusherChatProvider\"\n    );\n  }\n  return context;\n};\n\n// src/client/hooks/useChatSubscribe.ts\nvar pusherSubscriptions = /* @__PURE__ */ new Map();\nvar getOrCreateSubscription = (conversationId, pusher3, userId) => {\n  if (!pusherSubscriptions.has(conversationId)) {\n    const events = createChatSubscribes(pusher3, userId, {\n      conversationId,\n      onMessageReceived: (message) => {\n        const subscription = pusherSubscriptions.get(conversationId);\n        if (subscription) {\n          subscription.callbacks.forEach((callback) => {\n            var _a;\n            (_a = callback.onMessageReceived) == null ? void 0 : _a.call(callback, message);\n          });\n        }\n      },\n      onMessageSeen: (messageSeen) => {\n        const subscription = pusherSubscriptions.get(conversationId);\n        if (subscription) {\n          subscription.callbacks.forEach((callback) => {\n            var _a;\n            (_a = callback.onMessageSeen) == null ? void 0 : _a.call(callback, messageSeen);\n          });\n        }\n      },\n      onTypingStatus: (typingStatus) => {\n        const subscription = pusherSubscriptions.get(conversationId);\n        if (subscription) {\n          subscription.callbacks.forEach((callback) => {\n            var _a;\n            (_a = callback.onTypingStatus) == null ? void 0 : _a.call(callback, typingStatus);\n          });\n        }\n      },\n      onError: (error) => {\n        const subscription = pusherSubscriptions.get(conversationId);\n        if (subscription) {\n          subscription.callbacks.forEach((callback) => {\n            var _a;\n            (_a = callback.onError) == null ? void 0 : _a.call(callback, error);\n          });\n        }\n      }\n    });\n    const unsubscribe = events.setupConversationSubscribes(conversationId);\n    pusherSubscriptions.set(conversationId, {\n      unsubscribe,\n      callbacks: /* @__PURE__ */ new Set()\n    });\n  }\n  return pusherSubscriptions.get(conversationId);\n};\nvar useChatSubscribe = ({\n  conversationId,\n  onMessageReceived,\n  onMessageSeen,\n  onTypingStatus,\n  onError\n}) => {\n  const { pusher: pusher3, isConnected, userId } = useNextPusherChat();\n  const callbacksRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)({\n    conversationId,\n    onMessageReceived,\n    onMessageSeen,\n    onTypingStatus,\n    onError\n  });\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    callbacksRef.current = {\n      conversationId,\n      onMessageReceived,\n      onMessageSeen,\n      onTypingStatus,\n      onError\n    };\n  }, [conversationId, onMessageReceived, onMessageSeen, onTypingStatus, onError]);\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    if (!isConnected || !pusher3) return;\n    const subscription = getOrCreateSubscription(conversationId, pusher3, userId);\n    subscription.callbacks.add(callbacksRef.current);\n    logger.info(`\\u{1F504} [ChatSubscribe] Ajout des callbacks pour la conversation ${conversationId}`);\n    return () => {\n      const subscription2 = pusherSubscriptions.get(conversationId);\n      if (subscription2) {\n        subscription2.callbacks.delete(callbacksRef.current);\n        if (subscription2.callbacks.size === 0) {\n          subscription2.unsubscribe();\n          pusherSubscriptions.delete(conversationId);\n          logger.info(`\\u{1F504} [ChatSubscribe] D\\xE9sabonnement Pusher pour la conversation ${conversationId}`);\n        }\n      }\n      logger.info(`\\u{1F504} [ChatSubscribe] Suppression des callbacks pour la conversation ${conversationId}`);\n    };\n  }, [isConnected, conversationId, pusher3, userId]);\n  return {\n    isConnected\n  };\n};\n\n// src/client/hooks/useChat.ts\n\n\nvar useChat = ({ onMessageReceived, onTypingStatus, onError, conversationId, participants, onMessageSeen }) => {\n  const { pusher: pusher3, isConnected, isLoading, error, connectionState, userId } = useNextPusherChat();\n  const callbacksRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)({\n    conversationId,\n    participants,\n    onMessageReceived,\n    onMessageSeen,\n    onTypingStatus,\n    onError\n  });\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    callbacksRef.current = {\n      conversationId,\n      participants,\n      onMessageReceived,\n      onMessageSeen,\n      onTypingStatus,\n      onError\n    };\n  }, [conversationId, participants, onMessageReceived, onMessageSeen, onTypingStatus, onError]);\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    if (!isConnected || !pusher3) return;\n    const subscription = getOrCreateSubscription(conversationId, pusher3, userId);\n    subscription.callbacks.add(callbacksRef.current);\n    logger.info(`\\u{1F504} [Chat] Ajout des callbacks pour la conversation ${conversationId}`);\n    return () => {\n      const subscription2 = pusherSubscriptions.get(conversationId);\n      if (subscription2) {\n        subscription2.callbacks.delete(callbacksRef.current);\n        if (subscription2.callbacks.size === 0) {\n          subscription2.unsubscribe();\n          pusherSubscriptions.delete(conversationId);\n          logger.info(`\\u{1F504} [Chat] D\\xE9sabonnement Pusher pour la conversation ${conversationId}`);\n        }\n      }\n      logger.info(`\\u{1F504} [Chat] Suppression des callbacks pour la conversation ${conversationId}`);\n    };\n  }, [isConnected, conversationId, pusher3, userId]);\n  const sendMessage = (message) => {\n    var _a;\n    return eventSendMessageEvent(conversationId, {\n      userId,\n      content: message.content,\n      attachmentsCount: ((_a = message.attachments) == null ? void 0 : _a.length) || 0,\n      id: message.id\n    });\n  };\n  const prepareMessage = ({ content, attachments }) => {\n    const eventId = generateUUID();\n    return {\n      eventId,\n      data: {\n        userId,\n        content,\n        attachmentsCount: (attachments == null ? void 0 : attachments.length) || 0,\n        createdAt: /* @__PURE__ */ new Date()\n      }\n    };\n  };\n  const updateTypingStatus = (isTyping) => {\n    return eventTypingEvent(conversationId, {\n      userId,\n      isTyping\n    });\n  };\n  const getParticipant = (id) => {\n    return participants.find((participant) => participant.id === id) || {\n      id: \"unknown\",\n      name: \"Unknown\"\n    };\n  };\n  const generateUUID = () => {\n    return (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n  };\n  const markMessageAsSeen = (messageId) => {\n    return eventMessageSeenEvent(conversationId, {\n      userId,\n      seenAt: /* @__PURE__ */ new Date()\n    });\n  };\n  return {\n    sendMessage,\n    prepareMessage,\n    updateTypingStatus,\n    getParticipant,\n    markMessageAsSeen,\n    connection: {\n      isConnected,\n      isLoading,\n      error,\n      connectionState\n    }\n  };\n};\n\n// src/client/contexts/ChatContext.tsx\n\n\n// src/client/constants/constants.ts\nvar DEFAULT_CHAT_CONFIG = {\n  activeEmoji: true,\n  activeFile: true,\n  activeVoice: true,\n  activeUserColor: true,\n  welcomeMessage: \"Bienvenue dans la conversation\",\n  typingTimeout: 1e4,\n  numberOfMessagesToLoad: 30\n};\n\n// src/client/contexts/ChatContext.tsx\n\n\n// src/client/utils/config.ts\nvar mergeConfigWithDefaults = (config) => {\n  return __spreadValues(__spreadValues({}, DEFAULT_CHAT_CONFIG), config);\n};\n\n// src/client/contexts/ChatContext.tsx\n\nvar ChatContext = (0,react__WEBPACK_IMPORTED_MODULE_3__.createContext)(void 0);\nvar useChatContext = () => {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_3__.useContext)(ChatContext);\n  if (!context) {\n    throw new Error(\"useChatContext must be used within a ChatProvider\");\n  }\n  return context;\n};\nvar ChatProvider = ({\n  conversationId,\n  defaultMessages,\n  participants,\n  config,\n  isLoading,\n  totalMessages,\n  onReceiveMessage,\n  onSendMessage,\n  onMessageSeen,\n  onLoadMoreMessages,\n  children\n}) => {\n  const mergedConfig = (0,react__WEBPACK_IMPORTED_MODULE_3__.useMemo)(\n    () => mergeConfigWithDefaults(config || DEFAULT_CHAT_CONFIG),\n    [config]\n  );\n  const [messages, setMessages] = react__WEBPACK_IMPORTED_MODULE_3__.useState([]);\n  const [loadingSendMessage, setLoadingSendMessage] = react__WEBPACK_IMPORTED_MODULE_3__.useState(false);\n  const [loadingMore, setLoadingMore] = react__WEBPACK_IMPORTED_MODULE_3__.useState(false);\n  const [hasMore, setHasMore] = react__WEBPACK_IMPORTED_MODULE_3__.useState(true);\n  const [typingUsers, setTypingUsers] = react__WEBPACK_IMPORTED_MODULE_3__.useState([]);\n  const [isAtBottom, setIsAtBottom] = react__WEBPACK_IMPORTED_MODULE_3__.useState(true);\n  const { userId } = useNextPusherChat();\n  const contentRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef(null);\n  const [shouldScrollToBottom, setShouldScrollToBottom] = react__WEBPACK_IMPORTED_MODULE_3__.useState(false);\n  const SCROLL_THRESHOLD = 10;\n  const scrollTimeoutRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef();\n  const lastMessageSeenRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n  const isProcessingRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(false);\n  const scrollToBottom = react__WEBPACK_IMPORTED_MODULE_3__.useCallback(\n    (behavior = \"smooth\") => {\n      if (contentRef.current) {\n        const images = contentRef.current.getElementsByTagName(\"img\");\n        const imageLoadPromises = Array.from(images).map((img) => {\n          if (img.complete) return Promise.resolve();\n          return new Promise((resolve) => {\n            img.onload = resolve;\n            img.onerror = resolve;\n          });\n        });\n        Promise.all(imageLoadPromises).then(() => {\n          var _a;\n          (_a = contentRef.current) == null ? void 0 : _a.scrollTo({\n            top: contentRef.current.scrollHeight,\n            behavior\n          });\n        });\n      }\n    },\n    []\n  );\n  const handleScroll = react__WEBPACK_IMPORTED_MODULE_3__.useCallback(() => {\n    if (!contentRef.current) return;\n    if (scrollTimeoutRef.current) {\n      clearTimeout(scrollTimeoutRef.current);\n    }\n    scrollTimeoutRef.current = setTimeout(() => {\n      const { scrollTop, scrollHeight, clientHeight } = contentRef.current;\n      const isBottom = Math.abs(scrollHeight - scrollTop - clientHeight) < SCROLL_THRESHOLD;\n      setIsAtBottom(isBottom);\n    }, 100);\n  }, []);\n  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(() => {\n    const content = contentRef.current;\n    if (content) {\n      content.addEventListener(\"scroll\", handleScroll);\n      return () => {\n        content.removeEventListener(\"scroll\", handleScroll);\n        if (scrollTimeoutRef.current) {\n          clearTimeout(scrollTimeoutRef.current);\n        }\n      };\n    }\n  }, [handleScroll]);\n  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(() => {\n    if (shouldScrollToBottom) {\n      requestAnimationFrame(() => {\n        scrollToBottom();\n      });\n      setShouldScrollToBottom(false);\n    }\n  }, [shouldScrollToBottom, scrollToBottom]);\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    if (messages.length === 0 && defaultMessages) {\n      setMessages(defaultMessages);\n    }\n  }, [defaultMessages]);\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    logger.info(\"[ChatContext] Liste des messages\", {\n      messages\n    });\n  }, [messages]);\n  const {\n    prepareMessage,\n    sendMessage: sendPusherMessage,\n    updateTypingStatus: updatePusherTypingStatus,\n    getParticipant,\n    markMessageAsSeen\n  } = useChat({\n    conversationId,\n    participants,\n    onTypingStatus: ({ isTyping, userId: userId2 }) => {\n      setTypingUsers(\n        (prev) => isTyping ? [...prev, userId2] : prev.filter((id) => id !== userId2)\n      );\n    },\n    onMessageReceived: (props) => {\n      const { userId: userIdReceived, eventId } = props;\n      if (userIdReceived !== userId) {\n        onReceiveMessage == null ? void 0 : onReceiveMessage(eventId, __spreadProps(__spreadValues({}, props), {\n          user: getParticipant(userIdReceived),\n          id: eventId\n        })).then((message) => {\n          setMessages((prev) => {\n            const newMessages = [...prev, message];\n            if (isAtBottom) {\n              setShouldScrollToBottom(true);\n            }\n            return newMessages.slice(\n              -((mergedConfig == null ? void 0 : mergedConfig.numberOfMessagesToLoad) || 30)\n            );\n          });\n        });\n      }\n    },\n    onMessageSeen: (messageSeen) => {\n      const { userId: seenByUserId } = messageSeen;\n      const seenAt = /* @__PURE__ */ new Date();\n      setMessages(\n        (prevMessages) => prevMessages.map((message) => {\n          var _a;\n          if ((_a = message.seenBy) == null ? void 0 : _a.some((seen) => seen.userId === seenByUserId)) {\n            return message;\n          }\n          return __spreadProps(__spreadValues({}, message), {\n            seenBy: [\n              ...message.seenBy || [],\n              {\n                userId: seenByUserId,\n                seenAt\n              }\n            ]\n          });\n        })\n      );\n    }\n  });\n  const sendMessage = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(\n    async (props) => {\n      const { content, attachments, createdAt } = props;\n      if (!content.trim() && !(attachments == null ? void 0 : attachments.length)) return;\n      try {\n        setLoadingSendMessage(true);\n        const { data, eventId } = prepareMessage(props);\n        const updatedMessage = await onSendMessage({\n          conversationId,\n          eventId,\n          message: __spreadProps(__spreadValues(__spreadValues({\n            id: eventId\n          }, data), props), {\n            userId,\n            createdAt\n          })\n        });\n        await sendPusherMessage(__spreadProps(__spreadValues(__spreadValues({}, data), props), {\n          id: eventId,\n          userId,\n          createdAt\n        }));\n        setMessages((prev) => {\n          const newMessages = [...prev, updatedMessage];\n          setShouldScrollToBottom(true);\n          return newMessages.slice(\n            -((mergedConfig == null ? void 0 : mergedConfig.numberOfMessagesToLoad) || 30)\n          );\n        });\n      } catch (error) {\n        console.error(\"Erreur lors de l'envoi du message:\", error);\n      } finally {\n        setLoadingSendMessage(false);\n      }\n    },\n    [\n      prepareMessage,\n      sendPusherMessage,\n      onSendMessage,\n      userId,\n      mergedConfig == null ? void 0 : mergedConfig.numberOfMessagesToLoad\n    ]\n  );\n  const loadMoreMessages = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(async () => {\n    if (!onLoadMoreMessages || loadingMore || !hasMore) {\n      return;\n    }\n    const oldestMessage = messages[0];\n    if (!oldestMessage) {\n      setHasMore(false);\n      return;\n    }\n    try {\n      setLoadingMore(true);\n      const olderMessages = await onLoadMoreMessages({\n        oldestMessageId: oldestMessage.id,\n        previousMessages: messages\n      });\n      logger.info(\"[ChatContext] On recup\\xE8re les messages plus anciens\", {\n        olderMessages\n      });\n      if (!olderMessages || olderMessages.length === 0) {\n        setHasMore(false);\n        logger.info(\"[ChatContext] On n'a plus de messages\", {\n          olderMessages\n        });\n        return;\n      }\n      logger.info(\"[ChatContext] On a des messages plus anciens\", {\n        olderMessages,\n        messages\n      });\n      setMessages((prevMessages) => lodash__WEBPACK_IMPORTED_MODULE_6__.concat(olderMessages, prevMessages));\n    } catch (error) {\n      console.error(\n        \"Erreur lors du chargement des messages plus anciens:\",\n        error\n      );\n      setHasMore(false);\n    } finally {\n      setLoadingMore(false);\n    }\n  }, [onLoadMoreMessages, loadingMore, hasMore, messages]);\n  const markLastMessageAsSeen = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(\n    (message) => {\n      if (isProcessingRef.current || lastMessageSeenRef.current === message.id || message.userId === userId) {\n        return;\n      }\n      if (!lodash__WEBPACK_IMPORTED_MODULE_6__.find(message.seenBy, { userId })) {\n        isProcessingRef.current = true;\n        lastMessageSeenRef.current = message.id;\n        markMessageAsSeen(message.id);\n        onMessageSeen == null ? void 0 : onMessageSeen({ lastMessage: message, conversationId, userId });\n        isProcessingRef.current = false;\n      }\n    },\n    [userId, conversationId, markMessageAsSeen, onMessageSeen]\n  );\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    if (!messages.length || !onMessageSeen) {\n      return;\n    }\n    const lastMessage = messages[messages.length - 1];\n    markLastMessageAsSeen(lastMessage);\n  }, [messages, markLastMessageAsSeen]);\n  const scrollManager = {\n    contentRef,\n    scrollToBottom,\n    isAtBottom\n  };\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n    ChatContext.Provider,\n    {\n      value: {\n        userId,\n        messages,\n        loadingSendMessage,\n        loadingMore,\n        hasMore,\n        typingUsers,\n        participants,\n        config: mergedConfig,\n        isLoading,\n        totalMessages,\n        sendMessage,\n        loadMoreMessages,\n        updateTypingStatus: updatePusherTypingStatus,\n        getParticipant,\n        scrollManager,\n        currentMessagesCount: messages.length\n      },\n      children\n    }\n  );\n};\n\n// src/client/components/Chat/style.ts\n\n\nvar Content = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  flex: 1,\n  padding: theme.spacing(2),\n  overflowY: \"auto\",\n  backgroundColor: theme.palette.background.paper,\n  \"&::-webkit-scrollbar\": {\n    width: \"8px\"\n  },\n  \"&::-webkit-scrollbar-track\": {\n    background: theme.palette.background.default,\n    borderRadius: \"4px\"\n  },\n  \"&::-webkit-scrollbar-thumb\": {\n    background: theme.palette.primary.main,\n    borderRadius: \"4px\",\n    \"&:hover\": {\n      background: theme.palette.primary.dark\n    }\n  }\n}));\nvar WaitingMessageContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  padding: theme.spacing(4),\n  textAlign: \"center\",\n  color: theme.palette.text.secondary,\n  gap: theme.spacing(2)\n}));\nvar WaitingMessageEmoji = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  fontSize: \"3rem\",\n  marginBottom: theme.spacing(2)\n}));\nvar WaitingMessageTitle = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  fontSize: \"1.5rem\",\n  margin: 0,\n  color: theme.palette.text.primary\n}));\nvar WaitingMessageText = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  fontSize: \"1rem\",\n  maxWidth: \"400px\",\n  lineHeight: 1.5\n}));\n\n// src/client/components/Chat/components/ChatActions/style.ts\n\n\nvar ActionsContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  position: \"relative\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  gap: theme.spacing(1),\n  zIndex: 1\n}));\nvar ScrollButton = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Button)(({ theme }) => ({\n  position: \"absolute\",\n  bottom: theme.spacing(2),\n  right: theme.spacing(2),\n  backgroundColor: theme.palette.primary.main,\n  color: theme.palette.primary.contrastText,\n  \"&:hover\": {\n    backgroundColor: theme.palette.primary.dark\n  },\n  boxShadow: theme.shadows[2],\n  width: \"40px\",\n  height: \"40px\",\n  minWidth: \"40px\",\n  padding: 0,\n  borderRadius: \"50%\",\n  backdropFilter: \"blur(8px)\",\n  border: `1px solid ${theme.palette.primary.dark}33`,\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\"\n}));\n\n// src/client/components/Chat/components/ChatActions/index.tsx\n\n\n\n\nvar ChatActions = () => {\n  const { scrollManager } = useChatContext();\n  const { scrollToBottom, isAtBottom } = scrollManager;\n  const [showButton, setShowButton] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    let timeoutId;\n    if (!isAtBottom) {\n      timeoutId = setTimeout(() => {\n        setShowButton(true);\n      }, 500);\n    } else {\n      timeoutId = setTimeout(() => {\n        setShowButton(false);\n      }, 100);\n    }\n    return () => {\n      clearTimeout(timeoutId);\n    };\n  }, [isAtBottom]);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ActionsContainer, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Fade, { in: showButton, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n    ScrollButton,\n    {\n      onClick: () => scrollToBottom(\"smooth\"),\n      variant: \"contained\",\n      children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_KeyboardArrowDown__WEBPACK_IMPORTED_MODULE_9__[\"default\"], {})\n    }\n  ) }) });\n};\n\n// src/client/components/Chat/components/LoadMoreMessages/style.ts\n\n\nvar LoadMoreContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  justifyContent: \"center\",\n  padding: theme.spacing(2)\n}));\nvar LoadMoreButton = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Button)(({ theme }) => ({\n  borderRadius: \"20px\",\n  textTransform: \"none\",\n  minWidth: \"150px\",\n  maxWidth: \"100%\",\n  fontSize: \"0.9rem\",\n  padding: \"6px 16px\",\n  [theme.breakpoints.up(\"sm\")]: {\n    minWidth: \"180px\",\n    fontSize: \"0.9rem\",\n    padding: \"6px 16px\"\n  },\n  [theme.breakpoints.down(\"sm\")]: {\n    minWidth: \"150px\",\n    fontSize: \"0.8rem\",\n    padding: \"4px 8px\"\n  }\n}));\n\n// src/client/components/Chat/components/LoadMoreMessages/index.tsx\n\n\n\n\nvar LoadMoreMessages = () => {\n  const {\n    isLoading,\n    loadingMore,\n    hasMore,\n    totalMessages,\n    currentMessagesCount,\n    loadMoreMessages,\n    scrollManager\n  } = useChatContext();\n  const previousScrollHeight = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(0);\n  const previousScrollTop = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(0);\n  const handleLoadMore = async () => {\n    if (scrollManager.contentRef.current) {\n      previousScrollHeight.current = scrollManager.contentRef.current.scrollHeight;\n      previousScrollTop.current = scrollManager.contentRef.current.scrollTop;\n    }\n    await loadMoreMessages();\n    if (scrollManager.contentRef.current) {\n      requestAnimationFrame(() => {\n        var _a;\n        const newScrollHeight = ((_a = scrollManager.contentRef.current) == null ? void 0 : _a.scrollHeight) || 0;\n        const scrollDiff = newScrollHeight - previousScrollHeight.current;\n        if (scrollManager.contentRef.current) {\n          scrollManager.contentRef.current.scrollTop = previousScrollTop.current + scrollDiff;\n        }\n      });\n    }\n  };\n  if (!hasMore || isLoading || totalMessages !== void 0 && currentMessagesCount >= totalMessages)\n    return null;\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(LoadMoreContainer, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n    LoadMoreButton,\n    {\n      variant: \"outlined\",\n      onClick: handleLoadMore,\n      disabled: loadingMore,\n      startIcon: loadingMore ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.CircularProgress, { size: 20 }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_KeyboardArrowUp__WEBPACK_IMPORTED_MODULE_10__[\"default\"], {}),\n      children: loadingMore ? \"Chargement...\" : \"Messages plus anciens\"\n    }\n  ) });\n};\n\n// src/client/components/Chat/components/MessageInput/style.ts\n\n\nvar InputContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  padding: theme.spacing(1),\n  borderTop: `1px solid ${theme.palette.divider}`,\n  background: theme.palette.background.paper,\n  display: \"flex\",\n  alignItems: \"center\",\n  gap: theme.spacing(0.5),\n  [theme.breakpoints.up(\"sm\")]: {\n    padding: theme.spacing(1.5),\n    gap: theme.spacing(1)\n  }\n}));\nvar StyledInput = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.InputBase)(({ theme }) => ({\n  flex: 1,\n  padding: theme.spacing(0.5, 1),\n  backgroundColor: theme.palette.background.default,\n  borderRadius: 20,\n  fontSize: \"0.9rem\",\n  \"& input\": {\n    padding: theme.spacing(0.5, 0)\n  },\n  [theme.breakpoints.up(\"sm\")]: {\n    padding: theme.spacing(0.5, 1.5)\n  }\n}));\n\n// src/client/components/Chat/components/MessageInput/index.tsx\n\n\n\n\n// src/client/components/Chat/components/EmojiPicker/index.tsx\n\n\n\n\n\nvar EmojiPickerComponent = ({\n  onEmojiClick,\n  disabled = false\n}) => {\n  const [anchorEl, setAnchorEl] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null);\n  const handleClick = (event) => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n  const handleEmojiClick = (emojiData) => {\n    onEmojiClick(emojiData.emoji);\n    handleClose();\n  };\n  const open = Boolean(anchorEl);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton,\n      {\n        disabled,\n        onClick: handleClick,\n        size: \"small\",\n        sx: {\n          color: \"text.secondary\",\n          \"&:hover\": {\n            color: \"primary.main\"\n          }\n        },\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_SentimentSatisfiedAlt__WEBPACK_IMPORTED_MODULE_12__[\"default\"], {})\n      }\n    ),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.Popover,\n      {\n        open,\n        anchorEl,\n        onClose: handleClose,\n        anchorOrigin: {\n          vertical: \"top\",\n          horizontal: \"right\"\n        },\n        transformOrigin: {\n          vertical: \"bottom\",\n          horizontal: \"left\"\n        },\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          emoji_picker_react__WEBPACK_IMPORTED_MODULE_11__,\n          {\n            onEmojiClick: handleEmojiClick,\n            width: 300,\n            height: 400,\n            searchPlaceholder: \"Rechercher un emoji...\"\n          }\n        )\n      }\n    )\n  ] });\n};\nvar EmojiPicker_default = EmojiPickerComponent;\n\n// src/client/components/Chat/components/FileList/index.tsx\n\n\nvar FileList = ({ attachments, onRemoveFile }) => {\n  if (attachments.length === 0) return null;\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n    _mui_material__WEBPACK_IMPORTED_MODULE_7__.Box,\n    {\n      sx: {\n        display: \"flex\",\n        flexWrap: \"wrap\",\n        gap: 1,\n        p: 1,\n        borderBottom: \"1px solid\",\n        borderColor: \"divider\"\n      },\n      children: attachments.map((attachment, index) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        _mui_material__WEBPACK_IMPORTED_MODULE_7__.Chip,\n        {\n          label: attachment.name,\n          onDelete: () => onRemoveFile(attachment),\n          size: \"small\",\n          sx: {\n            maxWidth: 200,\n            position: \"relative\",\n            zIndex: 1,\n            \"&:hover\": {\n              zIndex: 2\n            },\n            \"& .MuiChip-label\": {\n              overflow: \"hidden\",\n              textOverflow: \"ellipsis\",\n              whiteSpace: \"nowrap\"\n            },\n            \"& .MuiChip-deleteIcon\": {\n              zIndex: 3\n            }\n          }\n        },\n        index\n      ))\n    }\n  );\n};\nvar FileList_default = FileList;\n\n// src/client/components/Chat/components/FilePicker/index.tsx\n\n\n\n\nfunction FilePicker({\n  onFilesSelect,\n  disabled = false\n}) {\n  const [anchorEl, setAnchorEl] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null);\n  const fileInputRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n  const handleClick = (event) => {\n    var _a;\n    setAnchorEl(event.currentTarget);\n    (_a = fileInputRef.current) == null ? void 0 : _a.click();\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n  const handleFileChange = (event) => {\n    const attachments = event.target.files;\n    if (attachments && attachments.length > 0) {\n      onFilesSelect(Array.from(attachments));\n    }\n    handleClose();\n  };\n  const open = Boolean(anchorEl);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      \"input\",\n      {\n        type: \"file\",\n        ref: fileInputRef,\n        onChange: handleFileChange,\n        multiple: true,\n        style: { display: \"none\" }\n      }\n    ),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton,\n      {\n        onClick: handleClick,\n        size: \"small\",\n        sx: {\n          color: \"text.secondary\",\n          \"&:hover\": {\n            color: \"primary.main\"\n          }\n        },\n        disabled,\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_AttachFile__WEBPACK_IMPORTED_MODULE_13__[\"default\"], {})\n      }\n    )\n  ] });\n}\n\n// src/client/components/Chat/components/MessageInput/index.tsx\n\n\n// src/client/components/Chat/components/VoiceRecorder/index.tsx\n\n\n\n\n\nfunction VoiceRecorder({\n  onRecordingComplete,\n  disabled = false\n}) {\n  const [isRecording, setIsRecording] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const [recordingTime, setRecordingTime] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(0);\n  const mediaRecorderRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n  const timerRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)();\n  const audioChunksRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)([]);\n  const startRecording = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      const mediaRecorder = new MediaRecorder(stream);\n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n      mediaRecorder.ondataavailable = (event) => {\n        if (event.data.size > 0) {\n          audioChunksRef.current.push(event.data);\n        }\n      };\n      mediaRecorder.onstop = () => {\n        const audioBlob = new Blob(audioChunksRef.current, {\n          type: \"audio/webm\"\n        });\n        onRecordingComplete(audioBlob);\n        stream.getTracks().forEach((track) => track.stop());\n        setRecordingTime(0);\n      };\n      mediaRecorder.start();\n      setIsRecording(true);\n      timerRef.current = setInterval(() => {\n        setRecordingTime((prev) => prev + 1);\n      }, 1e3);\n    } catch (error) {\n      console.error(\"Erreur lors de l'acc\\xE8s au microphone:\", error);\n    }\n  };\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n    }\n  };\n  const formatTime2 = (seconds) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n  };\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { display: \"flex\", alignItems: \"center\", gap: 1 }, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton,\n      {\n        onClick: isRecording ? stopRecording : startRecording,\n        size: \"small\",\n        sx: {\n          color: isRecording ? \"error.main\" : \"text.secondary\",\n          \"&:hover\": {\n            color: isRecording ? \"error.dark\" : \"primary.main\"\n          }\n        },\n        disabled,\n        children: isRecording ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Stop__WEBPACK_IMPORTED_MODULE_16__[\"default\"], {}) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Mic__WEBPACK_IMPORTED_MODULE_15__[\"default\"], {})\n      }\n    ),\n    isRecording && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { display: \"flex\", alignItems: \"center\", gap: 1 }, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.CircularProgress, { size: 16, color: \"error\" }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\"span\", { style: { fontSize: \"0.8rem\", color: \"error.main\" }, children: formatTime2(recordingTime) })\n    ] })\n  ] });\n}\n\n// src/client/components/Chat/components/MessageInput/index.tsx\n\nfunction MessageInput() {\n  const { sendMessage, updateTypingStatus, config, loadingSendMessage } = useChatContext();\n  const inputRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n  const [message, setMessage] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(\"\");\n  const [isTyping, setIsTyping] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const typingTimeoutRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)();\n  const isTypingDisabledRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(false);\n  const [selectedFiles, setSelectedFiles] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)([]);\n  const clearTypingTimeout = () => {\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n  };\n  const handleSend = () => {\n    const trimmedMessage = message.trim();\n    if (trimmedMessage.trim() || selectedFiles.length > 0) {\n      clearTypingTimeout();\n      isTypingDisabledRef.current = true;\n      setIsTyping(false);\n      updateTypingStatus(false);\n      sendMessage({\n        content: trimmedMessage,\n        attachments: selectedFiles,\n        createdAt: /* @__PURE__ */ new Date()\n      }).finally(() => {\n        setMessage(\"\");\n        setSelectedFiles([]);\n        setTimeout(() => {\n          var _a;\n          (_a = inputRef.current) == null ? void 0 : _a.focus();\n        }, 0);\n      });\n    }\n  };\n  const handleKeyPress = (event) => {\n    if (event.key === \"Enter\" && !event.ctrlKey && !event.shiftKey) {\n      event.preventDefault();\n      handleSend();\n    }\n  };\n  const handleEmojiClick = (emoji) => {\n    setMessage((prev) => prev + emoji);\n  };\n  const handleMessageChange = (e) => {\n    const newValue = e.target.value;\n    const capitalizedValue = newValue.charAt(0).toUpperCase() + newValue.slice(1);\n    setMessage(capitalizedValue);\n    if (newValue.length > 0) {\n      isTypingDisabledRef.current = false;\n      if (!isTyping) {\n        setIsTyping(true);\n        updateTypingStatus(true);\n      }\n    }\n  };\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    const newIsTyping = message.length > 0 && !isTypingDisabledRef.current;\n    if (newIsTyping !== isTyping) {\n      setIsTyping(newIsTyping);\n      updateTypingStatus(newIsTyping);\n    }\n  }, [message, isTyping, updateTypingStatus]);\n  const handleBlur = () => {\n    clearTypingTimeout();\n    typingTimeoutRef.current = setTimeout(() => {\n      isTypingDisabledRef.current = true;\n      setIsTyping(false);\n      updateTypingStatus(false);\n    }, config == null ? void 0 : config.typingTimeout);\n  };\n  const handleFocus = () => {\n    if (typingTimeoutRef.current) {\n      return;\n    }\n    isTypingDisabledRef.current = false;\n    if (message.length > 0) {\n      setIsTyping(true);\n      updateTypingStatus(true);\n    }\n  };\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    return () => {\n      clearTypingTimeout();\n    };\n  }, []);\n  const handleFilesSelect = (attachments) => {\n    setSelectedFiles((prev) => [...prev, ...attachments]);\n  };\n  const handleRemoveFile = (fileToRemove) => {\n    setSelectedFiles((prev) => prev.filter((file) => file !== fileToRemove));\n  };\n  const handleVoiceRecording = (audioBlob) => {\n    const audioFile = new File(\n      [audioBlob],\n      `voice-message-${Date.now()}.webm`,\n      {\n        type: \"audio/webm\"\n      }\n    );\n    setSelectedFiles((prev) => [...prev, audioFile]);\n  };\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(FileList_default, { attachments: selectedFiles, onRemoveFile: handleRemoveFile }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(InputContainer, { children: [\n      (config == null ? void 0 : config.activeEmoji) && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        EmojiPicker_default,\n        {\n          onEmojiClick: handleEmojiClick,\n          disabled: loadingSendMessage\n        }\n      ),\n      (config == null ? void 0 : config.activeFile) && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        FilePicker,\n        {\n          onFilesSelect: handleFilesSelect,\n          disabled: loadingSendMessage\n        }\n      ),\n      (config == null ? void 0 : config.activeVoice) && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        VoiceRecorder,\n        {\n          onRecordingComplete: handleVoiceRecording,\n          disabled: loadingSendMessage\n        }\n      ),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        StyledInput,\n        {\n          inputProps: { ref: inputRef },\n          disabled: loadingSendMessage,\n          fullWidth: true,\n          placeholder: \"\\xC9crivez un message...\",\n          value: message,\n          onChange: handleMessageChange,\n          onFocus: handleFocus,\n          onBlur: handleBlur,\n          onKeyDown: handleKeyPress,\n          multiline: true,\n          autoFocus: true,\n          maxRows: 4\n        }\n      ),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        _mui_material__WEBPACK_IMPORTED_MODULE_7__.Button,\n        {\n          loading: loadingSendMessage,\n          size: \"small\",\n          onClick: handleSend,\n          color: \"primary\",\n          sx: {\n            minWidth: { xs: \"36px\", sm: \"48px\" },\n            height: { xs: \"36px\", sm: \"48px\" }\n          },\n          children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Send__WEBPACK_IMPORTED_MODULE_14__[\"default\"], { fontSize: \"small\" })\n        }\n      )\n    ] })\n  ] });\n}\n\n// src/client/components/Chat/components/MessageList/index.tsx\n\n\n\n// src/client/components/Chat/components/MessageList/styles.ts\n\n\nvar MessageContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  flexDirection: \"column\",\n  gap: theme.spacing(1),\n  width: \"100%\",\n  overflowX: \"hidden\",\n  overflowY: \"auto\",\n  \"&.loading\": {\n    overflow: \"hidden\"\n  }\n}));\nvar MessageTime = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography)(({ theme }) => ({\n  fontSize: \"0.7rem\",\n  color: theme.palette.text.secondary,\n  marginTop: theme.spacing(0.5),\n  display: \"flex\",\n  gap: theme.spacing(1),\n  alignItems: \"center\"\n}));\nvar MessageGroup = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  flexDirection: \"column\",\n  gap: theme.spacing(0.5),\n  marginBottom: theme.spacing(2),\n  width: \"100%\",\n  overflow: \"hidden\"\n}));\nvar SystemMessage = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  width: \"100%\",\n  margin: theme.spacing(2, 0),\n  \"&::before, &::after\": {\n    content: '\"\"',\n    flex: 1,\n    height: \"1px\",\n    backgroundColor: theme.palette.divider,\n    margin: theme.spacing(0, 2),\n    opacity: 0.5\n  }\n}));\nvar MessageContent = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  gap: theme.spacing(1),\n  alignItems: \"flex-start\",\n  width: \"100%\",\n  overflow: \"hidden\"\n}));\nvar AudioContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  alignItems: \"center\",\n  gap: theme.spacing(1),\n  padding: theme.spacing(1.5),\n  backgroundColor: theme.palette.background.default,\n  borderRadius: theme.shape.borderRadius,\n  width: \"100%\",\n  overflow: \"hidden\",\n  boxSizing: \"border-box\"\n}));\nvar AudioProgress = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  flex: 1,\n  height: 6,\n  backgroundColor: theme.palette.grey[300],\n  borderRadius: 3,\n  position: \"relative\",\n  overflow: \"hidden\",\n  minWidth: 0\n}));\nvar AudioProgressBar = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(\n  ({ theme, progress }) => ({\n    position: \"absolute\",\n    left: 0,\n    top: 0,\n    height: \"100%\",\n    width: `${progress}%`,\n    backgroundColor: theme.palette.primary.main,\n    transition: \"width 0.1s linear\"\n  })\n);\nvar ImageContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  position: \"relative\",\n  width: \"100%\",\n  maxHeight: \"300px\",\n  borderRadius: theme.shape.borderRadius,\n  overflow: \"hidden\",\n  cursor: \"pointer\",\n  \"&:hover\": {\n    \"& .image-overlay\": {\n      opacity: 1\n    }\n  }\n}));\nvar StyledImage = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(\"img\")({\n  width: \"100%\",\n  height: \"100%\",\n  objectFit: \"cover\"\n});\nvar ImageOverlay = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  position: \"absolute\",\n  top: 0,\n  left: 0,\n  right: 0,\n  bottom: 0,\n  backgroundColor: \"rgba(0, 0, 0, 0.3)\",\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  opacity: 0,\n  transition: \"opacity 0.2s ease-in-out\"\n}));\nvar StyledDialog = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Dialog)(({ theme }) => ({\n  \"& .MuiDialog-paper\": {\n    backgroundColor: \"rgba(0, 0, 0, 0.9)\",\n    maxWidth: \"100vw\",\n    maxHeight: \"100vh\",\n    margin: 0,\n    borderRadius: 0,\n    overflow: \"hidden\"\n  },\n  \"& .MuiDialog-container\": {\n    overflow: \"hidden\"\n  },\n  \"& .MuiBackdrop-root\": {\n    backgroundColor: \"rgba(0, 0, 0, 0.9)\"\n  }\n}));\nvar ViewerImageContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  position: \"relative\",\n  width: \"100%\",\n  height: \"100%\",\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  padding: theme.spacing(2),\n  overflow: \"hidden\"\n}));\nvar ViewerImage = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(\"img\")(\n  ({ scale }) => ({\n    maxWidth: \"100%\",\n    maxHeight: \"100%\",\n    objectFit: \"contain\",\n    transform: `scale(${scale})`,\n    transition: \"transform 0.2s ease-in-out\"\n  })\n);\nvar ControlsContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  position: \"absolute\",\n  top: theme.spacing(2),\n  left: \"50%\",\n  transform: \"translateX(-50%)\",\n  display: \"flex\",\n  gap: theme.spacing(1),\n  zIndex: 1,\n  backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n  padding: theme.spacing(1),\n  borderRadius: theme.shape.borderRadius\n}));\nvar FileContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  flexDirection: \"column\",\n  gap: theme.spacing(1),\n  marginTop: theme.spacing(1),\n  padding: theme.spacing(1),\n  backgroundColor: theme.palette.background.default,\n  borderRadius: theme.shape.borderRadius,\n  border: `1px solid ${theme.palette.divider}`\n}));\nvar FileLink = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Link)(({ theme }) => ({\n  display: \"flex\",\n  alignItems: \"center\",\n  gap: theme.spacing(1),\n  color: theme.palette.text.primary,\n  textDecoration: \"none\",\n  padding: theme.spacing(1),\n  borderRadius: theme.shape.borderRadius,\n  transition: \"all 0.2s ease-in-out\",\n  \"&:hover\": {\n    backgroundColor: theme.palette.action.hover,\n    textDecoration: \"none\"\n  }\n}));\nvar FileName = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography)(({ theme }) => ({\n  fontSize: \"0.85rem\",\n  fontWeight: 500,\n  overflow: \"hidden\",\n  textOverflow: \"ellipsis\",\n  whiteSpace: \"nowrap\",\n  maxWidth: \"200px\"\n}));\nvar IconWrapper = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(\"div\")(({ theme }) => ({\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  width: \"24px\",\n  height: \"24px\"\n}));\n\n// src/client/components/Chat/components/MessageBubble/index.tsx\n\n\n// src/client/components/Chat/components/MessageBubble/style.ts\n\n\nvar StyledMessageBubble = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, {\n  shouldForwardProp: (prop) => prop !== \"isCurrentUser\" && prop !== \"userColor\" && prop !== \"hasSpecialContent\" && prop !== \"hasAudio\"\n})(\n  ({\n    theme,\n    isCurrentUser,\n    userColor,\n    hasSpecialContent = false,\n    hasAudio = false\n  }) => ({\n    position: \"relative\",\n    padding: theme.spacing(1.5, 2),\n    borderRadius: isCurrentUser ? `${theme.spacing(2)} 0 ${theme.spacing(2)} ${theme.spacing(2)}` : `0 ${theme.spacing(2)} ${theme.spacing(2)} ${theme.spacing(2)}`,\n    width: hasAudio ? \"calc(100% - 48px)\" : \"fit-content\",\n    maxWidth: hasAudio ? \"calc(100% - 48px)\" : \"70%\",\n    wordBreak: \"break-word\",\n    marginBottom: theme.spacing(1),\n    alignSelf: isCurrentUser ? \"flex-end\" : \"flex-start\",\n    backgroundColor: isCurrentUser ? theme.palette.primary.main : userColor || theme.palette.grey[100],\n    color: isCurrentUser ? theme.palette.primary.contrastText : \"inherit\",\n    textAlign: \"left\",\n    \"&::after\": {\n      content: '\"\"',\n      position: \"absolute\",\n      bottom: 0,\n      width: 0,\n      height: 0,\n      border: \"6px solid transparent\",\n      borderBottom: 0,\n      [isCurrentUser ? \"right\" : \"left\"]: 12,\n      borderTopColor: isCurrentUser ? theme.palette.primary.main : userColor || theme.palette.grey[100]\n    },\n    [theme.breakpoints.up(\"sm\")]: {\n      width: hasAudio ? \"70%\" : \"fit-content\",\n      maxWidth: \"70%\"\n    }\n  })\n);\nvar LinkContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"inline-flex\",\n  alignItems: \"center\",\n  gap: theme.spacing(0.5),\n  \"& .MuiSvgIcon-root\": {\n    fontSize: \"0.9em\",\n    cursor: \"pointer\"\n  }\n}));\n\n// src/client/components/Chat/components/MessageBubble/index.tsx\n\n\n// src/client/utils/fileUtils.ts\nvar isImage = (fileName) => {\n  const imageExtensions = [\".jpg\", \".jpeg\", \".png\", \".gif\", \".webp\"];\n  return imageExtensions.some((ext) => fileName.toLowerCase().endsWith(ext));\n};\nvar isAudio = (fileName) => {\n  const audioExtensions = [\".mp3\", \".wav\", \".ogg\", \".webm\"];\n  return audioExtensions.some((ext) => fileName.toLowerCase().endsWith(ext));\n};\n\n// src/client/components/Chat/components/MessageList/AudioMessage.tsx\n\n\n\n\n\nvar formatTime = (seconds) => {\n  if (!isFinite(seconds) || isNaN(seconds)) {\n    return \"0:00\";\n  }\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n};\nvar AudioMessage = ({ url }) => {\n  const [isPlaying, setIsPlaying] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const [currentTime, setCurrentTime] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(0);\n  const [duration, setDuration] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(0);\n  const audioRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n  const handlePlayPause = () => {\n    var _a, _b;\n    if (!audioRef.current) {\n      audioRef.current = new Audio(url);\n      audioRef.current.addEventListener(\"error\", (e) => {\n        console.error(\"Erreur de chargement audio:\", e);\n      });\n      audioRef.current.addEventListener(\"durationchange\", () => {\n        if (audioRef.current && isFinite(audioRef.current.duration) && audioRef.current.duration > 0) {\n          setDuration(audioRef.current.duration);\n        }\n      });\n      audioRef.current.addEventListener(\"progress\", () => {\n        if (audioRef.current && isFinite(audioRef.current.duration) && audioRef.current.duration > 0) {\n          setDuration(audioRef.current.duration);\n        }\n      });\n      audioRef.current.load();\n      audioRef.current.addEventListener(\"timeupdate\", () => {\n        if (audioRef.current) {\n          setCurrentTime(audioRef.current.currentTime);\n        }\n      });\n      audioRef.current.addEventListener(\"ended\", () => {\n        setIsPlaying(false);\n        setCurrentTime(0);\n      });\n    }\n    if (isPlaying) {\n      (_a = audioRef.current) == null ? void 0 : _a.pause();\n    } else {\n      (_b = audioRef.current) == null ? void 0 : _b.play();\n    }\n    setIsPlaying(!isPlaying);\n  };\n  const progress = duration > 0 ? currentTime / duration * 100 : 0;\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(AudioContainer, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton,\n      {\n        size: \"medium\",\n        onClick: handlePlayPause,\n        sx: {\n          color: \"primary.main\",\n          \"&:hover\": {\n            backgroundColor: \"action.hover\"\n          },\n          flexShrink: 0,\n          width: { xs: 36, sm: 40 },\n          height: { xs: 36, sm: 40 }\n        },\n        children: isPlaying ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Pause__WEBPACK_IMPORTED_MODULE_19__[\"default\"], {}) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_PlayArrow__WEBPACK_IMPORTED_MODULE_20__[\"default\"], {})\n      }\n    ),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { flex: 1, minWidth: 0, pr: 1, overflow: \"hidden\" }, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(AudioProgress, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(AudioProgressBar, { progress }) }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(\n        _mui_material__WEBPACK_IMPORTED_MODULE_7__.Box,\n        {\n          sx: {\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            mt: 1,\n            width: \"100%\",\n            gap: 1\n          },\n          children: [\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n              _mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography,\n              {\n                variant: \"caption\",\n                color: \"text.secondary\",\n                sx: {\n                  fontSize: { xs: \"0.7rem\", sm: \"0.8rem\" },\n                  minWidth: { xs: \"30px\", sm: \"40px\" }\n                },\n                children: formatTime(currentTime)\n              }\n            ),\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n              _mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography,\n              {\n                variant: \"caption\",\n                color: \"text.secondary\",\n                sx: {\n                  fontSize: { xs: \"0.7rem\", sm: \"0.8rem\" },\n                  minWidth: { xs: \"30px\", sm: \"40px\" },\n                  textAlign: \"right\"\n                },\n                children: formatTime(duration)\n              }\n            )\n          ]\n        }\n      )\n    ] })\n  ] });\n};\n\n// src/client/components/Chat/components/MessageList/ImageFile.tsx\n\n\n// src/client/components/Chat/components/MessageList/ImageViewer.tsx\n\n\n\n\n\n\n\nvar ImageViewer = ({\n  open,\n  onClose,\n  imageUrl,\n  imageName\n}) => {\n  const [scale, setScale] = react__WEBPACK_IMPORTED_MODULE_3__.useState(1);\n  const handleZoomIn = () => {\n    setScale((prev) => Math.min(prev + 0.25, 3));\n  };\n  const handleZoomOut = () => {\n    setScale((prev) => Math.max(prev - 0.25, 0.5));\n  };\n  const handleClose = () => {\n    setScale(1);\n    onClose();\n  };\n  const handleDownload = () => {\n    const link = document.createElement(\"a\");\n    link.href = imageUrl;\n    link.download = imageName;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n    StyledDialog,\n    {\n      open,\n      onClose: handleClose,\n      fullScreen: true,\n      onClick: handleClose,\n      disableEnforceFocus: true,\n      disableAutoFocus: true,\n      children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(ViewerImageContainer, { onClick: (e) => e.stopPropagation(), children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(ControlsContainer, { children: [\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Tooltip, { title: \"Zoom avant\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton, { onClick: handleZoomIn, sx: { color: \"white\" }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_ZoomIn__WEBPACK_IMPORTED_MODULE_23__[\"default\"], {}) }) }),\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Tooltip, { title: \"Zoom arri\\xE8re\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton, { onClick: handleZoomOut, sx: { color: \"white\" }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_ZoomOut__WEBPACK_IMPORTED_MODULE_24__[\"default\"], {}) }) }),\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Tooltip, { title: \"T\\xE9l\\xE9charger\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton, { onClick: handleDownload, sx: { color: \"white\" }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Download__WEBPACK_IMPORTED_MODULE_22__[\"default\"], {}) }) }),\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Tooltip, { title: \"Fermer\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton, { onClick: handleClose, sx: { color: \"white\" }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Close__WEBPACK_IMPORTED_MODULE_21__[\"default\"], {}) }) })\n        ] }),\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          ViewerImage,\n          {\n            src: imageUrl,\n            alt: imageName,\n            scale,\n            onClick: (e) => e.stopPropagation()\n          }\n        )\n      ] })\n    }\n  );\n};\n\n// src/client/components/Chat/components/MessageList/ImageFile.tsx\n\n\nvar ImageFile = ({ url, name, onLoad }) => {\n  const [isViewerOpen, setIsViewerOpen] = react__WEBPACK_IMPORTED_MODULE_3__.useState(false);\n  const handleClick = (e) => {\n    e.stopPropagation();\n    setIsViewerOpen(true);\n  };\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(ImageContainer, { onClick: handleClick, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(StyledImage, { src: url, alt: name, onLoad }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ImageOverlay, { className: \"image-overlay\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography, { variant: \"body2\", color: \"white\", children: \"Cliquez pour agrandir\" }) })\n    ] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      ImageViewer,\n      {\n        open: isViewerOpen,\n        onClose: () => setIsViewerOpen(false),\n        imageUrl: url,\n        imageName: name\n      }\n    )\n  ] });\n};\n\n// src/client/components/Chat/components/MessageList/RegularFile.tsx\n\n\n\nvar RegularFile = ({ name, url }) => {\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(FileContainer, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(IconWrapper, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_InsertDriveFile__WEBPACK_IMPORTED_MODULE_25__[\"default\"], {}) }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { flex: 1, minWidth: 0 }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(FileLink, { href: url, target: \"_blank\", rel: \"noopener noreferrer\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(FileName, { variant: \"body2\", noWrap: true, children: name }) }) })\n  ] });\n};\n\n// src/client/components/Chat/components/MessageList/MessageFiles.tsx\n\nvar MessageFiles = ({\n  attachments,\n  onImageLoad\n}) => {\n  if (!attachments || attachments.length === 0) {\n    return null;\n  }\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(FileContainer, { children: attachments.map((attachment, index) => {\n    if (isImage(attachment.name)) {\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        ImageFile,\n        {\n          url: attachment.url,\n          name: attachment.name,\n          onLoad: onImageLoad\n        },\n        index\n      );\n    } else if (isAudio(attachment.name)) {\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(AudioMessage, { url: attachment.url }, index);\n    } else {\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        RegularFile,\n        {\n          url: attachment.url,\n          name: attachment.name\n        },\n        index\n      );\n    }\n  }) });\n};\n\n// src/client/components/Chat/components/MessageBubble/index.tsx\n\n\nvar detectUrls = (text, isCurrentUser) => {\n  const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n  const parts = text.split(urlRegex);\n  const matches = Array.from(text.matchAll(urlRegex)).map((match) => match[0]);\n  return parts.map((part, index) => {\n    if (matches.includes(part)) {\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(LinkContainer, { children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          _mui_material__WEBPACK_IMPORTED_MODULE_7__.Link,\n          {\n            href: part,\n            target: \"_blank\",\n            rel: \"noopener noreferrer\",\n            underline: \"hover\",\n            sx: {\n              color: isCurrentUser ? \"inherit\" : \"primary.main\",\n              \"&:hover\": {\n                color: isCurrentUser ? \"inherit\" : \"primary.dark\"\n              }\n            },\n            children: part\n          }\n        ),\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          _mui_icons_material_Link__WEBPACK_IMPORTED_MODULE_18__[\"default\"],\n          {\n            onClick: () => window.open(part, \"_blank\", \"noopener,noreferrer\"),\n            sx: {\n              color: isCurrentUser ? \"inherit\" : \"primary.main\",\n              opacity: 0.8,\n              \"&:hover\": {\n                opacity: 1\n              }\n            }\n          }\n        )\n      ] }, index);\n    }\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(react__WEBPACK_IMPORTED_MODULE_3__.Fragment, { children: part }, index);\n  });\n};\nvar MessageBubble = ({\n  isCurrentUser,\n  userColor,\n  hasSpecialContent,\n  hasAudio,\n  content,\n  attachments,\n  onImageLoad\n}) => {\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n    StyledMessageBubble,\n    {\n      isCurrentUser,\n      userColor,\n      hasSpecialContent,\n      hasAudio,\n      children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { component: \"div\", children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          _mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography,\n          {\n            component: \"span\",\n            variant: \"body1\",\n            sx: { whiteSpace: \"pre-wrap\" },\n            children: detectUrls(content, isCurrentUser)\n          }\n        ),\n        attachments && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(MessageFiles, { attachments, onImageLoad })\n      ] })\n    }\n  );\n};\n\n// src/client/components/Chat/components/MessageList/index.tsx\n\n\n// src/client/components/Chat/components/SeenBy/index.tsx\n\n\n\n\n// src/client/components/Chat/components/SeenBy/style.ts\n\n\nvar SeenContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  alignItems: \"center\",\n  gap: theme.spacing(0.5),\n  \"& .MuiSvgIcon-root\": {\n    fontSize: \"1rem\",\n    color: theme.palette.text.secondary\n  }\n}));\n\n// src/client/components/Chat/components/SeenBy/index.tsx\n\n\nvar SeenBy = ({\n  message,\n  userId,\n  getParticipant,\n  totalParticipants\n}) => {\n  var _a;\n  if (!((_a = message.seenBy) == null ? void 0 : _a.length)) return null;\n  const seenParticipants = message.seenBy.filter((seen) => seen.userId !== userId).map((seen) => __spreadProps(__spreadValues({}, getParticipant(seen.userId)), {\n    seenAt: seen.seenAt\n  }));\n  if (seenParticipants.length === 0) return null;\n  const allParticipantsHaveSeen = seenParticipants.length === totalParticipants - 1;\n  const tooltipContent = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { children: seenParticipants.map((participant) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(\n    _mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography,\n    {\n      variant: \"caption\",\n      sx: { display: \"block\" },\n      children: [\n        participant.name,\n        \" - \",\n        moment__WEBPACK_IMPORTED_MODULE_28__(participant.seenAt).format(\"HH:mm\")\n      ]\n    },\n    participant.id\n  )) });\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(SeenContainer, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Tooltip, { title: tooltipContent, children: allParticipantsHaveSeen ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_CheckCircle__WEBPACK_IMPORTED_MODULE_26__[\"default\"], {}) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_CheckCircleOutline__WEBPACK_IMPORTED_MODULE_27__[\"default\"], {}) }) });\n};\n\n// src/client/components/Chat/components/UserAvatar/index.tsx\n\n\n\nvar UserAvatar = react__WEBPACK_IMPORTED_MODULE_3__.forwardRef(\n  ({ user, size = 32 }, ref) => {\n    const getInitials = (name) => {\n      return name.split(\" \").map((n) => n[0]).join(\"\").toUpperCase().slice(0, 2);\n    };\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Tooltip, { title: user.name, arrow: true, placement: \"top\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.Avatar,\n      {\n        ref,\n        src: user.avatar,\n        alt: user.name,\n        sx: {\n          width: size,\n          height: size,\n          bgcolor: \"grey.300\",\n          fontSize: `${size * 0.4}px`,\n          cursor: \"pointer\"\n        },\n        children: !user.avatar && getInitials(user.name)\n      }\n    ) });\n  }\n);\nUserAvatar.displayName = \"UserAvatar\";\n\n// src/client/utils/color.ts\nvar generateColorFromId = (id) => {\n  const hash = id.split(\"\").reduce((acc, char) => {\n    const charCode = char.charCodeAt(0);\n    return (acc << 5) - acc + charCode;\n  }, 0);\n  const goldenRatio = 0.618033988749895;\n  const hue = hash * goldenRatio % 360;\n  return `hsl(${hue}, 85%, 75%)`;\n};\n\n// src/client/components/Chat/components/MessageList/index.tsx\n\n\nmoment__WEBPACK_IMPORTED_MODULE_28__.locale(\"fr\");\nvar MessageList = () => {\n  const {\n    messages,\n    participants,\n    getParticipant,\n    isLoading,\n    config,\n    userId,\n    scrollManager\n  } = useChatContext();\n  const messageEndRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef(null);\n  const containerRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef(null);\n  const [shouldShowContent, setShouldShowContent] = react__WEBPACK_IMPORTED_MODULE_3__.useState(false);\n  const isFirstLoadRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef(true);\n  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(() => {\n    if (!isLoading) {\n      setShouldShowContent(true);\n    } else {\n      setShouldShowContent(false);\n    }\n  }, [isLoading]);\n  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(() => {\n    if (shouldShowContent && isFirstLoadRef.current && messages.length > 0) {\n      const checkAndScroll = () => {\n        if (containerRef.current) {\n          const containerHeight = containerRef.current.scrollHeight;\n          if (containerHeight > 0) {\n            scrollManager.scrollToBottom(\"instant\");\n            isFirstLoadRef.current = false;\n          } else {\n            requestAnimationFrame(checkAndScroll);\n          }\n        }\n      };\n      requestAnimationFrame(checkAndScroll);\n    }\n  }, [shouldShowContent, messages.length, scrollManager]);\n  if (isLoading || !shouldShowContent) {\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.Box,\n      {\n        sx: {\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          height: \"100%\",\n          minHeight: \"200px\"\n        },\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.CircularProgress, {})\n      }\n    );\n  }\n  if (!isLoading && messages.length === 0) {\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(MessageContainer, { ref: containerRef, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(SystemMessage, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        _mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography,\n        {\n          variant: \"body2\",\n          color: \"text.secondary\",\n          sx: {\n            fontStyle: \"italic\",\n            opacity: 0.7,\n            fontSize: \"0.85rem\"\n          },\n          children: (config == null ? void 0 : config.welcomeMessage) || \"Aucun message pour le moment\"\n        }\n      ) }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\"div\", { ref: messageEndRef })\n    ] });\n  }\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(MessageContainer, { ref: containerRef, className: isLoading ? \"loading\" : \"\", children: [\n    messages.map((message, index) => {\n      var _a, _b, _c, _d;\n      const isCurrentUser = message.userId === userId;\n      const userColor = !isCurrentUser && (config == null ? void 0 : config.activeUserColor) ? generateColorFromId(message.userId) : void 0;\n      const showTime = index === messages.length - 1 || ((_a = messages[index + 1]) == null ? void 0 : _a.userId) !== message.userId || moment__WEBPACK_IMPORTED_MODULE_28__((_b = messages[index + 1]) == null ? void 0 : _b.createdAt).diff(\n        moment__WEBPACK_IMPORTED_MODULE_28__(message.createdAt),\n        \"minutes\"\n      ) > 5;\n      const hasSpecialContent = message.attachments && message.attachments.length > 0;\n      const hasAudio = (_c = message.attachments) == null ? void 0 : _c.some(\n        (attachment) => attachment.name.match(/\\.(mp3|wav|ogg|m4a)$/i)\n      );\n      if (((_d = message.type) == null ? void 0 : _d.toLowerCase()) === \"system\") {\n        return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(SystemMessage, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          _mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography,\n          {\n            variant: \"body2\",\n            color: \"text.secondary\",\n            sx: {\n              fontStyle: \"italic\",\n              opacity: 0.7,\n              fontSize: \"0.85rem\"\n            },\n            children: message.content\n          }\n        ) }, message.id);\n      }\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        MessageGroup,\n        {\n          className: \"message-group\",\n          \"data-message-id\": message.id,\n          children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(MessageContent, { children: [\n            !isCurrentUser && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { flexShrink: 0 }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(UserAvatar, { user: getParticipant(message.userId) }) }),\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { display: \"flex\", flexDirection: \"column\", flex: 1 }, children: [\n              /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n                MessageBubble,\n                {\n                  isCurrentUser,\n                  userColor,\n                  hasSpecialContent,\n                  hasAudio,\n                  content: message.content,\n                  attachments: message.attachments\n                }\n              ),\n              showTime && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(\n                MessageTime,\n                {\n                  variant: \"caption\",\n                  sx: {\n                    alignSelf: isCurrentUser ? \"flex-end\" : \"flex-start\"\n                  },\n                  children: [\n                    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\"span\", { children: moment__WEBPACK_IMPORTED_MODULE_28__(new Date(message.createdAt)).format(\"HH:mm\") }),\n                    isCurrentUser && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n                      SeenBy,\n                      {\n                        message,\n                        userId,\n                        getParticipant,\n                        totalParticipants: participants.length\n                      }\n                    )\n                  ]\n                }\n              )\n            ] }),\n            isCurrentUser && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { flexShrink: 0 }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(UserAvatar, { user: getParticipant(message.userId) }) })\n          ] })\n        },\n        message.id\n      );\n    }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\"div\", { ref: messageEndRef })\n  ] });\n};\n\n// src/client/components/Chat/components/TypingIndicator/index.tsx\n\n\n\n// src/client/components/Chat/components/TypingIndicator/styles.ts\n\n\nvar Container = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  padding: theme.spacing(0.5),\n  marginTop: theme.spacing(0.5),\n  marginBottom: theme.spacing(0.5),\n  height: \"24px\",\n  display: \"flex\",\n  alignItems: \"center\"\n}));\n\n// src/client/components/Chat/components/TypingIndicator/index.tsx\n\nvar TypingIndicator = () => {\n  const { typingUsers, participants, userId } = useChatContext();\n  const [isVisible, setIsVisible] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const typingUsersWithoutCurrentUser = typingUsers.filter(\n    (user) => user !== userId\n  );\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    if (typingUsersWithoutCurrentUser.length > 0) {\n      setIsVisible(true);\n    } else {\n      const timer = setTimeout(() => {\n        setIsVisible(false);\n      }, 1e3);\n      return () => clearTimeout(timer);\n    }\n  }, [typingUsersWithoutCurrentUser]);\n  const getTypingUsersNames = () => {\n    if (!typingUsersWithoutCurrentUser.length) return \"\";\n    const typingParticipants = participants.filter(\n      (user) => typingUsersWithoutCurrentUser.includes(user.id) && user.id !== userId\n    );\n    if (typingParticipants.length === 0) return \"\";\n    const names = typingParticipants.map((user) => user.name);\n    if (names.length === 1) {\n      return `${names[0]} \\xE9crit...`;\n    } else if (names.length === 2) {\n      return `${names[0]} et ${names[1]} \\xE9crivent...`;\n    } else {\n      return `${names[0]}, ${names[1]} et ${names.length - 2} autre(s) \\xE9crivent...`;\n    }\n  };\n  const typingText = getTypingUsersNames();\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Collapse, { in: isVisible, sx: { pl: 2 }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(Container, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n    _mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography,\n    {\n      variant: \"caption\",\n      color: \"text.secondary\",\n      sx: {\n        fontStyle: \"italic\",\n        fontSize: \"0.75rem\",\n        opacity: typingText ? 1 : 0,\n        transition: \"opacity 0.3s ease-in-out\"\n      },\n      children: typingText\n    }\n  ) }) });\n};\n\n// src/client/components/Chat/index.tsx\n\nvar ChatConversationContent = () => {\n  const { scrollManager } = useChatContext();\n  const { contentRef } = scrollManager;\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(Content, { ref: contentRef, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(LoadMoreMessages, {}),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(MessageList, {})\n    ] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ChatActions, {}),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(TypingIndicator, {}),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(MessageInput, {})\n  ] });\n};\nvar ChatNoConversationContent = ({ buttonJoin }) => {\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(Content, { children: buttonJoin ? buttonJoin : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(WaitingMessageContainer, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(WaitingMessageEmoji, { children: \"\\u{1F4AD}\" }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(WaitingMessageTitle, { children: \"En attente de conversation\" }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(WaitingMessageText, { children: \"La conversation n'est pas encore active. Revenez bient\\xF4t pour discuter !\" })\n  ] }) }) });\n};\nvar Chat = (props) => {\n  const _a = props, { conversationId, buttonJoin } = _a, rest = __objRest(_a, [\"conversationId\", \"buttonJoin\"]);\n  if (conversationId) {\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ChatProvider, __spreadProps(__spreadValues({}, rest), { conversationId, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ChatConversationContent, {}) }));\n  }\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ChatNoConversationContent, { buttonJoin });\n};\n\n// src/client/components/ChatBubble/index.tsx\n\n\n\n\n// src/client/components/ChatPopup/index.tsx\n\n\n// src/client/components/ChatPopup/components/Header/index.tsx\n\n\n\n\n\n// src/client/components/ChatPopup/components/Header/DocumentsMenu/index.tsx\n\n\n// src/client/components/ChatPopup/components/Header/DocumentsMenu/styles.ts\n\n\nvar StyledPopover = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Popover)(({ theme }) => ({\n  \"& .MuiPaper-root\": {\n    width: 280,\n    maxHeight: 360,\n    backgroundColor: theme.palette.background.paper,\n    borderRadius: theme.shape.borderRadius,\n    boxShadow: theme.shadows[3],\n    display: \"flex\",\n    flexDirection: \"column\"\n  }\n}));\nvar MenuHeader = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  padding: theme.spacing(1.5),\n  borderBottom: `1px solid ${theme.palette.divider}`,\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"space-between\",\n  gap: theme.spacing(1),\n  position: \"sticky\",\n  top: 0,\n  backgroundColor: theme.palette.background.paper,\n  zIndex: 1\n}));\nvar StyledList = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.List)(({ theme }) => ({\n  flex: 1,\n  overflow: \"auto\",\n  py: 0\n}));\n\n// src/client/components/ChatPopup/components/Header/DocumentsMenu/index.tsx\n\n\n\n// src/client/components/FileManager/styles.ts\n\n\nvar FileContainer2 = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  flexDirection: \"column\",\n  gap: theme.spacing(1),\n  padding: theme.spacing(1),\n  backgroundColor: theme.palette.background.default,\n  borderRadius: theme.shape.borderRadius,\n  border: `1px solid ${theme.palette.divider}`,\n  cursor: \"pointer\",\n  \"&:hover\": {\n    backgroundColor: theme.palette.action.hover\n  }\n}));\n\n// src/client/components/FileManager/FileItem.tsx\n\nvar FileItem = ({ file, onClick }) => {\n  const handleClick = (e) => {\n    if (isAudio(file.name)) {\n      return;\n    }\n    if (onClick) {\n      onClick(file);\n    } else {\n      window.open(file.url, \"_blank\");\n    }\n  };\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(FileContainer2, { onClick: handleClick, children: isImage(file.name) ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ImageFile, { url: file.url, name: file.name }) : isAudio(file.name) ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(AudioMessage, { url: file.url }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(RegularFile, { url: file.url, name: file.name }) });\n};\n\n// src/client/components/ChatPopup/components/Header/DocumentsMenu/index.tsx\n\n\nvar DocumentsMenu = ({\n  allAttachments,\n  open,\n  onClose\n}) => {\n  const anchorRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton,\n      {\n        ref: anchorRef,\n        size: \"small\",\n        sx: {\n          color: (theme) => theme.palette.text.secondary,\n          padding: 0.5,\n          \"&:hover\": {\n            color: (theme) => theme.palette.primary.main\n          }\n        },\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_InsertDriveFile__WEBPACK_IMPORTED_MODULE_25__[\"default\"], { fontSize: \"small\" })\n      }\n    ),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(\n      StyledPopover,\n      {\n        open,\n        anchorEl: anchorRef.current,\n        onClose,\n        anchorOrigin: {\n          vertical: \"bottom\",\n          horizontal: \"right\"\n        },\n        transformOrigin: {\n          vertical: \"top\",\n          horizontal: \"right\"\n        },\n        onClick: (e) => e.stopPropagation(),\n        children: [\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(MenuHeader, { children: [\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { display: \"flex\", alignItems: \"center\", gap: 1 }, children: [\n              /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_InsertDriveFile__WEBPACK_IMPORTED_MODULE_25__[\"default\"], { fontSize: \"small\", color: \"primary\" }),\n              /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography, { variant: \"subtitle2\", fontWeight: \"bold\", children: [\n                \"Documents (\",\n                (allAttachments == null ? void 0 : allAttachments.length) || 0,\n                \")\"\n              ] })\n            ] }),\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton, { size: \"small\", onClick: onClose, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Close__WEBPACK_IMPORTED_MODULE_21__[\"default\"], { fontSize: \"small\" }) })\n          ] }),\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(StyledList, { children: (allAttachments == null ? void 0 : allAttachments.length) === 0 ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { p: 2, textAlign: \"center\" }, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography, { variant: \"body2\", color: \"text.secondary\", children: \"Aucun document partag\\xE9 dans cette conversation\" }) }) : allAttachments == null ? void 0 : allAttachments.map((file, index) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(FileItem, { file }, index)) })\n        ]\n      }\n    )\n  ] });\n};\n\n// src/client/components/ChatPopup/components/Header/HeaderMenu.tsx\n\n\n\n\n// src/client/components/ChatPopup/components/Header/ParticipantsMenu/index.tsx\n\n\n// src/client/components/ChatPopup/components/Header/ParticipantsMenu/styles.ts\n\n\nvar StyledPopover2 = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Popover)(({ theme }) => ({\n  \"& .MuiPaper-root\": {\n    width: 280,\n    maxHeight: 360,\n    backgroundColor: theme.palette.background.paper,\n    borderRadius: theme.shape.borderRadius,\n    boxShadow: theme.shadows[3],\n    display: \"flex\",\n    flexDirection: \"column\"\n  }\n}));\nvar MenuHeader2 = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  padding: theme.spacing(1.5),\n  borderBottom: `1px solid ${theme.palette.divider}`,\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"space-between\",\n  gap: theme.spacing(1),\n  position: \"sticky\",\n  top: 0,\n  backgroundColor: theme.palette.background.paper,\n  zIndex: 1\n}));\nvar ParticipantAvatar = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  width: 32,\n  height: 32,\n  borderRadius: \"50%\",\n  overflow: \"hidden\",\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  backgroundColor: theme.palette.primary.main,\n  color: theme.palette.primary.contrastText,\n  fontSize: \"0.9rem\",\n  fontWeight: 500,\n  \"& img\": {\n    width: \"100%\",\n    height: \"100%\",\n    objectFit: \"cover\"\n  }\n}));\nvar StyledListItem = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.ListItem)(({ theme }) => ({\n  padding: theme.spacing(0.75, 1.5),\n  \"&:hover\": {\n    backgroundColor: theme.palette.action.hover\n  }\n}));\nvar StyledList2 = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.List)(({ theme }) => ({\n  flex: 1,\n  overflow: \"auto\",\n  py: 0\n}));\n\n// src/client/components/ChatPopup/components/Header/ParticipantsMenu/index.tsx\n\n\n\nvar ParticipantsMenu = ({\n  participants,\n  renderParticipant,\n  open,\n  onClose\n}) => {\n  const anchorRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton,\n      {\n        ref: anchorRef,\n        size: \"small\",\n        sx: {\n          color: (theme) => theme.palette.text.secondary,\n          padding: 0.5,\n          \"&:hover\": {\n            color: (theme) => theme.palette.primary.main\n          }\n        },\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Group__WEBPACK_IMPORTED_MODULE_32__[\"default\"], { fontSize: \"small\" })\n      }\n    ),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(\n      StyledPopover2,\n      {\n        open,\n        anchorEl: anchorRef.current,\n        onClose,\n        anchorOrigin: {\n          vertical: \"bottom\",\n          horizontal: \"right\"\n        },\n        transformOrigin: {\n          vertical: \"top\",\n          horizontal: \"right\"\n        },\n        onClick: (e) => e.stopPropagation(),\n        children: [\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(MenuHeader2, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { display: \"flex\", alignItems: \"center\", gap: 1 }, children: [\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Group__WEBPACK_IMPORTED_MODULE_32__[\"default\"], { fontSize: \"small\", color: \"primary\" }),\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography, { variant: \"subtitle2\", fontWeight: \"bold\", children: [\n              \"Participants (\",\n              participants.length,\n              \")\"\n            ] })\n          ] }) }),\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(StyledList2, { children: participants.map((participant) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(StyledListItem, { children: [\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.ListItemIcon, { sx: { minWidth: 36 }, children: renderParticipant ? renderParticipant(participant) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ParticipantAvatar, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n              _mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography,\n              {\n                variant: \"caption\",\n                sx: { fontSize: \"0.9rem\", fontWeight: 500 },\n                children: participant.name.split(\" \").map((word) => word[0]).join(\"\").toUpperCase().slice(0, 2)\n              }\n            ) }) }),\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n              _mui_material__WEBPACK_IMPORTED_MODULE_7__.ListItemText,\n              {\n                primary: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography, { variant: \"body2\", fontWeight: 500, children: participant.name })\n              }\n            )\n          ] }, participant.id)) })\n        ]\n      }\n    )\n  ] });\n};\n\n// src/client/components/ChatPopup/components/Header/HeaderMenu.tsx\n\nvar HeaderMenu = ({\n  participants,\n  renderParticipant,\n  allAttachments\n}) => {\n  const [anchorEl, setAnchorEl] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null);\n  const [isDocumentsOpen, setIsDocumentsOpen] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const [isParticipantsOpen, setIsParticipantsOpen] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const open = Boolean(anchorEl);\n  const handleClick = (event) => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n    setIsDocumentsOpen(false);\n    setIsParticipantsOpen(false);\n  };\n  const handleDocumentClick = (e) => {\n    setIsDocumentsOpen(true);\n    setIsParticipantsOpen(false);\n  };\n  const handleParticipantsClick = (e) => {\n    e.stopPropagation();\n    setIsParticipantsOpen(true);\n    setIsDocumentsOpen(false);\n  };\n  const handleDocumentClose = () => {\n    setIsDocumentsOpen(false);\n  };\n  const handleParticipantsClose = () => {\n    setIsParticipantsOpen(false);\n  };\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Tooltip, { title: \"Options\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton,\n      {\n        onClick: handleClick,\n        size: \"small\",\n        sx: {\n          color: (theme) => theme.palette.text.secondary,\n          padding: 0.5,\n          \"&:hover\": {\n            color: (theme) => theme.palette.primary.main\n          }\n        },\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_MoreVert__WEBPACK_IMPORTED_MODULE_31__[\"default\"], { fontSize: \"small\" })\n      }\n    ) }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(\n      _mui_material__WEBPACK_IMPORTED_MODULE_7__.Menu,\n      {\n        anchorEl,\n        open,\n        onClose: handleClose,\n        anchorOrigin: {\n          vertical: \"bottom\",\n          horizontal: \"right\"\n        },\n        transformOrigin: {\n          vertical: \"top\",\n          horizontal: \"right\"\n        },\n        onClick: (e) => e.stopPropagation(),\n        children: [\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.MenuItem, { onClick: handleDocumentClick, children: [\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n              DocumentsMenu,\n              {\n                allAttachments,\n                open: isDocumentsOpen,\n                onClose: handleDocumentClose\n              }\n            ),\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography, { variant: \"body2\", children: \"Documents\" })\n          ] }),\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.MenuItem, { onClick: handleParticipantsClick, children: [\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n              ParticipantsMenu,\n              {\n                participants,\n                renderParticipant,\n                open: isParticipantsOpen,\n                onClose: handleParticipantsClose\n              }\n            ),\n            /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography, { variant: \"body2\", children: \"Participants\" })\n          ] })\n        ]\n      }\n    )\n  ] });\n};\n\n// src/client/components/ChatPopup/components/Header/index.tsx\n\n\n\nvar HeaderContainer = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  padding: theme.spacing(1.5),\n  borderBottom: `1px solid ${theme.palette.divider}`,\n  background: theme.palette.background.paper,\n  color: theme.palette.text.primary,\n  display: \"flex\",\n  justifyContent: \"space-between\",\n  alignItems: \"center\",\n  borderTopLeftRadius: \"16px\",\n  borderTopRightRadius: \"16px\"\n}));\nvar UserInfo = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  display: \"flex\",\n  alignItems: \"center\",\n  gap: theme.spacing(1)\n}));\nvar UserAvatar2 = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box)(({ theme }) => ({\n  width: 32,\n  height: 32,\n  borderRadius: \"50%\",\n  overflow: \"hidden\",\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  backgroundColor: theme.palette.primary.main,\n  color: theme.palette.primary.contrastText,\n  fontSize: \"0.9rem\",\n  fontWeight: 500,\n  \"& img\": {\n    width: \"100%\",\n    height: \"100%\",\n    objectFit: \"cover\"\n  }\n}));\nvar UserName = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Typography)(({ theme }) => ({\n  fontSize: \"0.9rem\",\n  fontWeight: 600,\n  margin: 0,\n  lineHeight: 1.2\n}));\nvar ActionButton = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.IconButton)(({ theme }) => ({\n  color: theme.palette.text.secondary,\n  padding: 0.5,\n  \"&:hover\": {\n    color: theme.palette.primary.main\n  }\n}));\nvar Header = ({\n  title,\n  onClose,\n  onExpand,\n  isExpanded,\n  avatar,\n  participants = [],\n  renderParticipant,\n  allAttachments,\n  conversationId\n}) => {\n  const [isDocumentsOpen, setIsDocumentsOpen] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const [isParticipantsOpen, setIsParticipantsOpen] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const handleDocumentClose = () => setIsDocumentsOpen(false);\n  const handleParticipantsClose = () => setIsParticipantsOpen(false);\n  const renderActionButtons = () => {\n    if (isExpanded && conversationId) {\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment, { children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ActionButton, { size: \"small\", onClick: () => setIsDocumentsOpen(true), children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          DocumentsMenu,\n          {\n            allAttachments,\n            open: isDocumentsOpen,\n            onClose: handleDocumentClose\n          }\n        ) }),\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          ActionButton,\n          {\n            size: \"small\",\n            onClick: () => setIsParticipantsOpen(true),\n            children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n              ParticipantsMenu,\n              {\n                participants,\n                renderParticipant,\n                open: isParticipantsOpen,\n                onClose: handleParticipantsClose\n              }\n            )\n          }\n        )\n      ] });\n    }\n    if (conversationId) {\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        HeaderMenu,\n        {\n          allAttachments,\n          participants,\n          renderParticipant\n        }\n      );\n    }\n    return null;\n  };\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(HeaderContainer, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(UserInfo, { children: [\n      avatar && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(UserAvatar2, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\"img\", { src: avatar, alt: \"title\" }) }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(UserName, { variant: \"subtitle1\", children: title }) })\n    ] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Box, { sx: { display: \"flex\", gap: 1 }, children: [\n      renderActionButtons(),\n      onExpand && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        ActionButton,\n        {\n          onClick: onExpand,\n          size: \"small\",\n          sx: {\n            transform: isExpanded ? \"rotate(180deg)\" : \"none\"\n          },\n          children: isExpanded ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_CloseFullscreen__WEBPACK_IMPORTED_MODULE_30__[\"default\"], { fontSize: \"small\" }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_OpenInFull__WEBPACK_IMPORTED_MODULE_33__[\"default\"], { fontSize: \"small\" })\n        }\n      ),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(ActionButton, { onClick: onClose, size: \"small\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Close__WEBPACK_IMPORTED_MODULE_21__[\"default\"], { fontSize: \"small\" }) })\n    ] })\n  ] });\n};\nvar Header_default = Header;\n\n// src/client/components/ChatPopup/style.ts\n\n\nvar StyledPaper = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Paper, {\n  shouldForwardProp: (prop) => prop !== \"isClosing\" && prop !== \"isExpanded\"\n})(\n  ({ theme, isClosing, isExpanded }) => ({\n    position: \"fixed\",\n    bottom: theme.spacing(12),\n    right: theme.spacing(4),\n    width: isExpanded ? \"80%\" : 350,\n    height: isExpanded ? \"80vh\" : 500,\n    zIndex: 1e3,\n    display: \"flex\",\n    flexDirection: \"column\",\n    gap: theme.spacing(1),\n    overflow: \"hidden\",\n    transformOrigin: \"bottom right\",\n    borderRadius: \"16px\",\n    boxShadow: `\n      0 8px 32px rgba(0, 0, 0, 0.1),\n      0 0 0 1px ${theme.palette.primary.dark}33,\n      0 0 0 2px ${theme.palette.primary.dark}11\n    `,\n    border: `1px solid ${theme.palette.primary.dark}33`,\n    backdropFilter: \"blur(10px)\",\n    background: `linear-gradient(180deg, \n      ${theme.palette.background.paper} 0%, \n      ${theme.palette.background.paper} 100%\n    )`,\n    transition: \"all 0.3s ease-in-out\",\n    transform: isClosing ? \"scale(0.95) translateY(20px)\" : \"scale(1)\",\n    opacity: isClosing ? 0 : 1,\n    visibility: isClosing ? \"hidden\" : \"visible\",\n    animation: !isClosing ? \"popIn 0.3s ease-out\" : \"none\",\n    \"&.loading\": {\n      overflow: \"hidden\"\n    },\n    \"@keyframes popIn\": {\n      \"0%\": {\n        transform: \"scale(0.95) translateY(20px)\",\n        opacity: 0\n      },\n      \"100%\": {\n        transform: \"scale(1) translateY(0)\",\n        opacity: 1\n      }\n    }\n  })\n);\n\n// src/client/components/ChatPopup/index.tsx\n\nvar ChatPopup = ({\n  open,\n  onClose,\n  conversationId,\n  title = \"Chat\",\n  avatar,\n  defaultMessages,\n  participants,\n  onReceiveMessage,\n  onSendMessage,\n  config,\n  renderParticipant,\n  isLoading,\n  onMessageSeen,\n  onLoadMoreMessages,\n  allAttachments,\n  totalMessages,\n  buttonJoin\n}) => {\n  const [isClosing, setIsClosing] = react__WEBPACK_IMPORTED_MODULE_3__.useState(false);\n  const [isExpanded, setIsExpanded] = react__WEBPACK_IMPORTED_MODULE_3__.useState(false);\n  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {\n    if (!open) {\n      setIsClosing(true);\n      const timer = setTimeout(() => {\n        setIsClosing(false);\n      }, 300);\n      return () => clearTimeout(timer);\n    }\n  }, [open]);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(\n    StyledPaper,\n    {\n      elevation: 3,\n      isClosing,\n      isExpanded,\n      style: {\n        display: !open && !isClosing ? \"none\" : \"flex\",\n        pointerEvents: !open && !isClosing ? \"none\" : \"auto\"\n      },\n      children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          Header_default,\n          {\n            title,\n            onClose: () => {\n              setIsClosing(true);\n              setTimeout(() => {\n                onClose();\n              }, 300);\n            },\n            allAttachments,\n            onExpand: () => setIsExpanded(!isExpanded),\n            isExpanded,\n            avatar,\n            conversationId,\n            participants,\n            renderParticipant\n          }\n        ),\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n          Chat,\n          {\n            config,\n            participants,\n            isLoading,\n            defaultMessages,\n            conversationId,\n            onReceiveMessage,\n            onSendMessage,\n            onMessageSeen,\n            onLoadMoreMessages,\n            totalMessages,\n            buttonJoin\n          }\n        )\n      ]\n    }\n  );\n};\n\n// src/client/components/FloatingButton/index.tsx\n\n\n// src/client/components/FloatingButton/styles.ts\n\n\nvar StyledFab = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_8__.styled)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Fab)(({ theme }) => ({\n  position: \"fixed\",\n  bottom: theme.spacing(4),\n  right: theme.spacing(4),\n  zIndex: 1e3\n}));\n\n// src/client/components/FloatingButton/index.tsx\n\nvar FloatingButton = ({\n  icon,\n  onClick,\n  color = \"primary\",\n  size = \"large\",\n  sx,\n  tooltip\n}) => {\n  const theme = (0,_mui_material__WEBPACK_IMPORTED_MODULE_7__.useTheme)();\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n    _mui_material__WEBPACK_IMPORTED_MODULE_7__.Zoom,\n    {\n      in: true,\n      timeout: {\n        enter: 225,\n        exit: 195\n      },\n      style: {\n        transitionDelay: \"0ms\"\n      },\n      unmountOnExit: true,\n      children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n        StyledFab,\n        {\n          onClick,\n          color,\n          size,\n          \"aria-label\": tooltip,\n          sx,\n          children: icon\n        }\n      )\n    }\n  );\n};\n\n// src/client/components/ChatBubble/index.tsx\n\nvar ChatBubble = ({\n  onClick,\n  unreadCount = 0,\n  color = \"primary\",\n  title = \"Chat\",\n  conversationId,\n  defaultMessages,\n  participants,\n  onReceiveMessage,\n  onSendMessage,\n  renderParticipant,\n  config,\n  isLoading,\n  onMessageSeen,\n  onLoadMoreMessages,\n  allAttachments,\n  totalMessages,\n  buttonJoin\n}) => {\n  const [isOpen, setIsOpen] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false);\n  const handleClick = () => {\n    setIsOpen(!isOpen);\n    onClick == null ? void 0 : onClick();\n  };\n  const icon = unreadCount > 0 ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.Badge, { badgeContent: unreadCount, color: \"error\", max: 99, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Chat__WEBPACK_IMPORTED_MODULE_29__[\"default\"], {}) }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_mui_icons_material_Chat__WEBPACK_IMPORTED_MODULE_29__[\"default\"], {});\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      FloatingButton,\n      {\n        icon,\n        onClick: handleClick,\n        color,\n        tooltip: \"Ouvrir le chat\",\n        sx: {\n          \"&:hover\": {\n            transform: \"scale(1.1)\"\n          }\n        }\n      }\n    ),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(\n      ChatPopup,\n      {\n        participants,\n        renderParticipant,\n        open: isOpen,\n        onClose: () => setIsOpen(false),\n        title,\n        conversationId,\n        defaultMessages,\n        onReceiveMessage,\n        onSendMessage,\n        onMessageSeen,\n        config,\n        isLoading,\n        onLoadMoreMessages,\n        allAttachments,\n        totalMessages,\n        buttonJoin\n      }\n    )\n  ] });\n};\n\n//# sourceMappingURL=index.mjs.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vcGFja2FnZXMvbmV4dC1wdXNoZXItY2hhdC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEVBQThFLDZEQUE2RDtBQUMzSTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUM0QjtBQUM1QixpQkFBaUIsbUNBQU07QUFDdkI7QUFDQSxPQUFPLHNCQUFrQztBQUN6QztBQUNBLFdBQVcsSUFBc0M7QUFDakQsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxrQ0FBa0M7QUFDM0U7QUFDQSxpQkFBaUI7QUFDakIsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxnQ0FBZ0M7QUFDM0U7QUFDQSxtQkFBbUI7QUFDbkIsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsUUFBUSx3QkFBd0I7QUFDaEM7QUFDQTtBQUNBOztBQUVBO0FBQzZCO0FBQzdCLGtCQUFrQixtQ0FBTztBQUN6QjtBQUNBLE9BQU8sc0JBQWtDO0FBQ3pDO0FBQ0EsV0FBVyxJQUFzQztBQUNqRCxDQUFDO0FBQ0Q7QUFDQTtBQUNBLFlBQVksdUJBQXVCO0FBQ25DO0FBQ0EsMkNBQTJDLGdEQUFnRDtBQUMzRjtBQUNBLG1CQUFtQjtBQUNuQixPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxpQkFBaUI7QUFDakIsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsTUFBbUM7QUFDbEQsYUFBYSxNQUFpQyxJQUFJLENBQU07QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsb0JBQW9CLElBQUksUUFBUTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ29DO0FBQ3BDLDJCQUEyQix1REFBdUQ7QUFDbEY7QUFDQSx1Q0FBdUMsZ0RBQU07QUFDN0Msb0JBQW9CLE9BQU8sMkJBQTJCLE1BQU0sUUFBUSxRQUFRLHNCQUFzQixlQUFlO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsNEJBQTRCLGVBQWU7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLGVBQWUsb0RBQVc7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVUsd0JBQXdCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSx3QkFBd0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsd0JBQXdCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3dEOztBQUV4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGVBQWU7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLE9BQU8sbUNBQW1DLFlBQVk7QUFDMUU7QUFDQTtBQUNBLGNBQWMsa0NBQWtDO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLE9BQU87QUFDN0I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGNBQWMsa0NBQWtDO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLE9BQU87QUFDN0I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGNBQWMsa0NBQWtDO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLE9BQU87QUFDN0I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTyxzQkFBc0IsYUFBYTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDMkQ7QUFDM0I7O0FBRWhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0Esc0JBQXNCLE9BQU87QUFDN0I7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLHNCQUFzQixPQUFPO0FBQzdCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ21DO0FBQ0s7QUFDeEMsb0JBQW9CLG9EQUFhO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGdEQUFnRCwrQ0FBUTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiwrQ0FBUTtBQUN2QyxFQUFFLGdEQUFTO0FBQ1gsb0JBQW9CLE9BQU87QUFDM0IsZ0VBQWdFO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCw2QkFBNkIsc0NBQU8sQ0FBQyxzQkFBa0MsSUFBSSxDQUFFO0FBQzdFLGVBQWUsSUFBc0MsSUFBSSxDQUFJO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLG1FQUFtRTtBQUNuRSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLE9BQU87QUFDN0I7QUFDQTtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsc0RBQUcsMkJBQTJCLHNDQUFzQyxzQkFBc0IseUJBQXlCLGFBQWE7QUFDeko7QUFDQTtBQUNBLGtCQUFrQixpREFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsVUFBVSx1Q0FBdUM7QUFDakQsdUJBQXVCLDZDQUFNO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsT0FBTywyREFBMkQsZUFBZTtBQUNyRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixPQUFPLCtEQUErRCxlQUFlO0FBQy9HO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTyxpRUFBaUUsZUFBZTtBQUM3RztBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNtRTtBQUM5QjtBQUNyQyxpQkFBaUIseUZBQXlGO0FBQzFHLFVBQVUsMEVBQTBFO0FBQ3BGLHVCQUF1Qiw2Q0FBTztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixPQUFPLGtEQUFrRCxlQUFlO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLE9BQU8sc0RBQXNELGVBQWU7QUFDdEc7QUFDQTtBQUNBLHNCQUFzQixPQUFPLHdEQUF3RCxlQUFlO0FBQ3BHO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsNEJBQTRCLHNCQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZ0RBQU87QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFRZTs7QUFFZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUN1Qjs7QUFFdkI7QUFDQTtBQUNBLHlDQUF5QztBQUN6Qzs7QUFFQTtBQUNnRDtBQUNoRCxrQkFBa0Isb0RBQWM7QUFDaEM7QUFDQSxrQkFBa0IsaURBQVc7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCx1QkFBdUIsOENBQU87QUFDOUI7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDJDQUFlO0FBQ2pELHNEQUFzRCwyQ0FBZTtBQUNyRSx3Q0FBd0MsMkNBQWU7QUFDdkQsZ0NBQWdDLDJDQUFlO0FBQy9DLHdDQUF3QywyQ0FBZTtBQUN2RCxzQ0FBc0MsMkNBQWU7QUFDckQsVUFBVSxTQUFTO0FBQ25CLHFCQUFxQix5Q0FBYTtBQUNsQywwREFBMEQsMkNBQWU7QUFDekU7QUFDQSwyQkFBMkIseUNBQWE7QUFDeEMsNkJBQTZCLDZDQUFPO0FBQ3BDLDBCQUEwQiw2Q0FBTztBQUNqQyx5QkFBeUIsOENBQWtCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSx1QkFBdUIsOENBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHdDQUF3QztBQUN0RDtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCxFQUFFLDRDQUFnQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLDRDQUFnQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLHVCQUF1QiwyQkFBMkI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsY0FBYyxrQ0FBa0M7QUFDaEQ7QUFDQSxxR0FBcUc7QUFDckc7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsdUJBQXVCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0EsR0FBRztBQUNILHNCQUFzQixrREFBWTtBQUNsQztBQUNBLGNBQWMsa0NBQWtDO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixnQkFBZ0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVCw4RUFBOEU7QUFDOUU7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGtEQUFZO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxvQ0FBb0MsMENBQVE7QUFDNUMsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEdBQUc7QUFDSCxnQ0FBZ0Msa0RBQVk7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHdDQUFNLG1CQUFtQixRQUFRO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCw4Q0FBOEM7QUFDdkc7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsRUFBRSxnREFBVTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixzREFBSTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNvQztBQUNVO0FBQzlDLGNBQWMsNERBQU0sQ0FBQyw4Q0FBRyxLQUFLLE9BQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCw4QkFBOEIsNERBQU0sQ0FBQyw4Q0FBRyxLQUFLLE9BQU87QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCwwQkFBMEIsNERBQU0sQ0FBQyw4Q0FBRyxLQUFLLE9BQU87QUFDaEQ7QUFDQTtBQUNBLENBQUM7QUFDRCwwQkFBMEIsNERBQU0sQ0FBQyw4Q0FBRyxLQUFLLE9BQU87QUFDaEQ7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELHlCQUF5Qiw0REFBTSxDQUFDLDhDQUFHLEtBQUssT0FBTztBQUMvQztBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ29EO0FBQ0s7QUFDekQsdUJBQXVCLDREQUFPLENBQUMsOENBQUksS0FBSyxPQUFPO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsbUJBQW1CLDREQUFPLENBQUMsaURBQU0sS0FBSyxPQUFPO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDJCQUEyQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ3VFO0FBQ2xDO0FBQ3FDO0FBQzFCO0FBQ2hEO0FBQ0EsVUFBVSxnQkFBZ0I7QUFDMUIsVUFBVSw2QkFBNkI7QUFDdkMsc0NBQXNDLCtDQUFTO0FBQy9DLEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsc0RBQUkscUJBQXFCLDBCQUEwQixzREFBSSxDQUFDLCtDQUFJLElBQUksMENBQTBDLHNEQUFJO0FBQ3ZJO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHNEQUFJLENBQUMsNkVBQXFCLElBQUk7QUFDOUQ7QUFDQSxLQUFLLEdBQUc7QUFDUjs7QUFFQTtBQUMrRDtBQUNOO0FBQ3pELHdCQUF3Qiw0REFBTyxDQUFDLDhDQUFJLEtBQUssT0FBTztBQUNoRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QscUJBQXFCLDREQUFPLENBQUMsaURBQU8sS0FBSyxPQUFPO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ2lEO0FBQ3FCO0FBQzVCO0FBQ007QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLCtCQUErQiw2Q0FBTztBQUN0Qyw0QkFBNEIsNkNBQU87QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixzREFBSSxzQkFBc0IsMEJBQTBCLHNEQUFJO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0Msc0RBQUksQ0FBQywyREFBZ0IsSUFBSSxVQUFVLG9CQUFvQixzREFBSSxDQUFDLDRFQUFtQixJQUFJO0FBQ2xJO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDdUQ7QUFDRTtBQUN6RCxxQkFBcUIsNERBQU8sQ0FBQyw4Q0FBSSxLQUFLLE9BQU87QUFDN0M7QUFDQSwwQkFBMEIsc0JBQXNCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsa0JBQWtCLDREQUFPLENBQUMsb0RBQVMsS0FBSyxPQUFPO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDMEY7QUFDOUM7QUFDTTs7QUFFbEQ7QUFDaUU7QUFDcEI7QUFDcUM7QUFDcEM7QUFDUTtBQUN0RDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsa0NBQWtDLCtDQUFTO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdURBQUksQ0FBQyw4Q0FBSSxJQUFJO0FBQ3RDLG9CQUFvQixzREFBSTtBQUN4QixNQUFNLHFEQUFVO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxrQ0FBa0Msc0RBQUksQ0FBQyxrRkFBeUIsSUFBSTtBQUNwRTtBQUNBO0FBQ0Esb0JBQW9CLHNEQUFJO0FBQ3hCLE1BQU0sa0RBQU87QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Qsa0NBQWtDLHNEQUFJO0FBQ3RDLFVBQVUsZ0RBQVc7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDa0Q7QUFDRjtBQUNoRCxrQkFBa0IsMkJBQTJCO0FBQzdDO0FBQ0EseUJBQXlCLHNEQUFJO0FBQzdCLElBQUksOENBQUk7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHVFQUF1RSxzREFBSTtBQUMzRSxRQUFRLCtDQUFJO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3VFO0FBQ047QUFDTDtBQUNHO0FBQy9EO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxrQ0FBa0MsK0NBQVM7QUFDM0MsdUJBQXVCLDZDQUFPO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVEQUFLLENBQUMsOENBQUksSUFBSTtBQUN2QyxvQkFBb0Isc0RBQUk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQUk7QUFDeEIsTUFBTSxxREFBVztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0Esa0NBQWtDLHNEQUFJLENBQUMsdUVBQWMsSUFBSTtBQUN6RDtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ2dEOztBQUVoRDtBQUM4RztBQUM3QztBQUNuQjtBQUNFO0FBQ2U7QUFDL0Q7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELHdDQUF3QywrQ0FBUztBQUNqRCw0Q0FBNEMsK0NBQVM7QUFDckQsMkJBQTJCLDZDQUFPO0FBQ2xDLG1CQUFtQiw2Q0FBTztBQUMxQix5QkFBeUIsNkNBQU87QUFDaEM7QUFDQTtBQUNBLGlFQUFpRSxhQUFhO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxLQUFLLEdBQUcsaUNBQWlDO0FBQ3ZEO0FBQ0EseUJBQXlCLHVEQUFLLENBQUMsOENBQUksSUFBSSxNQUFNLCtDQUErQztBQUM1RixvQkFBb0Isc0RBQUk7QUFDeEIsTUFBTSxxREFBVztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsZ0RBQWdELHNEQUFJLENBQUMsaUVBQVEsSUFBSSxvQkFBb0Isc0RBQUksQ0FBQyxnRUFBTyxJQUFJO0FBQ3JHO0FBQ0E7QUFDQSxtQ0FBbUMsdURBQUssQ0FBQyw4Q0FBSSxJQUFJLE1BQU0sK0NBQStDO0FBQ3RHLHNCQUFzQixzREFBSSxDQUFDLDJEQUFpQixJQUFJLDBCQUEwQjtBQUMxRSxzQkFBc0Isc0RBQUksV0FBVyxTQUFTLHlDQUF5Qyx3Q0FBd0M7QUFDL0gsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQTtBQUMrRDtBQUMvRDtBQUNBLFVBQVUsOERBQThEO0FBQ3hFLG1CQUFtQiw2Q0FBTztBQUMxQixnQ0FBZ0MsK0NBQVM7QUFDekMsa0NBQWtDLCtDQUFTO0FBQzNDLDJCQUEyQiw2Q0FBTztBQUNsQyw4QkFBOEIsNkNBQU87QUFDckMsNENBQTRDLCtDQUFTO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLGdEQUFVO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLFdBQVc7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVEQUFLLENBQUMsOENBQUksSUFBSTtBQUN2QyxvQkFBb0Isc0RBQUkscUJBQXFCLDREQUE0RDtBQUN6RyxvQkFBb0IsdURBQUssbUJBQW1CO0FBQzVDLHdFQUF3RSxzREFBSTtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RUFBdUUsc0RBQUk7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLHNEQUFJO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixzREFBSTtBQUMxQjtBQUNBO0FBQ0Esd0JBQXdCLGVBQWU7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isc0RBQUk7QUFDMUIsUUFBUSxpREFBTztBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3QkFBd0I7QUFDaEQsc0JBQXNCO0FBQ3RCLFdBQVc7QUFDWCxvQ0FBb0Msc0RBQUksQ0FBQyxpRUFBUSxJQUFJLG1CQUFtQjtBQUN4RTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQTtBQUMwQjtBQUNxRjs7QUFFL0c7QUFDdUU7QUFDZDtBQUN6RCx1QkFBdUIsNERBQU8sQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGtCQUFrQiw0REFBTyxDQUFDLHFEQUFVLEtBQUssT0FBTztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsbUJBQW1CLDREQUFPLENBQUMsOENBQUssS0FBSyxPQUFPO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxvQkFBb0IsNERBQU8sQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QscUJBQXFCLDREQUFPLENBQUMsOENBQUssS0FBSyxPQUFPO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QscUJBQXFCLDREQUFPLENBQUMsOENBQUssS0FBSyxPQUFPO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxvQkFBb0IsNERBQU8sQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsdUJBQXVCLDREQUFPLENBQUMsOENBQUs7QUFDcEMsS0FBSyxpQkFBaUI7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFNBQVM7QUFDdkI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHFCQUFxQiw0REFBTyxDQUFDLDhDQUFLLEtBQUssT0FBTztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGtCQUFrQiw0REFBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsbUJBQW1CLDREQUFPLENBQUMsOENBQUssS0FBSyxPQUFPO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsbUJBQW1CLDREQUFPLENBQUMsaURBQU0sS0FBSyxPQUFPO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDJCQUEyQiw0REFBTyxDQUFDLDhDQUFLLEtBQUssT0FBTztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGtCQUFrQiw0REFBTztBQUN6QixLQUFLLE9BQU87QUFDWjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsTUFBTTtBQUM5QjtBQUNBLEdBQUc7QUFDSDtBQUNBLHdCQUF3Qiw0REFBTyxDQUFDLDhDQUFLLEtBQUssT0FBTztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxvQkFBb0IsNERBQU8sQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0JBQXNCO0FBQzdDLENBQUM7QUFDRCxlQUFlLDREQUFPLENBQUMsK0NBQUksS0FBSyxPQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxlQUFlLDREQUFPLENBQUMscURBQVUsS0FBSyxPQUFPO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxrQkFBa0IsNERBQU8sV0FBVyxPQUFPO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ3VGOztBQUV2RjtBQUM2QztBQUNZO0FBQ3pELDBCQUEwQiw0REFBTyxDQUFDLDhDQUFLO0FBQ3ZDO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EscUNBQXFDLGtCQUFrQixJQUFJLGtCQUFrQixFQUFFLGlCQUFpQixTQUFTLGtCQUFrQixFQUFFLGtCQUFrQixFQUFFLGlCQUFpQjtBQUNsSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvQkFBb0IsNERBQU8sQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ2dEOztBQUVoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDbUc7QUFDbEM7QUFDZjtBQUNRO0FBQ007QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxLQUFLLEdBQUcsaUNBQWlDO0FBQ3JEO0FBQ0Esc0JBQXNCLEtBQUs7QUFDM0Isb0NBQW9DLCtDQUFTO0FBQzdDLHdDQUF3QywrQ0FBUztBQUNqRCxrQ0FBa0MsK0NBQVM7QUFDM0MsbUJBQW1CLDZDQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1REFBSyxtQkFBbUI7QUFDakQsb0JBQW9CLHNEQUFLO0FBQ3pCLE1BQU0scURBQVc7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxtQkFBbUIsZ0JBQWdCO0FBQ25DLG9CQUFvQjtBQUNwQixTQUFTO0FBQ1QsOENBQThDLHNEQUFLLENBQUMsa0VBQVMsSUFBSSxvQkFBb0Isc0RBQUssQ0FBQyxzRUFBYSxJQUFJO0FBQzVHO0FBQ0E7QUFDQSxvQkFBb0IsdURBQUssQ0FBQyw4Q0FBSyxJQUFJLE1BQU0saURBQWlEO0FBQzFGLHNCQUFzQixzREFBSyxrQkFBa0IsMEJBQTBCLHNEQUFLLHFCQUFxQixVQUFVLEdBQUc7QUFDOUcsc0JBQXNCLHVEQUFLO0FBQzNCLFFBQVEsOENBQUs7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLDRCQUE0QixzREFBSztBQUNqQyxjQUFjLHFEQUFXO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLDRCQUE0QjtBQUMxRCw4QkFBOEI7QUFDOUIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixzREFBSztBQUNqQyxjQUFjLHFEQUFXO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLDRCQUE0QjtBQUMxRCw4QkFBOEIsd0JBQXdCO0FBQ3REO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7O0FBRUE7QUFDMEQ7O0FBRTFEO0FBQ21FO0FBQ2pCO0FBQ007QUFDN0I7QUFDeUI7QUFDRTtBQUNVO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsNEJBQTRCLDJDQUFlO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixzREFBSztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHVEQUFLLHlCQUF5QjtBQUM5RCx3QkFBd0IsdURBQUssc0JBQXNCO0FBQ25ELDBCQUEwQixzREFBSyxDQUFDLGtEQUFPLElBQUksK0NBQStDLHNEQUFLLENBQUMscURBQVcsSUFBSSw2QkFBNkIsZ0JBQWdCLDRCQUE0QixzREFBSyxDQUFDLG1FQUFVLElBQUksR0FBRyxHQUFHO0FBQ2xOLDBCQUEwQixzREFBSyxDQUFDLGtEQUFPLElBQUksb0RBQW9ELHNEQUFLLENBQUMscURBQVcsSUFBSSw4QkFBOEIsZ0JBQWdCLDRCQUE0QixzREFBSyxDQUFDLG9FQUFXLElBQUksR0FBRyxHQUFHO0FBQ3pOLDBCQUEwQixzREFBSyxDQUFDLGtEQUFPLElBQUksc0RBQXNELHNEQUFLLENBQUMscURBQVcsSUFBSSwrQkFBK0IsZ0JBQWdCLDRCQUE0QixzREFBSyxDQUFDLHFFQUFZLElBQUksR0FBRyxHQUFHO0FBQzdOLDBCQUEwQixzREFBSyxDQUFDLGtEQUFPLElBQUksMkNBQTJDLHNEQUFLLENBQUMscURBQVcsSUFBSSw0QkFBNEIsZ0JBQWdCLDRCQUE0QixzREFBSyxDQUFDLGtFQUFTLElBQUksR0FBRyxHQUFHO0FBQzVNLFdBQVc7QUFDWCx3QkFBd0Isc0RBQUs7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDMkI7QUFDK0M7QUFDMUUsbUJBQW1CLG1CQUFtQjtBQUN0QywwQ0FBMEMsMkNBQWU7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdURBQUssQ0FBQyx1REFBUSxJQUFJO0FBQzNDLG9CQUFvQix1REFBSyxtQkFBbUI7QUFDNUMsc0JBQXNCLHNEQUFLLGdCQUFnQiw2QkFBNkI7QUFDeEUsc0JBQXNCLHNEQUFLLGlCQUFpQixzREFBc0Qsc0RBQUssQ0FBQyxxREFBVyxJQUFJLHFFQUFxRSxHQUFHO0FBQy9MLE9BQU87QUFDUCxvQkFBb0Isc0RBQUs7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUM2QztBQUN5QjtBQUNOO0FBQ2hFLHFCQUFxQixXQUFXO0FBQ2hDLHlCQUF5Qix1REFBSyxrQkFBa0I7QUFDaEQsb0JBQW9CLHNEQUFLLGdCQUFnQiwwQkFBMEIsc0RBQUssQ0FBQyw0RUFBbUIsSUFBSSxHQUFHO0FBQ25HLG9CQUFvQixzREFBSyxDQUFDLDhDQUFLLElBQUksTUFBTSxzQkFBc0IsNEJBQTRCLHNEQUFLLGFBQWEsbUZBQW1GLHNEQUFLLGFBQWEsZ0RBQWdELEdBQUcsR0FBRztBQUN4USxLQUFLO0FBQ0w7O0FBRUE7QUFDaUQ7QUFDakQ7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixzREFBSyxrQkFBa0I7QUFDaEQ7QUFDQSw2QkFBNkIsc0RBQUs7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsTUFBTTtBQUNOLDZCQUE2QixzREFBSyxpQkFBaUIscUJBQXFCO0FBQ3hFLE1BQU07QUFDTiw2QkFBNkIsc0RBQUs7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsR0FBRyxHQUFHO0FBQ047O0FBRUE7QUFDMkI7QUFDcUM7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHVEQUFLLGtCQUFrQjtBQUNwRCx3QkFBd0Isc0RBQUs7QUFDN0IsVUFBVSwrQ0FBSztBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzREFBSztBQUM3QixVQUFVLGlFQUFRO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSwyQkFBMkIsc0RBQUssQ0FBQywyQ0FBZSxJQUFJLGdCQUFnQjtBQUNwRSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELHlCQUF5QixzREFBSztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsdURBQUssQ0FBQyw4Q0FBSyxJQUFJO0FBQy9DLHdCQUF3QixzREFBSztBQUM3QixVQUFVLHFEQUFXO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix3QkFBd0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHNEQUFLLGlCQUFpQiwwQkFBMEI7QUFDdkYsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUMyQjs7QUFFM0I7QUFDNkY7QUFDL0I7QUFDYzs7QUFFNUU7QUFDNkM7QUFDWTtBQUN6RCxvQkFBb0IsNERBQU8sQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQzRCO0FBQ3FDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLGdJQUFnSTtBQUNoSTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EseUNBQXlDLHNEQUFLLENBQUMsOENBQUssSUFBSSxnRUFBZ0UsdURBQU07QUFDOUgsSUFBSSxxREFBVztBQUNmO0FBQ0E7QUFDQSxZQUFZLGtCQUFrQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQSxRQUFRLG9DQUFNO0FBQ2Q7QUFDQSxLQUFLO0FBQ0w7QUFDQSxNQUFNO0FBQ04seUJBQXlCLHNEQUFLLGtCQUFrQiwwQkFBMEIsc0RBQUssQ0FBQyxrREFBUSxJQUFJLDJFQUEyRSxzREFBSyxDQUFDLHdFQUFlLElBQUksb0JBQW9CLHNEQUFLLENBQUMsK0VBQXNCLElBQUksR0FBRyxHQUFHO0FBQzFQOztBQUVBO0FBQzREO0FBQ2pDO0FBQ3NCO0FBQ2pELGlCQUFpQiw2Q0FBaUI7QUFDbEMsS0FBSyxpQkFBaUI7QUFDdEI7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHNEQUFLLENBQUMsa0RBQVEsSUFBSSwyRUFBMkUsc0RBQUs7QUFDN0gsTUFBTSxpREFBTTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsV0FBVztBQUNsQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxnQkFBZ0IsSUFBSTtBQUNwQjs7QUFFQTtBQUM2QjtBQUNvQztBQUNqRSwyQ0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSix3QkFBd0IseUNBQWE7QUFDckMsdUJBQXVCLHlDQUFhO0FBQ3BDLG9EQUFvRCwyQ0FBZTtBQUNuRSx5QkFBeUIseUNBQWE7QUFDdEMsRUFBRSw0Q0FBZ0I7QUFDbEI7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUUsNENBQWdCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLDJCQUEyQixzREFBSztBQUNoQyxNQUFNLDhDQUFLO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Qsa0NBQWtDLHNEQUFLLENBQUMsMkRBQWlCLElBQUk7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsdURBQU0scUJBQXFCO0FBQ3RELHNCQUFzQixzREFBSyxrQkFBa0IsMEJBQTBCLHNEQUFLO0FBQzVFLFFBQVEscURBQVc7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFNBQVM7QUFDVCxzQkFBc0Isc0RBQUssVUFBVSxvQkFBb0I7QUFDekQsT0FBTztBQUNQO0FBQ0EseUJBQXlCLHVEQUFNLHFCQUFxQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdJQUF3SSxvQ0FBTztBQUMvSSxRQUFRLG9DQUFPO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isc0RBQUssa0JBQWtCLDBCQUEwQixzREFBSztBQUNyRixVQUFVLHFEQUFXO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSw2QkFBNkIsc0RBQUs7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsdURBQU0sbUJBQW1CO0FBQzdELDhDQUE4QyxzREFBSyxDQUFDLDhDQUFLLElBQUksTUFBTSxlQUFlLDRCQUE0QixzREFBSyxlQUFlLHNDQUFzQyxHQUFHO0FBQzNLLDRCQUE0Qix1REFBTSxDQUFDLDhDQUFLLElBQUksTUFBTSxtREFBbUQ7QUFDckcsOEJBQThCLHNEQUFLO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLHVEQUFNO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQSxvQ0FBb0Msc0RBQUssV0FBVyxVQUFVLG9DQUFPLCtDQUErQztBQUNwSCxxREFBcUQsc0RBQUs7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZiw2Q0FBNkMsc0RBQUssQ0FBQyw4Q0FBSyxJQUFJLE1BQU0sZUFBZSw0QkFBNEIsc0RBQUssZUFBZSxzQ0FBc0MsR0FBRztBQUMxSyxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsb0JBQW9CLHNEQUFLLFVBQVUsb0JBQW9CO0FBQ3ZELEtBQUs7QUFDTDs7QUFFQTtBQUNvRTtBQUNHOztBQUV2RTtBQUM2QztBQUNZO0FBQ3pELGdCQUFnQiw0REFBTyxDQUFDLDhDQUFLLEtBQUssT0FBTztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ2lEO0FBQ2pEO0FBQ0EsVUFBVSxvQ0FBb0M7QUFDOUMsb0NBQW9DLCtDQUFTO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUIsTUFBTTtBQUNOLGdCQUFnQixVQUFVLEtBQUssVUFBVTtBQUN6QyxNQUFNO0FBQ04sZ0JBQWdCLFNBQVMsSUFBSSxVQUFVLEtBQUssa0JBQWtCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixzREFBSyxDQUFDLG1EQUFRLElBQUkscUJBQXFCLE9BQU8sNEJBQTRCLHNEQUFLLGNBQWMsMEJBQTBCLHNEQUFLO0FBQ3JKLElBQUkscURBQVc7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLLEdBQUc7QUFDUjs7QUFFQTtBQUN3RjtBQUN4RjtBQUNBLFVBQVUsZ0JBQWdCO0FBQzFCLFVBQVUsYUFBYTtBQUN2Qix5QkFBeUIsdURBQU0sQ0FBQyx1REFBUyxJQUFJO0FBQzdDLG9CQUFvQix1REFBTSxZQUFZO0FBQ3RDLHNCQUFzQixzREFBSyxxQkFBcUI7QUFDaEQsc0JBQXNCLHNEQUFLLGdCQUFnQjtBQUMzQyxPQUFPO0FBQ1Asb0JBQW9CLHNEQUFLLGdCQUFnQjtBQUN6QyxvQkFBb0Isc0RBQUssb0JBQW9CO0FBQzdDLG9CQUFvQixzREFBSyxpQkFBaUI7QUFDMUMsS0FBSztBQUNMO0FBQ0EsbUNBQW1DLFlBQVk7QUFDL0MseUJBQXlCLHNEQUFLLENBQUMsdURBQVMsSUFBSSwwQkFBMEIsc0RBQUssWUFBWSxvREFBb0QsdURBQU0sNEJBQTRCO0FBQzdLLG9CQUFvQixzREFBSyx3QkFBd0IsY0FBYyxNQUFNLEdBQUc7QUFDeEUsb0JBQW9CLHNEQUFLLHdCQUF3Qix3Q0FBd0M7QUFDekYsb0JBQW9CLHNEQUFLLHVCQUF1Qix5RkFBeUY7QUFDekksS0FBSyxHQUFHLEdBQUc7QUFDWDtBQUNBO0FBQ0Esc0JBQXNCLDZCQUE2QjtBQUNuRDtBQUNBLDJCQUEyQixzREFBSyw4Q0FBOEMsV0FBVywwQ0FBMEMsc0RBQUssNEJBQTRCLEdBQUc7QUFDdks7QUFDQSx5QkFBeUIsc0RBQUssOEJBQThCLFlBQVk7QUFDeEU7O0FBRUE7QUFDK0M7QUFDVDtBQUNVOztBQUVoRDtBQUN5RDs7QUFFekQ7QUFDb0c7QUFDckQ7QUFDRDtBQUNvQjs7QUFFbEU7QUFDb0c7O0FBRXBHO0FBQ3dFO0FBQ2Y7QUFDekQsb0JBQW9CLDREQUFPLENBQUMsa0RBQVEsS0FBSyxPQUFPO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxpQkFBaUIsNERBQU8sQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDMUM7QUFDQSw2QkFBNkIsc0JBQXNCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsaUJBQWlCLDREQUFPLENBQUMsK0NBQUksS0FBSyxPQUFPO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDMEM7QUFDUzs7QUFFbkQ7QUFDNkM7QUFDYTtBQUMxRCxxQkFBcUIsNERBQVEsQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDaUQ7QUFDakQsa0JBQWtCLGVBQWU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixzREFBSyxtQkFBbUIscUVBQXFFLHNEQUFLLGNBQWMsZ0NBQWdDLHlDQUF5QyxzREFBSyxpQkFBaUIsZUFBZSxvQkFBb0Isc0RBQUssZ0JBQWdCLGdDQUFnQyxHQUFHO0FBQ25VOztBQUVBO0FBQ3VFO0FBQ2lCO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELG9CQUFvQiw2Q0FBTztBQUMzQix5QkFBeUIsdURBQU0sQ0FBQyx1REFBUyxJQUFJO0FBQzdDLG9CQUFvQixzREFBSztBQUN6QixNQUFNLHFEQUFXO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxrQ0FBa0Msc0RBQUssQ0FBQyw0RUFBb0IsSUFBSSxtQkFBbUI7QUFDbkY7QUFDQTtBQUNBLG9CQUFvQix1REFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsMEJBQTBCLHVEQUFNLGVBQWU7QUFDL0MsNEJBQTRCLHVEQUFNLENBQUMsOENBQUssSUFBSSxNQUFNLCtDQUErQztBQUNqRyw4QkFBOEIsc0RBQUssQ0FBQyw0RUFBb0IsSUFBSSxxQ0FBcUM7QUFDakcsOEJBQThCLHVEQUFNLENBQUMscURBQVksSUFBSTtBQUNyRDtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsZUFBZTtBQUNmLDRCQUE0QixzREFBSyxDQUFDLHFEQUFXLElBQUksMkRBQTJELHNEQUFLLENBQUMsa0VBQVUsSUFBSSxtQkFBbUIsR0FBRztBQUN0SixhQUFhO0FBQ2IsMEJBQTBCLHNEQUFLLGVBQWUsNEZBQTRGLHNEQUFLLENBQUMsOENBQUssSUFBSSxNQUFNLDJCQUEyQiw0QkFBNEIsc0RBQUssQ0FBQyxxREFBWSxJQUFJLDBHQUEwRyxHQUFHLDBGQUEwRixzREFBSyxhQUFhLE1BQU0sV0FBVztBQUN0ZDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFPdUI7QUFDdUI7QUFDVTs7QUFFeEQ7QUFPdUI7O0FBRXZCO0FBQzJGO0FBQ2pDO0FBQzFELHFCQUFxQiw0REFBUSxDQUFDLGtEQUFRLEtBQUssT0FBTztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsa0JBQWtCLDREQUFRLENBQUMsOENBQUssS0FBSyxPQUFPO0FBQzVDO0FBQ0EsNkJBQTZCLHNCQUFzQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELHdCQUF3Qiw0REFBUSxDQUFDLDhDQUFLLEtBQUssT0FBTztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxxQkFBcUIsNERBQVEsQ0FBQyxtREFBUSxLQUFLLE9BQU87QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsa0JBQWtCLDREQUFRLENBQUMsK0NBQUssS0FBSyxPQUFPO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDMkM7QUFDTztBQUNzQztBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELG9CQUFvQiw2Q0FBUTtBQUM1Qix5QkFBeUIsdURBQU0sQ0FBQyx1REFBUyxJQUFJO0FBQzdDLG9CQUFvQixzREFBSztBQUN6QixNQUFNLHFEQUFXO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxrQ0FBa0Msc0RBQUssQ0FBQyxrRUFBUyxJQUFJLG1CQUFtQjtBQUN4RTtBQUNBO0FBQ0Esb0JBQW9CLHVEQUFNO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQUssZ0JBQWdCLDBCQUEwQix1REFBTSxDQUFDLDhDQUFLLElBQUksTUFBTSwrQ0FBK0M7QUFDOUksNEJBQTRCLHNEQUFLLENBQUMsa0VBQVMsSUFBSSxxQ0FBcUM7QUFDcEYsNEJBQTRCLHVEQUFNLENBQUMscURBQVksSUFBSTtBQUNuRDtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsYUFBYSxHQUFHO0FBQ2hCLDBCQUEwQixzREFBSyxnQkFBZ0IsNERBQTRELHVEQUFNLG1CQUFtQjtBQUNwSSw0QkFBNEIsc0RBQUssQ0FBQyx1REFBWSxJQUFJLE1BQU0sY0FBYyxpRkFBaUYsc0RBQUssc0JBQXNCLDBCQUEwQixzREFBSztBQUNqTixjQUFjLHFEQUFZO0FBQzFCO0FBQ0E7QUFDQSxzQkFBc0IscUNBQXFDO0FBQzNEO0FBQ0E7QUFDQSxlQUFlLEdBQUc7QUFDbEIsNEJBQTRCLHNEQUFLO0FBQ2pDLGNBQWMsdURBQVk7QUFDMUI7QUFDQSx5Q0FBeUMsc0RBQUssQ0FBQyxxREFBWSxJQUFJLCtEQUErRDtBQUM5SDtBQUNBO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ3dGO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGtDQUFrQywrQ0FBUztBQUMzQyxnREFBZ0QsK0NBQVM7QUFDekQsc0RBQXNELCtDQUFTO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1REFBTSxDQUFDLHVEQUFTLElBQUk7QUFDN0Msb0JBQW9CLHNEQUFLLENBQUMsa0RBQVEsSUFBSSw0Q0FBNEMsc0RBQUs7QUFDdkYsTUFBTSxxREFBVztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Qsa0NBQWtDLHNEQUFLLENBQUMscUVBQVksSUFBSSxtQkFBbUI7QUFDM0U7QUFDQSxPQUFPO0FBQ1Asb0JBQW9CLHVEQUFNO0FBQzFCLE1BQU0sK0NBQUk7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDBCQUEwQix1REFBTSxDQUFDLG1EQUFRLElBQUk7QUFDN0MsNEJBQTRCLHNEQUFLO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHNEQUFLLENBQUMscURBQVksSUFBSSx5Q0FBeUM7QUFDM0YsYUFBYTtBQUNiLDBCQUEwQix1REFBTSxDQUFDLG1EQUFRLElBQUk7QUFDN0MsNEJBQTRCLHNEQUFLO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0RBQUssQ0FBQyxxREFBWSxJQUFJLDRDQUE0QztBQUM5RixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ3dEO0FBQ0U7QUFDOEI7QUFDeEYsc0JBQXNCLDREQUFRLENBQUMsOENBQUssS0FBSyxPQUFPO0FBQ2hEO0FBQ0EsNkJBQTZCLHNCQUFzQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxlQUFlLDREQUFRLENBQUMsOENBQUssS0FBSyxPQUFPO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxrQkFBa0IsNERBQVEsQ0FBQyw4Q0FBSyxLQUFLLE9BQU87QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsZUFBZSw0REFBUSxDQUFDLHFEQUFZLEtBQUssT0FBTztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxtQkFBbUIsNERBQVEsQ0FBQyxxREFBVyxLQUFLLE9BQU87QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxnREFBZ0QsK0NBQVU7QUFDMUQsc0RBQXNELCtDQUFVO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHVEQUFNLENBQUMsdURBQVMsSUFBSTtBQUNqRCx3QkFBd0Isc0RBQUssaUJBQWlCLGtGQUFrRixzREFBSztBQUNySTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsd0JBQXdCLHNEQUFLO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLHNEQUFLO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw2QkFBNkIsc0RBQUs7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdURBQU0sb0JBQW9CO0FBQ25ELG9CQUFvQix1REFBTSxhQUFhO0FBQ3ZDLGdDQUFnQyxzREFBSyxnQkFBZ0IsMEJBQTBCLHNEQUFLLFVBQVUsMkJBQTJCLEdBQUc7QUFDNUgsc0JBQXNCLHNEQUFLLENBQUMsOENBQUssSUFBSSwwQkFBMEIsc0RBQUssYUFBYSx1Q0FBdUMsR0FBRztBQUMzSCxPQUFPO0FBQ1Asb0JBQW9CLHVEQUFNLENBQUMsOENBQUssSUFBSSxNQUFNLHlCQUF5QjtBQUNuRTtBQUNBLGtDQUFrQyxzREFBSztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsaURBQWlELHNEQUFLLENBQUMsNEVBQWUsSUFBSSxtQkFBbUIsb0JBQW9CLHNEQUFLLENBQUMsdUVBQVUsSUFBSSxtQkFBbUI7QUFDeEo7QUFDQTtBQUNBLHNCQUFzQixzREFBSyxpQkFBaUIsMkRBQTJELHNEQUFLLENBQUMsa0VBQUssSUFBSSxtQkFBbUIsR0FBRztBQUM1SSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDc0M7QUFDb0I7QUFDMUQsa0JBQWtCLDREQUFRLENBQUMsZ0RBQUs7QUFDaEM7QUFDQSxDQUFDO0FBQ0QsS0FBSyw4QkFBOEI7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwyQkFBMkI7QUFDN0Msa0JBQWtCLDJCQUEyQjtBQUM3QztBQUNBLHlCQUF5QiwyQkFBMkI7QUFDcEQ7QUFDQTtBQUNBLFFBQVEsZ0NBQWdDO0FBQ3hDLFFBQVEsZ0NBQWdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNpRTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsb0NBQW9DLDJDQUFnQjtBQUNwRCxzQ0FBc0MsMkNBQWdCO0FBQ3RELEVBQUUsZ0RBQVU7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsR0FBRztBQUNILHlCQUF5Qix1REFBTTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0Esd0JBQXdCLHNEQUFLO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0RBQUs7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDK0M7O0FBRS9DO0FBQ29DO0FBQ3NCO0FBQzFELGdCQUFnQiw0REFBUSxDQUFDLDhDQUFHLEtBQUssT0FBTztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDaUQ7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsZ0JBQWdCLHVEQUFRO0FBQ3hCLHlCQUF5QixzREFBSztBQUM5QixJQUFJLCtDQUFJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsZ0NBQWdDLHNEQUFLO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3dGO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCw4QkFBOEIsK0NBQVU7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsc0RBQUssQ0FBQyxnREFBSyxJQUFJLDhFQUE4RSxzREFBSyxDQUFDLGlFQUFRLElBQUksR0FBRyxvQkFBb0Isc0RBQUssQ0FBQyxpRUFBUSxJQUFJO0FBQ3pNLHlCQUF5Qix1REFBTSxDQUFDLHVEQUFTLElBQUk7QUFDN0Msb0JBQW9CLHNEQUFLO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHNEQUFLO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFjRTtBQUNGLGtDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVzdC1hcHAtMTQvLi4vLi4vcGFja2FnZXMvbmV4dC1wdXNoZXItY2hhdC9kaXN0L2luZGV4Lm1qcz84N2I3Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZQcm9wcyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzO1xudmFyIF9fZ2V0T3duUHJvcERlc2NzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7XG52YXIgX19nZXRPd25Qcm9wU3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbnZhciBfX3Byb3BJc0VudW0gPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIF9fZGVmTm9ybWFsUHJvcCA9IChvYmosIGtleSwgdmFsdWUpID0+IGtleSBpbiBvYmogPyBfX2RlZlByb3Aob2JqLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSwgdmFsdWUgfSkgOiBvYmpba2V5XSA9IHZhbHVlO1xudmFyIF9fc3ByZWFkVmFsdWVzID0gKGEsIGIpID0+IHtcbiAgZm9yICh2YXIgcHJvcCBpbiBiIHx8IChiID0ge30pKVxuICAgIGlmIChfX2hhc093blByb3AuY2FsbChiLCBwcm9wKSlcbiAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgaWYgKF9fZ2V0T3duUHJvcFN5bWJvbHMpXG4gICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKGIpKSB7XG4gICAgICBpZiAoX19wcm9wSXNFbnVtLmNhbGwoYiwgcHJvcCkpXG4gICAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgICB9XG4gIHJldHVybiBhO1xufTtcbnZhciBfX3NwcmVhZFByb3BzID0gKGEsIGIpID0+IF9fZGVmUHJvcHMoYSwgX19nZXRPd25Qcm9wRGVzY3MoYikpO1xudmFyIF9fb2JqUmVzdCA9IChzb3VyY2UsIGV4Y2x1ZGUpID0+IHtcbiAgdmFyIHRhcmdldCA9IHt9O1xuICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoc291cmNlLCBwcm9wKSAmJiBleGNsdWRlLmluZGV4T2YocHJvcCkgPCAwKVxuICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdO1xuICBpZiAoc291cmNlICE9IG51bGwgJiYgX19nZXRPd25Qcm9wU3ltYm9scylcbiAgICBmb3IgKHZhciBwcm9wIG9mIF9fZ2V0T3duUHJvcFN5bWJvbHMoc291cmNlKSkge1xuICAgICAgaWYgKGV4Y2x1ZGUuaW5kZXhPZihwcm9wKSA8IDAgJiYgX19wcm9wSXNFbnVtLmNhbGwoc291cmNlLCBwcm9wKSlcbiAgICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgIH1cbiAgcmV0dXJuIHRhcmdldDtcbn07XG5cbi8vIHNyYy9zZXJ2ZXIvYXBpL2F1dGgvcm91dGUudHNcbmltcG9ydCBQdXNoZXIgZnJvbSBcInB1c2hlclwiO1xudmFyIHB1c2hlciA9IG5ldyBQdXNoZXIoe1xuICBhcHBJZDogcHJvY2Vzcy5lbnYuUFVTSEVSX0FQUF9JRCxcbiAga2V5OiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19QVVNIRVJfS0VZLFxuICBzZWNyZXQ6IHByb2Nlc3MuZW52LlBVU0hFUl9TRUNSRVQsXG4gIGNsdXN0ZXI6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1BVU0hFUl9DTFVTVEVSXG59KTtcbmFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdCkge1xuICBjb25zdCByZXF1ZXN0RGF0YSA9IGF3YWl0IHJlcXVlc3QuZm9ybURhdGEoKTtcbiAgY29uc3Qgc29ja2V0SWQgPSByZXF1ZXN0RGF0YS5nZXQoXCJzb2NrZXRfaWRcIik7XG4gIGNvbnN0IGNoYW5uZWwgPSByZXF1ZXN0RGF0YS5nZXQoXCJjaGFubmVsX25hbWVcIik7XG4gIGNvbnN0IHVzZXJJZCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJ4LXVzZXItaWRcIik7XG4gIGlmICghc29ja2V0SWQgfHwgIWNoYW5uZWwgfHwgIXVzZXJJZCkge1xuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogXCJQYXJhbVxceEU4dHJlcyBtYW5xdWFudHNcIiB9KSwge1xuICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH1cbiAgICB9KTtcbiAgfVxuICB0cnkge1xuICAgIGlmICghY2hhbm5lbC5zdGFydHNXaXRoKFwicHJpdmF0ZS1cIikpIHtcbiAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogXCJDYW5hbCBub24gYXV0b3Jpc1xceEU5XCIgfSksIHtcbiAgICAgICAgc3RhdHVzOiA0MDMsXG4gICAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGF1dGggPSBwdXNoZXIuYXV0aG9yaXplQ2hhbm5lbChzb2NrZXRJZCwgY2hhbm5lbCk7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShhdXRoKSwge1xuICAgICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJcXHUyNkEwXFx1RkUwRiBBdXRoIGZhaWxlZDpcIiwgZXJyKTtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBlcnJvcjogXCJcXHhDOWNoZWMgZGUgbCdhdXRoZW50aWZpY2F0aW9uXCIsXG4gICAgICAgIGRldGFpbHM6IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiBcIkluY29ubnVcIlxuICAgICAgfSksXG4gICAgICB7IHN0YXR1czogNDAxLCBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0gfVxuICAgICk7XG4gIH1cbn1cblxuLy8gc3JjL3NlcnZlci9hcGkvZXZlbnRzL3JvdXRlLnRzXG5pbXBvcnQgUHVzaGVyMiBmcm9tIFwicHVzaGVyXCI7XG52YXIgcHVzaGVyMiA9IG5ldyBQdXNoZXIyKHtcbiAgYXBwSWQ6IHByb2Nlc3MuZW52LlBVU0hFUl9BUFBfSUQsXG4gIGtleTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfUFVTSEVSX0tFWSxcbiAgc2VjcmV0OiBwcm9jZXNzLmVudi5QVVNIRVJfU0VDUkVULFxuICBjbHVzdGVyOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19QVVNIRVJfQ0xVU1RFUlxufSk7XG5hc3luYyBmdW5jdGlvbiBQT1NUMihyZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBldmVudCwgY2hhbm5lbCwgZGF0YSB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgaWYgKCFldmVudCB8fCAhY2hhbm5lbCB8fCAhZGF0YSkge1xuICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeSh7IGVycm9yOiBcIkV2ZW50LCBjaGFubmVsLCBhbmQgZGF0YSBhcmUgcmVxdWlyZWRcIiB9KSwge1xuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHVzaGVyMi50cmlnZ2VyKGNoYW5uZWwsIGV2ZW50LCBkYXRhKTtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHJlc3VsdCksIHtcbiAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBQT1NUIC9hcGkvY2hhdDpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgZXJyb3I6IFwiSW50ZXJuYWwgU2VydmVyIEVycm9yXCIsXG4gICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwiXG4gICAgfSksIHtcbiAgICAgIHN0YXR1czogNTAwLFxuICAgICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9XG4gICAgfSk7XG4gIH1cbn1cblxuLy8gc3JjL3NlcnZlci9hcGkvaW5kZXgudHNcbmFzeW5jIGZ1bmN0aW9uIFBPU1QzKHJlcXVlc3QpIHtcbiAgY29uc3QgY29udGVudFR5cGUgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpIHx8IFwiXCI7XG4gIGlmIChjb250ZW50VHlwZS5pbmNsdWRlcyhcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKSkge1xuICAgIHJldHVybiBQT1NUKHJlcXVlc3QpO1xuICB9XG4gIHJldHVybiBQT1NUMihyZXF1ZXN0KTtcbn1cblxuLy8gc3JjL2NsaWVudC91dGlscy9sb2dnZXIudHNcbnZhciBMb2dnZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgZW5hYmxlZDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRU5BQkxFX0xPR1MgPT09IFwidHJ1ZVwiLFxuICAgICAgbGV2ZWw6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0xPR19MRVZFTCB8fCBcImluZm9cIlxuICAgIH07XG4gIH1cbiAgc2hvdWxkTG9nKGxldmVsKSB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZy5lbmFibGVkKSByZXR1cm4gZmFsc2U7XG4gICAgY29uc3QgbGV2ZWxzID0gW1wiZGVidWdcIiwgXCJpbmZvXCIsIFwid2FyblwiLCBcImVycm9yXCJdO1xuICAgIHJldHVybiBsZXZlbHMuaW5kZXhPZihsZXZlbCkgPj0gbGV2ZWxzLmluZGV4T2YodGhpcy5jb25maWcubGV2ZWwpO1xuICB9XG4gIGZvcm1hdE1lc3NhZ2UobGV2ZWwsIG1lc3NhZ2UsIC4uLmFyZ3MpIHtcbiAgICByZXR1cm4gYFske2xldmVsLnRvVXBwZXJDYXNlKCl9XSAke21lc3NhZ2V9YDtcbiAgfVxuICBkZWJ1ZyhtZXNzYWdlLCAuLi5hcmdzKSB7XG4gICAgaWYgKHRoaXMuc2hvdWxkTG9nKFwiZGVidWdcIikpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcodGhpcy5mb3JtYXRNZXNzYWdlKFwiZGVidWdcIiwgbWVzc2FnZSksIC4uLmFyZ3MpO1xuICAgIH1cbiAgfVxuICBpbmZvKG1lc3NhZ2UsIC4uLmFyZ3MpIHtcbiAgICBpZiAodGhpcy5zaG91bGRMb2coXCJpbmZvXCIpKSB7XG4gICAgICBjb25zb2xlLmluZm8odGhpcy5mb3JtYXRNZXNzYWdlKFwiaW5mb1wiLCBtZXNzYWdlKSwgLi4uYXJncyk7XG4gICAgfVxuICB9XG4gIHdhcm4obWVzc2FnZSwgLi4uYXJncykge1xuICAgIGlmICh0aGlzLnNob3VsZExvZyhcIndhcm5cIikpIHtcbiAgICAgIGNvbnNvbGUud2Fybih0aGlzLmZvcm1hdE1lc3NhZ2UoXCJ3YXJuXCIsIG1lc3NhZ2UpLCAuLi5hcmdzKTtcbiAgICB9XG4gIH1cbiAgZXJyb3IobWVzc2FnZSwgLi4uYXJncykge1xuICAgIGlmICh0aGlzLnNob3VsZExvZyhcImVycm9yXCIpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKHRoaXMuZm9ybWF0TWVzc2FnZShcImVycm9yXCIsIG1lc3NhZ2UpLCAuLi5hcmdzKTtcbiAgICB9XG4gIH1cbn07XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlcigpO1xuXG4vLyBzcmMvc2VydmVyL3NlcnZpY2UvZXZlbnQudHNcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gXCJ1dWlkXCI7XG52YXIgcHVzaGVyRXZlbnQgPSBhc3luYyAoeyBldmVudCwgY29udmVyc2F0aW9uSWQsIGRhdGEsIGV2ZW50SWQ6IHByb3ZpZGVkRXZlbnRJZCB9KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZXZlbnRJZCA9IHByb3ZpZGVkRXZlbnRJZCB8fCB1dWlkdjQoKTtcbiAgICBsb2dnZXIuaW5mbyhgXFx1ezFGNTA0fSBUcmlnZ2VyaW5nIFB1c2hlciBldmVudCBbJHtldmVudH1dIGlkIFske2V2ZW50SWR9XSBmb3IgY29udmVyc2F0aW9uIFske2NvbnZlcnNhdGlvbklkfV06YCwgZGF0YSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcIi9hcGkvY2hhdFwiLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgY2hhbm5lbDogYHByaXZhdGUtJHtjb252ZXJzYXRpb25JZH1gLFxuICAgICAgICBldmVudCxcbiAgICAgICAgZGF0YTogX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgICAgIGV2ZW50SWQsXG4gICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICB9LCBkYXRhKVxuICAgICAgfSlcbiAgICB9KTtcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JEYXRhLmRldGFpbHMgfHwgXCJFcnJldXIgbG9ycyBkZSBsJ2Vudm9pIGRlIGwnXFx4RTl2XFx4RTluZW1lbnRcIik7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICByZXR1cm4ge1xuICAgICAgZXZlbnRJZCxcbiAgICAgIGRhdGE6IHJlc3VsdFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGluIHB1c2hlckV2ZW50OlwiLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbi8vIHNyYy9hZGFwdGVycy9wYWdlcy1yb3V0ZXIudHNcbmltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG52YXIgUGFnZXNSb3V0ZXJBZGFwdGVyID0gY2xhc3Mge1xuICBzdGF0aWMgY29udmVydFJlcXVlc3QocmVxKSB7XG4gICAgY29uc3Qgb3JpZ2luID0gcmVxLmhlYWRlcnMub3JpZ2luIHx8IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXEudXJsLCBvcmlnaW4pO1xuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgIE9iamVjdC5lbnRyaWVzKHJlcS5oZWFkZXJzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChrZXksIEFycmF5LmlzQXJyYXkodmFsdWUpID8gdmFsdWUuam9pbihcIiwgXCIpIDogdmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGxldCBib2R5O1xuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIikgfHwgXCJcIjtcbiAgICBpZiAoY29udGVudFR5cGUuaW5jbHVkZXMoXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIikpIHtcbiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICAgICAgaWYgKHJlcS5ib2R5KSB7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHJlcS5ib2R5KS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCBTdHJpbmcodmFsdWUpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBib2R5ID0gZm9ybURhdGEudG9TdHJpbmcoKTtcbiAgICB9IGVsc2UgaWYgKHJlcS5ib2R5KSB7XG4gICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkocmVxLmJvZHkpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IE5leHRSZXF1ZXN0KHVybC50b1N0cmluZygpLCB7XG4gICAgICBtZXRob2Q6IHJlcS5tZXRob2QgfHwgXCJHRVRcIixcbiAgICAgIGhlYWRlcnMsXG4gICAgICBib2R5XG4gICAgfSk7XG4gIH1cbiAgc3RhdGljIGFzeW5jIGNvbnZlcnRSZXNwb25zZShyZXNwb25zZSwgcmVzKSB7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICByZXMuc2V0SGVhZGVyKGtleSwgdmFsdWUpO1xuICAgIH0pO1xuICAgIHJlcy5zdGF0dXMocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIHJlcy5qc29uKGRhdGEpO1xuICB9XG59O1xuXG4vLyBzcmMvY2xpZW50L3NlcnZpY2VzL2NoYXQvZXZlbnQudHNcbnZhciBldmVudFNlbmRNZXNzYWdlRXZlbnQgPSBhc3luYyAoY29udmVyc2F0aW9uSWQsIGRhdGEpID0+IHtcbiAgY29uc3QgeyBkYXRhOiByZXN1bHQsIGV2ZW50SWQgfSA9IGF3YWl0IHB1c2hlckV2ZW50KHtcbiAgICBldmVudElkOiBkYXRhLmlkLFxuICAgIGV2ZW50OiBcIm5ldy1tZXNzYWdlXCIsXG4gICAgY29udmVyc2F0aW9uSWQsXG4gICAgZGF0YTogX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgZGF0YSksIHtcbiAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICB9KVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBldmVudElkLFxuICAgIGRhdGE6IHJlc3VsdFxuICB9O1xufTtcbnZhciBldmVudFR5cGluZ0V2ZW50ID0gYXN5bmMgKGNvbnZlcnNhdGlvbklkLCBkYXRhKSA9PiB7XG4gIGNvbnN0IHsgZGF0YTogcmVzdWx0LCBldmVudElkIH0gPSBhd2FpdCBwdXNoZXJFdmVudCh7XG4gICAgZXZlbnQ6IFwidXNlci10eXBpbmdcIixcbiAgICBjb252ZXJzYXRpb25JZCxcbiAgICBkYXRhXG4gIH0pO1xuICByZXR1cm4ge1xuICAgIGV2ZW50SWQsXG4gICAgZGF0YTogcmVzdWx0XG4gIH07XG59O1xudmFyIGV2ZW50TWVzc2FnZVNlZW5FdmVudCA9IGFzeW5jIChjb252ZXJzYXRpb25JZCwgZGF0YSkgPT4ge1xuICBjb25zdCB7IGRhdGE6IHJlc3VsdCwgZXZlbnRJZCB9ID0gYXdhaXQgcHVzaGVyRXZlbnQoe1xuICAgIGV2ZW50OiBcIm1lc3NhZ2Utc2VlblwiLFxuICAgIGNvbnZlcnNhdGlvbklkLFxuICAgIGRhdGFcbiAgfSk7XG4gIHJldHVybiB7XG4gICAgZXZlbnRJZCxcbiAgICBkYXRhOiByZXN1bHRcbiAgfTtcbn07XG5cbi8vIHNyYy9jbGllbnQvaG9va3MvdXNlQ2hhdFN1YnNjcmliZS50c1xuaW1wb3J0IHsgdXNlRWZmZWN0IGFzIHVzZUVmZmVjdDIsIHVzZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuXG4vLyBzcmMvY2xpZW50L3NlcnZpY2VzL2NoYXQvc3Vic2NyaWJlLnRzXG52YXIgcHJvY2Vzc2VkRXZlbnRJZHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xudmFyIGNyZWF0ZUNoYXRTdWJzY3JpYmVzID0gKHB1c2hlcjMsIHVzZXJJZCwgaGFuZGxlcnMpID0+IHtcbiAgY29uc3QgYWN0aXZlQ2hhbm5lbHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBjb25zdCBzZXR1cENvbnZlcnNhdGlvblN1YnNjcmliZXMgPSAoY29udmVyc2F0aW9uSWQpID0+IHtcbiAgICBjb25zdCBjaGFubmVsTmFtZSA9IGBwcml2YXRlLSR7Y29udmVyc2F0aW9uSWR9YDtcbiAgICBpZiAoYWN0aXZlQ2hhbm5lbHMuaGFzKGNoYW5uZWxOYW1lKSkge1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IGNoYW5uZWwgPSBwdXNoZXIzLnN1YnNjcmliZShjaGFubmVsTmFtZSk7XG4gICAgYWN0aXZlQ2hhbm5lbHMuYWRkKGNoYW5uZWxOYW1lKTtcbiAgICBsb2dnZXIuaW5mbyhgXFx1ezFGNEFDfSBbU3Vic2NyaWJlXSBOb3V2ZWF1IGNhbmFsIGFjdGlmOiAke2NoYW5uZWxOYW1lfWApO1xuICAgIGNoYW5uZWwuYmluZChcIm5ldy1tZXNzYWdlXCIsIChwcm9wcykgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgY29uc3QgeyBldmVudElkLCB1c2VySWQ6IHVzZXJJZFJlY2VpdmVkIH0gPSBwcm9wcztcbiAgICAgIGlmICghZXZlbnRJZCB8fCBwcm9jZXNzZWRFdmVudElkcy5oYXMoZXZlbnRJZCkgfHwgdXNlcklkUmVjZWl2ZWQgPT09IHVzZXJJZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBwcm9jZXNzZWRFdmVudElkcy5hZGQoZXZlbnRJZCk7XG4gICAgICBsb2dnZXIuaW5mbyhgXFx1ezFGNEFDfSBbTWVzc2FnZV0gTm91dmVhdSBtZXNzYWdlYCwgcHJvcHMpO1xuICAgICAgKF9hID0gaGFuZGxlcnMgPT0gbnVsbCA/IHZvaWQgMCA6IGhhbmRsZXJzLm9uTWVzc2FnZVJlY2VpdmVkKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY2FsbChoYW5kbGVycywgcHJvcHMpO1xuICAgIH0pO1xuICAgIGNoYW5uZWwuYmluZChcInVzZXItdHlwaW5nXCIsIChwcm9wcykgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgY29uc3QgeyBldmVudElkLCB1c2VySWQ6IHVzZXJJZFJlY2VpdmVkIH0gPSBwcm9wcztcbiAgICAgIGlmICghZXZlbnRJZCB8fCBwcm9jZXNzZWRFdmVudElkcy5oYXMoZXZlbnRJZCkgfHwgdXNlcklkUmVjZWl2ZWQgPT09IHVzZXJJZCB8fCAhKGhhbmRsZXJzID09IG51bGwgPyB2b2lkIDAgOiBoYW5kbGVycy5vblR5cGluZ1N0YXR1cykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgcHJvY2Vzc2VkRXZlbnRJZHMuYWRkKGV2ZW50SWQpO1xuICAgICAgbG9nZ2VyLmluZm8oYFxcdXsxRjRBQ30gW1R5cGluZ10gRW50clxceEU5ZSBkZSBmcmFwcGVgLCBwcm9wcyk7XG4gICAgICAoX2EgPSBoYW5kbGVycyA9PSBudWxsID8gdm9pZCAwIDogaGFuZGxlcnMub25UeXBpbmdTdGF0dXMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5jYWxsKGhhbmRsZXJzLCBwcm9wcyk7XG4gICAgfSk7XG4gICAgY2hhbm5lbC5iaW5kKFwibWVzc2FnZS1zZWVuXCIsIChwcm9wcykgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgY29uc3QgeyBldmVudElkLCB1c2VySWQ6IHVzZXJJZFJlY2VpdmVkIH0gPSBwcm9wcztcbiAgICAgIGlmICghZXZlbnRJZCB8fCBwcm9jZXNzZWRFdmVudElkcy5oYXMoZXZlbnRJZCkgfHwgdXNlcklkUmVjZWl2ZWQgPT09IHVzZXJJZCB8fCAhKGhhbmRsZXJzID09IG51bGwgPyB2b2lkIDAgOiBoYW5kbGVycy5vbk1lc3NhZ2VTZWVuKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBwcm9jZXNzZWRFdmVudElkcy5hZGQoZXZlbnRJZCk7XG4gICAgICBsb2dnZXIuaW5mbyhgXFx1ezFGNEFDfSBbTWVzc2FnZVNlZW5dIE1lc3NhZ2UgbWFycXVcXHhFOSBjb21tZSBsdWAsIHByb3BzKTtcbiAgICAgIChfYSA9IGhhbmRsZXJzID09IG51bGwgPyB2b2lkIDAgOiBoYW5kbGVycy5vbk1lc3NhZ2VTZWVuKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY2FsbChoYW5kbGVycywgcHJvcHMpO1xuICAgIH0pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjaGFubmVsLnVuYmluZF9hbGwoKTtcbiAgICAgIHB1c2hlcjMudW5zdWJzY3JpYmUoY2hhbm5lbE5hbWUpO1xuICAgICAgYWN0aXZlQ2hhbm5lbHMuZGVsZXRlKGNoYW5uZWxOYW1lKTtcbiAgICAgIGxvZ2dlci5pbmZvKGBcXHV7MUY0QUN9IFtVbnN1YnNjcmliZV0gQ2FuYWwgJHtjaGFubmVsTmFtZX0gZFxceEU5c2FjdGl2XFx4RTlgKTtcbiAgICB9O1xuICB9O1xuICByZXR1cm4ge1xuICAgIHNldHVwQ29udmVyc2F0aW9uU3Vic2NyaWJlc1xuICB9O1xufTtcblxuLy8gc3JjL2NsaWVudC9wcm92aWRlcnMvTmV4dFB1c2hlckNoYXRQcm92aWRlci50c3hcbmltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBQdXNoZXIzIGZyb20gXCJwdXNoZXItanNcIjtcblxuLy8gc3JjL2NsaWVudC9zZXJ2aWNlcy9wdXNoZXIvc3Vic2NyaWJlLnRzXG52YXIgY3JlYXRlUHVzaGVyU3Vic2NyaWJlcyA9IChwdXNoZXIzLCBvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZSkgPT4ge1xuICBjb25zdCBzZXR1cENvbm5lY3Rpb25TdWJzY3JpYmVzID0gKCkgPT4ge1xuICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBwdXNoZXIzLmNvbm5lY3Rpb247XG4gICAgY29ubmVjdGlvbi5iaW5kKFwiY29ubmVjdGVkXCIsICgpID0+IHtcbiAgICAgIGxvZ2dlci5pbmZvKFwiXFx1MjcwNSBQdXNoZXIgY29ubmVjdFxceEU5IGF2ZWMgc3VjY1xceEU4cyFcIik7XG4gICAgICBvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZSh7XG4gICAgICAgIGlzQ29ubmVjdGVkOiB0cnVlLFxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgY29ubmVjdGlvblN0YXRlOiBcImNvbm5lY3RlZFwiXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25uZWN0aW9uLmJpbmQoXCJjb25uZWN0aW5nXCIsICgpID0+IHtcbiAgICAgIGxvZ2dlci5pbmZvKFwiXFx1ezFGNTA0fSBUZW50YXRpdmUgZGUgY29ubmV4aW9uIFxceEUwIFB1c2hlci4uLlwiKTtcbiAgICAgIG9uQ29ubmVjdGlvblN0YXRlQ2hhbmdlKHtcbiAgICAgICAgaXNMb2FkaW5nOiB0cnVlLFxuICAgICAgICBjb25uZWN0aW9uU3RhdGU6IFwiY29ubmVjdGluZ1wiXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25uZWN0aW9uLmJpbmQoXCJkaXNjb25uZWN0ZWRcIiwgKCkgPT4ge1xuICAgICAgbG9nZ2VyLmluZm8oXCJcXHUyNzRDIFB1c2hlciBkXFx4RTljb25uZWN0XFx4RTlcIik7XG4gICAgICBvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZSh7XG4gICAgICAgIGlzQ29ubmVjdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgY29ubmVjdGlvblN0YXRlOiBcImRpc2Nvbm5lY3RlZFwiXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25uZWN0aW9uLmJpbmQoXCJlcnJvclwiLCAoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiXFx1MjZBMFxcdUZFMEYgRXJyZXVyIGRlIGNvbm5leGlvbiBQdXNoZXI6XCIsIGVycik7XG4gICAgICBvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZSh7XG4gICAgICAgIGlzQ29ubmVjdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGVyci5tZXNzYWdlIHx8IFwiRXJyZXVyIGRlIGNvbm5leGlvblwiLFxuICAgICAgICBjb25uZWN0aW9uU3RhdGU6IFwiZXJyb3JcIlxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgY29ubmVjdGlvbi5iaW5kKFwic3RhdGVfY2hhbmdlXCIsIChzdGF0ZXMpID0+IHtcbiAgICAgIGxvZ2dlci5pbmZvKFwiXFx1ezFGNTA0fSBDaGFuZ2VtZW50IGQnXFx4RTl0YXQgUHVzaGVyOlwiLCBzdGF0ZXMpO1xuICAgIH0pO1xuICB9O1xuICByZXR1cm4ge1xuICAgIHNldHVwQ29ubmVjdGlvblN1YnNjcmliZXNcbiAgfTtcbn07XG5cbi8vIHNyYy9jbGllbnQvcHJvdmlkZXJzL05leHRQdXNoZXJDaGF0UHJvdmlkZXIudHN4XG5pbXBvcnQgeyB1c2VDb250ZXh0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBqc3ggfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBQdXNoZXJDb250ZXh0ID0gY3JlYXRlQ29udGV4dChudWxsKTtcbnZhciBOZXh0UHVzaGVyQ2hhdFByb3ZpZGVyID0gKHtcbiAgdXNlcklkLFxuICBvcHRpb25zLFxuICBjaGlsZHJlblxufSkgPT4ge1xuICBjb25zdCBbY29ubmVjdGlvblN0YXRlLCBzZXRDb25uZWN0aW9uU3RhdGVdID0gdXNlU3RhdGUoXG4gICAge1xuICAgICAgaXNDb25uZWN0ZWQ6IGZhbHNlLFxuICAgICAgaXNMb2FkaW5nOiB0cnVlLFxuICAgICAgZXJyb3I6IG51bGwsXG4gICAgICBjb25uZWN0aW9uU3RhdGU6IFwiaW5pdGlhbGl6aW5nXCJcbiAgICB9XG4gICk7XG4gIGNvbnN0IFtwdXNoZXIzLCBzZXRQdXNoZXJdID0gdXNlU3RhdGUobnVsbCk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbG9nZ2VyLmluZm8oXCJcXHV7MUY2ODB9IEluaXRpYWxpc2F0aW9uIGRlIFB1c2hlci4uLlwiKTtcbiAgICBzZXRDb25uZWN0aW9uU3RhdGUoKHByZXYpID0+IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIHByZXYpLCB7XG4gICAgICBpc0xvYWRpbmc6IHRydWUsXG4gICAgICBlcnJvcjogbnVsbCxcbiAgICAgIGNvbm5lY3Rpb25TdGF0ZTogXCJjb25uZWN0aW5nXCJcbiAgICB9KSk7XG4gICAgY29uc3QgcHVzaGVyQ2xpZW50ID0gbmV3IFB1c2hlcjMocHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfUFVTSEVSX0tFWSB8fCBcIlwiLCBfX3NwcmVhZFZhbHVlcyh7XG4gICAgICBjbHVzdGVyOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19QVVNIRVJfQ0xVU1RFUiB8fCBcImV1XCIsXG4gICAgICBhdXRoRW5kcG9pbnQ6IFwiL2FwaS9jaGF0XCIsXG4gICAgICBhdXRoOiB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBcIlgtVXNlci1JZFwiOiB1c2VySWRcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIG9wdGlvbnMpKTtcbiAgICBjb25zdCBldmVudHMgPSBjcmVhdGVQdXNoZXJTdWJzY3JpYmVzKHB1c2hlckNsaWVudCwgKG5ld1N0YXRlKSA9PiB7XG4gICAgICBzZXRDb25uZWN0aW9uU3RhdGUoKHByZXYpID0+IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCBwcmV2KSwgbmV3U3RhdGUpKTtcbiAgICB9KTtcbiAgICBldmVudHMuc2V0dXBDb25uZWN0aW9uU3Vic2NyaWJlcygpO1xuICAgIHNldFB1c2hlcihwdXNoZXJDbGllbnQpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBsb2dnZXIuaW5mbyhcIlxcdXsxRjQ0Qn0gRFxceEU5Y29ubmV4aW9uIGRlIFB1c2hlci4uLlwiKTtcbiAgICAgIHB1c2hlckNsaWVudC5kaXNjb25uZWN0KCk7XG4gICAgfTtcbiAgfSwgW3VzZXJJZCwgb3B0aW9uc10pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChQdXNoZXJDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBjb25uZWN0aW9uU3RhdGUpLCB7IHB1c2hlcjogcHVzaGVyMywgdXNlcklkIH0pLCBjaGlsZHJlbiB9KTtcbn07XG52YXIgdXNlTmV4dFB1c2hlckNoYXQgPSAoKSA9PiB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KFB1c2hlckNvbnRleHQpO1xuICBpZiAoIWNvbnRleHQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBcInVzZU5leHRQdXNoZXJDaGF0IGRvaXQgXFx4RUF0cmUgdXRpbGlzXFx4RTkgXFx4RTAgbCdpbnRcXHhFOXJpZXVyIGQndW4gTmV4dFB1c2hlckNoYXRQcm92aWRlclwiXG4gICAgKTtcbiAgfVxuICByZXR1cm4gY29udGV4dDtcbn07XG5cbi8vIHNyYy9jbGllbnQvaG9va3MvdXNlQ2hhdFN1YnNjcmliZS50c1xudmFyIHB1c2hlclN1YnNjcmlwdGlvbnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xudmFyIGdldE9yQ3JlYXRlU3Vic2NyaXB0aW9uID0gKGNvbnZlcnNhdGlvbklkLCBwdXNoZXIzLCB1c2VySWQpID0+IHtcbiAgaWYgKCFwdXNoZXJTdWJzY3JpcHRpb25zLmhhcyhjb252ZXJzYXRpb25JZCkpIHtcbiAgICBjb25zdCBldmVudHMgPSBjcmVhdGVDaGF0U3Vic2NyaWJlcyhwdXNoZXIzLCB1c2VySWQsIHtcbiAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgb25NZXNzYWdlUmVjZWl2ZWQ6IChtZXNzYWdlKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHB1c2hlclN1YnNjcmlwdGlvbnMuZ2V0KGNvbnZlcnNhdGlvbklkKTtcbiAgICAgICAgaWYgKHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbi5jYWxsYmFja3MuZm9yRWFjaCgoY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIChfYSA9IGNhbGxiYWNrLm9uTWVzc2FnZVJlY2VpdmVkKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY2FsbChjYWxsYmFjaywgbWVzc2FnZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbk1lc3NhZ2VTZWVuOiAobWVzc2FnZVNlZW4pID0+IHtcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gcHVzaGVyU3Vic2NyaXB0aW9ucy5nZXQoY29udmVyc2F0aW9uSWQpO1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgc3Vic2NyaXB0aW9uLmNhbGxiYWNrcy5mb3JFYWNoKChjYWxsYmFjaykgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgKF9hID0gY2FsbGJhY2sub25NZXNzYWdlU2VlbikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwoY2FsbGJhY2ssIG1lc3NhZ2VTZWVuKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uVHlwaW5nU3RhdHVzOiAodHlwaW5nU3RhdHVzKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHB1c2hlclN1YnNjcmlwdGlvbnMuZ2V0KGNvbnZlcnNhdGlvbklkKTtcbiAgICAgICAgaWYgKHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbi5jYWxsYmFja3MuZm9yRWFjaCgoY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIChfYSA9IGNhbGxiYWNrLm9uVHlwaW5nU3RhdHVzKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY2FsbChjYWxsYmFjaywgdHlwaW5nU3RhdHVzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uRXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBwdXNoZXJTdWJzY3JpcHRpb25zLmdldChjb252ZXJzYXRpb25JZCk7XG4gICAgICAgIGlmIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICBzdWJzY3JpcHRpb24uY2FsbGJhY2tzLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAoX2EgPSBjYWxsYmFjay5vbkVycm9yKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY2FsbChjYWxsYmFjaywgZXJyb3IpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgdW5zdWJzY3JpYmUgPSBldmVudHMuc2V0dXBDb252ZXJzYXRpb25TdWJzY3JpYmVzKGNvbnZlcnNhdGlvbklkKTtcbiAgICBwdXNoZXJTdWJzY3JpcHRpb25zLnNldChjb252ZXJzYXRpb25JZCwge1xuICAgICAgdW5zdWJzY3JpYmUsXG4gICAgICBjYWxsYmFja3M6IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KClcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcHVzaGVyU3Vic2NyaXB0aW9ucy5nZXQoY29udmVyc2F0aW9uSWQpO1xufTtcbnZhciB1c2VDaGF0U3Vic2NyaWJlID0gKHtcbiAgY29udmVyc2F0aW9uSWQsXG4gIG9uTWVzc2FnZVJlY2VpdmVkLFxuICBvbk1lc3NhZ2VTZWVuLFxuICBvblR5cGluZ1N0YXR1cyxcbiAgb25FcnJvclxufSkgPT4ge1xuICBjb25zdCB7IHB1c2hlcjogcHVzaGVyMywgaXNDb25uZWN0ZWQsIHVzZXJJZCB9ID0gdXNlTmV4dFB1c2hlckNoYXQoKTtcbiAgY29uc3QgY2FsbGJhY2tzUmVmID0gdXNlUmVmKHtcbiAgICBjb252ZXJzYXRpb25JZCxcbiAgICBvbk1lc3NhZ2VSZWNlaXZlZCxcbiAgICBvbk1lc3NhZ2VTZWVuLFxuICAgIG9uVHlwaW5nU3RhdHVzLFxuICAgIG9uRXJyb3JcbiAgfSk7XG4gIHVzZUVmZmVjdDIoKCkgPT4ge1xuICAgIGNhbGxiYWNrc1JlZi5jdXJyZW50ID0ge1xuICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICBvbk1lc3NhZ2VSZWNlaXZlZCxcbiAgICAgIG9uTWVzc2FnZVNlZW4sXG4gICAgICBvblR5cGluZ1N0YXR1cyxcbiAgICAgIG9uRXJyb3JcbiAgICB9O1xuICB9LCBbY29udmVyc2F0aW9uSWQsIG9uTWVzc2FnZVJlY2VpdmVkLCBvbk1lc3NhZ2VTZWVuLCBvblR5cGluZ1N0YXR1cywgb25FcnJvcl0pO1xuICB1c2VFZmZlY3QyKCgpID0+IHtcbiAgICBpZiAoIWlzQ29ubmVjdGVkIHx8ICFwdXNoZXIzKSByZXR1cm47XG4gICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gZ2V0T3JDcmVhdGVTdWJzY3JpcHRpb24oY29udmVyc2F0aW9uSWQsIHB1c2hlcjMsIHVzZXJJZCk7XG4gICAgc3Vic2NyaXB0aW9uLmNhbGxiYWNrcy5hZGQoY2FsbGJhY2tzUmVmLmN1cnJlbnQpO1xuICAgIGxvZ2dlci5pbmZvKGBcXHV7MUY1MDR9IFtDaGF0U3Vic2NyaWJlXSBBam91dCBkZXMgY2FsbGJhY2tzIHBvdXIgbGEgY29udmVyc2F0aW9uICR7Y29udmVyc2F0aW9uSWR9YCk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbjIgPSBwdXNoZXJTdWJzY3JpcHRpb25zLmdldChjb252ZXJzYXRpb25JZCk7XG4gICAgICBpZiAoc3Vic2NyaXB0aW9uMikge1xuICAgICAgICBzdWJzY3JpcHRpb24yLmNhbGxiYWNrcy5kZWxldGUoY2FsbGJhY2tzUmVmLmN1cnJlbnQpO1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9uMi5jYWxsYmFja3Muc2l6ZSA9PT0gMCkge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbjIudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICBwdXNoZXJTdWJzY3JpcHRpb25zLmRlbGV0ZShjb252ZXJzYXRpb25JZCk7XG4gICAgICAgICAgbG9nZ2VyLmluZm8oYFxcdXsxRjUwNH0gW0NoYXRTdWJzY3JpYmVdIERcXHhFOXNhYm9ubmVtZW50IFB1c2hlciBwb3VyIGxhIGNvbnZlcnNhdGlvbiAke2NvbnZlcnNhdGlvbklkfWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsb2dnZXIuaW5mbyhgXFx1ezFGNTA0fSBbQ2hhdFN1YnNjcmliZV0gU3VwcHJlc3Npb24gZGVzIGNhbGxiYWNrcyBwb3VyIGxhIGNvbnZlcnNhdGlvbiAke2NvbnZlcnNhdGlvbklkfWApO1xuICAgIH07XG4gIH0sIFtpc0Nvbm5lY3RlZCwgY29udmVyc2F0aW9uSWQsIHB1c2hlcjMsIHVzZXJJZF0pO1xuICByZXR1cm4ge1xuICAgIGlzQ29ubmVjdGVkXG4gIH07XG59O1xuXG4vLyBzcmMvY2xpZW50L2hvb2tzL3VzZUNoYXQudHNcbmltcG9ydCB7IHVzZUVmZmVjdCBhcyB1c2VFZmZlY3QzLCB1c2VSZWYgYXMgdXNlUmVmMiB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0MiB9IGZyb20gXCJ1dWlkXCI7XG52YXIgdXNlQ2hhdCA9ICh7IG9uTWVzc2FnZVJlY2VpdmVkLCBvblR5cGluZ1N0YXR1cywgb25FcnJvciwgY29udmVyc2F0aW9uSWQsIHBhcnRpY2lwYW50cywgb25NZXNzYWdlU2VlbiB9KSA9PiB7XG4gIGNvbnN0IHsgcHVzaGVyOiBwdXNoZXIzLCBpc0Nvbm5lY3RlZCwgaXNMb2FkaW5nLCBlcnJvciwgY29ubmVjdGlvblN0YXRlLCB1c2VySWQgfSA9IHVzZU5leHRQdXNoZXJDaGF0KCk7XG4gIGNvbnN0IGNhbGxiYWNrc1JlZiA9IHVzZVJlZjIoe1xuICAgIGNvbnZlcnNhdGlvbklkLFxuICAgIHBhcnRpY2lwYW50cyxcbiAgICBvbk1lc3NhZ2VSZWNlaXZlZCxcbiAgICBvbk1lc3NhZ2VTZWVuLFxuICAgIG9uVHlwaW5nU3RhdHVzLFxuICAgIG9uRXJyb3JcbiAgfSk7XG4gIHVzZUVmZmVjdDMoKCkgPT4ge1xuICAgIGNhbGxiYWNrc1JlZi5jdXJyZW50ID0ge1xuICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICBwYXJ0aWNpcGFudHMsXG4gICAgICBvbk1lc3NhZ2VSZWNlaXZlZCxcbiAgICAgIG9uTWVzc2FnZVNlZW4sXG4gICAgICBvblR5cGluZ1N0YXR1cyxcbiAgICAgIG9uRXJyb3JcbiAgICB9O1xuICB9LCBbY29udmVyc2F0aW9uSWQsIHBhcnRpY2lwYW50cywgb25NZXNzYWdlUmVjZWl2ZWQsIG9uTWVzc2FnZVNlZW4sIG9uVHlwaW5nU3RhdHVzLCBvbkVycm9yXSk7XG4gIHVzZUVmZmVjdDMoKCkgPT4ge1xuICAgIGlmICghaXNDb25uZWN0ZWQgfHwgIXB1c2hlcjMpIHJldHVybjtcbiAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBnZXRPckNyZWF0ZVN1YnNjcmlwdGlvbihjb252ZXJzYXRpb25JZCwgcHVzaGVyMywgdXNlcklkKTtcbiAgICBzdWJzY3JpcHRpb24uY2FsbGJhY2tzLmFkZChjYWxsYmFja3NSZWYuY3VycmVudCk7XG4gICAgbG9nZ2VyLmluZm8oYFxcdXsxRjUwNH0gW0NoYXRdIEFqb3V0IGRlcyBjYWxsYmFja3MgcG91ciBsYSBjb252ZXJzYXRpb24gJHtjb252ZXJzYXRpb25JZH1gKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uMiA9IHB1c2hlclN1YnNjcmlwdGlvbnMuZ2V0KGNvbnZlcnNhdGlvbklkKTtcbiAgICAgIGlmIChzdWJzY3JpcHRpb24yKSB7XG4gICAgICAgIHN1YnNjcmlwdGlvbjIuY2FsbGJhY2tzLmRlbGV0ZShjYWxsYmFja3NSZWYuY3VycmVudCk7XG4gICAgICAgIGlmIChzdWJzY3JpcHRpb24yLmNhbGxiYWNrcy5zaXplID09PSAwKSB7XG4gICAgICAgICAgc3Vic2NyaXB0aW9uMi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgIHB1c2hlclN1YnNjcmlwdGlvbnMuZGVsZXRlKGNvbnZlcnNhdGlvbklkKTtcbiAgICAgICAgICBsb2dnZXIuaW5mbyhgXFx1ezFGNTA0fSBbQ2hhdF0gRFxceEU5c2Fib25uZW1lbnQgUHVzaGVyIHBvdXIgbGEgY29udmVyc2F0aW9uICR7Y29udmVyc2F0aW9uSWR9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGxvZ2dlci5pbmZvKGBcXHV7MUY1MDR9IFtDaGF0XSBTdXBwcmVzc2lvbiBkZXMgY2FsbGJhY2tzIHBvdXIgbGEgY29udmVyc2F0aW9uICR7Y29udmVyc2F0aW9uSWR9YCk7XG4gICAgfTtcbiAgfSwgW2lzQ29ubmVjdGVkLCBjb252ZXJzYXRpb25JZCwgcHVzaGVyMywgdXNlcklkXSk7XG4gIGNvbnN0IHNlbmRNZXNzYWdlID0gKG1lc3NhZ2UpID0+IHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuIGV2ZW50U2VuZE1lc3NhZ2VFdmVudChjb252ZXJzYXRpb25JZCwge1xuICAgICAgdXNlcklkLFxuICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50LFxuICAgICAgYXR0YWNobWVudHNDb3VudDogKChfYSA9IG1lc3NhZ2UuYXR0YWNobWVudHMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5sZW5ndGgpIHx8IDAsXG4gICAgICBpZDogbWVzc2FnZS5pZFxuICAgIH0pO1xuICB9O1xuICBjb25zdCBwcmVwYXJlTWVzc2FnZSA9ICh7IGNvbnRlbnQsIGF0dGFjaG1lbnRzIH0pID0+IHtcbiAgICBjb25zdCBldmVudElkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGV2ZW50SWQsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgY29udGVudCxcbiAgICAgICAgYXR0YWNobWVudHNDb3VudDogKGF0dGFjaG1lbnRzID09IG51bGwgPyB2b2lkIDAgOiBhdHRhY2htZW50cy5sZW5ndGgpIHx8IDAsXG4gICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuICBjb25zdCB1cGRhdGVUeXBpbmdTdGF0dXMgPSAoaXNUeXBpbmcpID0+IHtcbiAgICByZXR1cm4gZXZlbnRUeXBpbmdFdmVudChjb252ZXJzYXRpb25JZCwge1xuICAgICAgdXNlcklkLFxuICAgICAgaXNUeXBpbmdcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgZ2V0UGFydGljaXBhbnQgPSAoaWQpID0+IHtcbiAgICByZXR1cm4gcGFydGljaXBhbnRzLmZpbmQoKHBhcnRpY2lwYW50KSA9PiBwYXJ0aWNpcGFudC5pZCA9PT0gaWQpIHx8IHtcbiAgICAgIGlkOiBcInVua25vd25cIixcbiAgICAgIG5hbWU6IFwiVW5rbm93blwiXG4gICAgfTtcbiAgfTtcbiAgY29uc3QgZ2VuZXJhdGVVVUlEID0gKCkgPT4ge1xuICAgIHJldHVybiB1dWlkdjQyKCk7XG4gIH07XG4gIGNvbnN0IG1hcmtNZXNzYWdlQXNTZWVuID0gKG1lc3NhZ2VJZCkgPT4ge1xuICAgIHJldHVybiBldmVudE1lc3NhZ2VTZWVuRXZlbnQoY29udmVyc2F0aW9uSWQsIHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHNlZW5BdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICB9KTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBzZW5kTWVzc2FnZSxcbiAgICBwcmVwYXJlTWVzc2FnZSxcbiAgICB1cGRhdGVUeXBpbmdTdGF0dXMsXG4gICAgZ2V0UGFydGljaXBhbnQsXG4gICAgbWFya01lc3NhZ2VBc1NlZW4sXG4gICAgY29ubmVjdGlvbjoge1xuICAgICAgaXNDb25uZWN0ZWQsXG4gICAgICBpc0xvYWRpbmcsXG4gICAgICBlcnJvcixcbiAgICAgIGNvbm5lY3Rpb25TdGF0ZVxuICAgIH1cbiAgfTtcbn07XG5cbi8vIHNyYy9jbGllbnQvY29udGV4dHMvQ2hhdENvbnRleHQudHN4XG5pbXBvcnQgUmVhY3QyLCB7XG4gIGNyZWF0ZUNvbnRleHQgYXMgY3JlYXRlQ29udGV4dDIsXG4gIHVzZUNhbGxiYWNrIGFzIHVzZUNhbGxiYWNrMyxcbiAgdXNlQ29udGV4dCBhcyB1c2VDb250ZXh0MixcbiAgdXNlRWZmZWN0IGFzIHVzZUVmZmVjdDQsXG4gIHVzZU1lbW8sXG4gIHVzZVJlZiBhcyB1c2VSZWYzXG59IGZyb20gXCJyZWFjdFwiO1xuXG4vLyBzcmMvY2xpZW50L2NvbnN0YW50cy9jb25zdGFudHMudHNcbnZhciBERUZBVUxUX0NIQVRfQ09ORklHID0ge1xuICBhY3RpdmVFbW9qaTogdHJ1ZSxcbiAgYWN0aXZlRmlsZTogdHJ1ZSxcbiAgYWN0aXZlVm9pY2U6IHRydWUsXG4gIGFjdGl2ZVVzZXJDb2xvcjogdHJ1ZSxcbiAgd2VsY29tZU1lc3NhZ2U6IFwiQmllbnZlbnVlIGRhbnMgbGEgY29udmVyc2F0aW9uXCIsXG4gIHR5cGluZ1RpbWVvdXQ6IDFlNCxcbiAgbnVtYmVyT2ZNZXNzYWdlc1RvTG9hZDogMzBcbn07XG5cbi8vIHNyYy9jbGllbnQvY29udGV4dHMvQ2hhdENvbnRleHQudHN4XG5pbXBvcnQgXyBmcm9tIFwibG9kYXNoXCI7XG5cbi8vIHNyYy9jbGllbnQvdXRpbHMvY29uZmlnLnRzXG52YXIgbWVyZ2VDb25maWdXaXRoRGVmYXVsdHMgPSAoY29uZmlnKSA9PiB7XG4gIHJldHVybiBfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgREVGQVVMVF9DSEFUX0NPTkZJRyksIGNvbmZpZyk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbnRleHRzL0NoYXRDb250ZXh0LnRzeFxuaW1wb3J0IHsganN4IGFzIGpzeDIgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBDaGF0Q29udGV4dCA9IGNyZWF0ZUNvbnRleHQyKHZvaWQgMCk7XG52YXIgdXNlQ2hhdENvbnRleHQgPSAoKSA9PiB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0MihDaGF0Q29udGV4dCk7XG4gIGlmICghY29udGV4dCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcInVzZUNoYXRDb250ZXh0IG11c3QgYmUgdXNlZCB3aXRoaW4gYSBDaGF0UHJvdmlkZXJcIik7XG4gIH1cbiAgcmV0dXJuIGNvbnRleHQ7XG59O1xudmFyIENoYXRQcm92aWRlciA9ICh7XG4gIGNvbnZlcnNhdGlvbklkLFxuICBkZWZhdWx0TWVzc2FnZXMsXG4gIHBhcnRpY2lwYW50cyxcbiAgY29uZmlnLFxuICBpc0xvYWRpbmcsXG4gIHRvdGFsTWVzc2FnZXMsXG4gIG9uUmVjZWl2ZU1lc3NhZ2UsXG4gIG9uU2VuZE1lc3NhZ2UsXG4gIG9uTWVzc2FnZVNlZW4sXG4gIG9uTG9hZE1vcmVNZXNzYWdlcyxcbiAgY2hpbGRyZW5cbn0pID0+IHtcbiAgY29uc3QgbWVyZ2VkQ29uZmlnID0gdXNlTWVtbyhcbiAgICAoKSA9PiBtZXJnZUNvbmZpZ1dpdGhEZWZhdWx0cyhjb25maWcgfHwgREVGQVVMVF9DSEFUX0NPTkZJRyksXG4gICAgW2NvbmZpZ11cbiAgKTtcbiAgY29uc3QgW21lc3NhZ2VzLCBzZXRNZXNzYWdlc10gPSBSZWFjdDIudXNlU3RhdGUoW10pO1xuICBjb25zdCBbbG9hZGluZ1NlbmRNZXNzYWdlLCBzZXRMb2FkaW5nU2VuZE1lc3NhZ2VdID0gUmVhY3QyLnVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2xvYWRpbmdNb3JlLCBzZXRMb2FkaW5nTW9yZV0gPSBSZWFjdDIudXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaGFzTW9yZSwgc2V0SGFzTW9yZV0gPSBSZWFjdDIudXNlU3RhdGUodHJ1ZSk7XG4gIGNvbnN0IFt0eXBpbmdVc2Vycywgc2V0VHlwaW5nVXNlcnNdID0gUmVhY3QyLnVzZVN0YXRlKFtdKTtcbiAgY29uc3QgW2lzQXRCb3R0b20sIHNldElzQXRCb3R0b21dID0gUmVhY3QyLnVzZVN0YXRlKHRydWUpO1xuICBjb25zdCB7IHVzZXJJZCB9ID0gdXNlTmV4dFB1c2hlckNoYXQoKTtcbiAgY29uc3QgY29udGVudFJlZiA9IFJlYWN0Mi51c2VSZWYobnVsbCk7XG4gIGNvbnN0IFtzaG91bGRTY3JvbGxUb0JvdHRvbSwgc2V0U2hvdWxkU2Nyb2xsVG9Cb3R0b21dID0gUmVhY3QyLnVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgU0NST0xMX1RIUkVTSE9MRCA9IDEwO1xuICBjb25zdCBzY3JvbGxUaW1lb3V0UmVmID0gUmVhY3QyLnVzZVJlZigpO1xuICBjb25zdCBsYXN0TWVzc2FnZVNlZW5SZWYgPSB1c2VSZWYzKG51bGwpO1xuICBjb25zdCBpc1Byb2Nlc3NpbmdSZWYgPSB1c2VSZWYzKGZhbHNlKTtcbiAgY29uc3Qgc2Nyb2xsVG9Cb3R0b20gPSBSZWFjdDIudXNlQ2FsbGJhY2soXG4gICAgKGJlaGF2aW9yID0gXCJzbW9vdGhcIikgPT4ge1xuICAgICAgaWYgKGNvbnRlbnRSZWYuY3VycmVudCkge1xuICAgICAgICBjb25zdCBpbWFnZXMgPSBjb250ZW50UmVmLmN1cnJlbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbWdcIik7XG4gICAgICAgIGNvbnN0IGltYWdlTG9hZFByb21pc2VzID0gQXJyYXkuZnJvbShpbWFnZXMpLm1hcCgoaW1nKSA9PiB7XG4gICAgICAgICAgaWYgKGltZy5jb21wbGV0ZSkgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgaW1nLm9ubG9hZCA9IHJlc29sdmU7XG4gICAgICAgICAgICBpbWcub25lcnJvciA9IHJlc29sdmU7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBQcm9taXNlLmFsbChpbWFnZUxvYWRQcm9taXNlcykudGhlbigoKSA9PiB7XG4gICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgIChfYSA9IGNvbnRlbnRSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnNjcm9sbFRvKHtcbiAgICAgICAgICAgIHRvcDogY29udGVudFJlZi5jdXJyZW50LnNjcm9sbEhlaWdodCxcbiAgICAgICAgICAgIGJlaGF2aW9yXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgW11cbiAgKTtcbiAgY29uc3QgaGFuZGxlU2Nyb2xsID0gUmVhY3QyLnVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoIWNvbnRlbnRSZWYuY3VycmVudCkgcmV0dXJuO1xuICAgIGlmIChzY3JvbGxUaW1lb3V0UmVmLmN1cnJlbnQpIHtcbiAgICAgIGNsZWFyVGltZW91dChzY3JvbGxUaW1lb3V0UmVmLmN1cnJlbnQpO1xuICAgIH1cbiAgICBzY3JvbGxUaW1lb3V0UmVmLmN1cnJlbnQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNvbnN0IHsgc2Nyb2xsVG9wLCBzY3JvbGxIZWlnaHQsIGNsaWVudEhlaWdodCB9ID0gY29udGVudFJlZi5jdXJyZW50O1xuICAgICAgY29uc3QgaXNCb3R0b20gPSBNYXRoLmFicyhzY3JvbGxIZWlnaHQgLSBzY3JvbGxUb3AgLSBjbGllbnRIZWlnaHQpIDwgU0NST0xMX1RIUkVTSE9MRDtcbiAgICAgIHNldElzQXRCb3R0b20oaXNCb3R0b20pO1xuICAgIH0sIDEwMCk7XG4gIH0sIFtdKTtcbiAgUmVhY3QyLnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgY29udGVudCA9IGNvbnRlbnRSZWYuY3VycmVudDtcbiAgICBpZiAoY29udGVudCkge1xuICAgICAgY29udGVudC5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGhhbmRsZVNjcm9sbCk7XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBjb250ZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgaGFuZGxlU2Nyb2xsKTtcbiAgICAgICAgaWYgKHNjcm9sbFRpbWVvdXRSZWYuY3VycmVudCkge1xuICAgICAgICAgIGNsZWFyVGltZW91dChzY3JvbGxUaW1lb3V0UmVmLmN1cnJlbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSwgW2hhbmRsZVNjcm9sbF0pO1xuICBSZWFjdDIudXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoc2hvdWxkU2Nyb2xsVG9Cb3R0b20pIHtcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgIHNjcm9sbFRvQm90dG9tKCk7XG4gICAgICB9KTtcbiAgICAgIHNldFNob3VsZFNjcm9sbFRvQm90dG9tKGZhbHNlKTtcbiAgICB9XG4gIH0sIFtzaG91bGRTY3JvbGxUb0JvdHRvbSwgc2Nyb2xsVG9Cb3R0b21dKTtcbiAgdXNlRWZmZWN0NCgoKSA9PiB7XG4gICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCAmJiBkZWZhdWx0TWVzc2FnZXMpIHtcbiAgICAgIHNldE1lc3NhZ2VzKGRlZmF1bHRNZXNzYWdlcyk7XG4gICAgfVxuICB9LCBbZGVmYXVsdE1lc3NhZ2VzXSk7XG4gIHVzZUVmZmVjdDQoKCkgPT4ge1xuICAgIGxvZ2dlci5pbmZvKFwiW0NoYXRDb250ZXh0XSBMaXN0ZSBkZXMgbWVzc2FnZXNcIiwge1xuICAgICAgbWVzc2FnZXNcbiAgICB9KTtcbiAgfSwgW21lc3NhZ2VzXSk7XG4gIGNvbnN0IHtcbiAgICBwcmVwYXJlTWVzc2FnZSxcbiAgICBzZW5kTWVzc2FnZTogc2VuZFB1c2hlck1lc3NhZ2UsXG4gICAgdXBkYXRlVHlwaW5nU3RhdHVzOiB1cGRhdGVQdXNoZXJUeXBpbmdTdGF0dXMsXG4gICAgZ2V0UGFydGljaXBhbnQsXG4gICAgbWFya01lc3NhZ2VBc1NlZW5cbiAgfSA9IHVzZUNoYXQoe1xuICAgIGNvbnZlcnNhdGlvbklkLFxuICAgIHBhcnRpY2lwYW50cyxcbiAgICBvblR5cGluZ1N0YXR1czogKHsgaXNUeXBpbmcsIHVzZXJJZDogdXNlcklkMiB9KSA9PiB7XG4gICAgICBzZXRUeXBpbmdVc2VycyhcbiAgICAgICAgKHByZXYpID0+IGlzVHlwaW5nID8gWy4uLnByZXYsIHVzZXJJZDJdIDogcHJldi5maWx0ZXIoKGlkKSA9PiBpZCAhPT0gdXNlcklkMilcbiAgICAgICk7XG4gICAgfSxcbiAgICBvbk1lc3NhZ2VSZWNlaXZlZDogKHByb3BzKSA9PiB7XG4gICAgICBjb25zdCB7IHVzZXJJZDogdXNlcklkUmVjZWl2ZWQsIGV2ZW50SWQgfSA9IHByb3BzO1xuICAgICAgaWYgKHVzZXJJZFJlY2VpdmVkICE9PSB1c2VySWQpIHtcbiAgICAgICAgb25SZWNlaXZlTWVzc2FnZSA9PSBudWxsID8gdm9pZCAwIDogb25SZWNlaXZlTWVzc2FnZShldmVudElkLCBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBwcm9wcyksIHtcbiAgICAgICAgICB1c2VyOiBnZXRQYXJ0aWNpcGFudCh1c2VySWRSZWNlaXZlZCksXG4gICAgICAgICAgaWQ6IGV2ZW50SWRcbiAgICAgICAgfSkpLnRoZW4oKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICBzZXRNZXNzYWdlcygocHJldikgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3TWVzc2FnZXMgPSBbLi4ucHJldiwgbWVzc2FnZV07XG4gICAgICAgICAgICBpZiAoaXNBdEJvdHRvbSkge1xuICAgICAgICAgICAgICBzZXRTaG91bGRTY3JvbGxUb0JvdHRvbSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXdNZXNzYWdlcy5zbGljZShcbiAgICAgICAgICAgICAgLSgobWVyZ2VkQ29uZmlnID09IG51bGwgPyB2b2lkIDAgOiBtZXJnZWRDb25maWcubnVtYmVyT2ZNZXNzYWdlc1RvTG9hZCkgfHwgMzApXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIG9uTWVzc2FnZVNlZW46IChtZXNzYWdlU2VlbikgPT4ge1xuICAgICAgY29uc3QgeyB1c2VySWQ6IHNlZW5CeVVzZXJJZCB9ID0gbWVzc2FnZVNlZW47XG4gICAgICBjb25zdCBzZWVuQXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICAgIHNldE1lc3NhZ2VzKFxuICAgICAgICAocHJldk1lc3NhZ2VzKSA9PiBwcmV2TWVzc2FnZXMubWFwKChtZXNzYWdlKSA9PiB7XG4gICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgIGlmICgoX2EgPSBtZXNzYWdlLnNlZW5CeSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnNvbWUoKHNlZW4pID0+IHNlZW4udXNlcklkID09PSBzZWVuQnlVc2VySWQpKSB7XG4gICAgICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIG1lc3NhZ2UpLCB7XG4gICAgICAgICAgICBzZWVuQnk6IFtcbiAgICAgICAgICAgICAgLi4ubWVzc2FnZS5zZWVuQnkgfHwgW10sXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHNlZW5CeVVzZXJJZCxcbiAgICAgICAgICAgICAgICBzZWVuQXRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBzZW5kTWVzc2FnZSA9IHVzZUNhbGxiYWNrMyhcbiAgICBhc3luYyAocHJvcHMpID0+IHtcbiAgICAgIGNvbnN0IHsgY29udGVudCwgYXR0YWNobWVudHMsIGNyZWF0ZWRBdCB9ID0gcHJvcHM7XG4gICAgICBpZiAoIWNvbnRlbnQudHJpbSgpICYmICEoYXR0YWNobWVudHMgPT0gbnVsbCA/IHZvaWQgMCA6IGF0dGFjaG1lbnRzLmxlbmd0aCkpIHJldHVybjtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNldExvYWRpbmdTZW5kTWVzc2FnZSh0cnVlKTtcbiAgICAgICAgY29uc3QgeyBkYXRhLCBldmVudElkIH0gPSBwcmVwYXJlTWVzc2FnZShwcm9wcyk7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRNZXNzYWdlID0gYXdhaXQgb25TZW5kTWVzc2FnZSh7XG4gICAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgZXZlbnRJZCxcbiAgICAgICAgICBtZXNzYWdlOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHtcbiAgICAgICAgICAgIGlkOiBldmVudElkXG4gICAgICAgICAgfSwgZGF0YSksIHByb3BzKSwge1xuICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgY3JlYXRlZEF0XG4gICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHNlbmRQdXNoZXJNZXNzYWdlKF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIGRhdGEpLCBwcm9wcyksIHtcbiAgICAgICAgICBpZDogZXZlbnRJZCxcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgY3JlYXRlZEF0XG4gICAgICAgIH0pKTtcbiAgICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IHtcbiAgICAgICAgICBjb25zdCBuZXdNZXNzYWdlcyA9IFsuLi5wcmV2LCB1cGRhdGVkTWVzc2FnZV07XG4gICAgICAgICAgc2V0U2hvdWxkU2Nyb2xsVG9Cb3R0b20odHJ1ZSk7XG4gICAgICAgICAgcmV0dXJuIG5ld01lc3NhZ2VzLnNsaWNlKFxuICAgICAgICAgICAgLSgobWVyZ2VkQ29uZmlnID09IG51bGwgPyB2b2lkIDAgOiBtZXJnZWRDb25maWcubnVtYmVyT2ZNZXNzYWdlc1RvTG9hZCkgfHwgMzApXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGxvcnMgZGUgbCdlbnZvaSBkdSBtZXNzYWdlOlwiLCBlcnJvcik7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBzZXRMb2FkaW5nU2VuZE1lc3NhZ2UoZmFsc2UpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW1xuICAgICAgcHJlcGFyZU1lc3NhZ2UsXG4gICAgICBzZW5kUHVzaGVyTWVzc2FnZSxcbiAgICAgIG9uU2VuZE1lc3NhZ2UsXG4gICAgICB1c2VySWQsXG4gICAgICBtZXJnZWRDb25maWcgPT0gbnVsbCA/IHZvaWQgMCA6IG1lcmdlZENvbmZpZy5udW1iZXJPZk1lc3NhZ2VzVG9Mb2FkXG4gICAgXVxuICApO1xuICBjb25zdCBsb2FkTW9yZU1lc3NhZ2VzID0gdXNlQ2FsbGJhY2szKGFzeW5jICgpID0+IHtcbiAgICBpZiAoIW9uTG9hZE1vcmVNZXNzYWdlcyB8fCBsb2FkaW5nTW9yZSB8fCAhaGFzTW9yZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBvbGRlc3RNZXNzYWdlID0gbWVzc2FnZXNbMF07XG4gICAgaWYgKCFvbGRlc3RNZXNzYWdlKSB7XG4gICAgICBzZXRIYXNNb3JlKGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIHNldExvYWRpbmdNb3JlKHRydWUpO1xuICAgICAgY29uc3Qgb2xkZXJNZXNzYWdlcyA9IGF3YWl0IG9uTG9hZE1vcmVNZXNzYWdlcyh7XG4gICAgICAgIG9sZGVzdE1lc3NhZ2VJZDogb2xkZXN0TWVzc2FnZS5pZCxcbiAgICAgICAgcHJldmlvdXNNZXNzYWdlczogbWVzc2FnZXNcbiAgICAgIH0pO1xuICAgICAgbG9nZ2VyLmluZm8oXCJbQ2hhdENvbnRleHRdIE9uIHJlY3VwXFx4RThyZSBsZXMgbWVzc2FnZXMgcGx1cyBhbmNpZW5zXCIsIHtcbiAgICAgICAgb2xkZXJNZXNzYWdlc1xuICAgICAgfSk7XG4gICAgICBpZiAoIW9sZGVyTWVzc2FnZXMgfHwgb2xkZXJNZXNzYWdlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2V0SGFzTW9yZShmYWxzZSk7XG4gICAgICAgIGxvZ2dlci5pbmZvKFwiW0NoYXRDb250ZXh0XSBPbiBuJ2EgcGx1cyBkZSBtZXNzYWdlc1wiLCB7XG4gICAgICAgICAgb2xkZXJNZXNzYWdlc1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbG9nZ2VyLmluZm8oXCJbQ2hhdENvbnRleHRdIE9uIGEgZGVzIG1lc3NhZ2VzIHBsdXMgYW5jaWVuc1wiLCB7XG4gICAgICAgIG9sZGVyTWVzc2FnZXMsXG4gICAgICAgIG1lc3NhZ2VzXG4gICAgICB9KTtcbiAgICAgIHNldE1lc3NhZ2VzKChwcmV2TWVzc2FnZXMpID0+IF8uY29uY2F0KG9sZGVyTWVzc2FnZXMsIHByZXZNZXNzYWdlcykpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICBcIkVycmV1ciBsb3JzIGR1IGNoYXJnZW1lbnQgZGVzIG1lc3NhZ2VzIHBsdXMgYW5jaWVuczpcIixcbiAgICAgICAgZXJyb3JcbiAgICAgICk7XG4gICAgICBzZXRIYXNNb3JlKGZhbHNlKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZ01vcmUoZmFsc2UpO1xuICAgIH1cbiAgfSwgW29uTG9hZE1vcmVNZXNzYWdlcywgbG9hZGluZ01vcmUsIGhhc01vcmUsIG1lc3NhZ2VzXSk7XG4gIGNvbnN0IG1hcmtMYXN0TWVzc2FnZUFzU2VlbiA9IHVzZUNhbGxiYWNrMyhcbiAgICAobWVzc2FnZSkgPT4ge1xuICAgICAgaWYgKGlzUHJvY2Vzc2luZ1JlZi5jdXJyZW50IHx8IGxhc3RNZXNzYWdlU2VlblJlZi5jdXJyZW50ID09PSBtZXNzYWdlLmlkIHx8IG1lc3NhZ2UudXNlcklkID09PSB1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKCFfLmZpbmQobWVzc2FnZS5zZWVuQnksIHsgdXNlcklkIH0pKSB7XG4gICAgICAgIGlzUHJvY2Vzc2luZ1JlZi5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgICAgbGFzdE1lc3NhZ2VTZWVuUmVmLmN1cnJlbnQgPSBtZXNzYWdlLmlkO1xuICAgICAgICBtYXJrTWVzc2FnZUFzU2VlbihtZXNzYWdlLmlkKTtcbiAgICAgICAgb25NZXNzYWdlU2VlbiA9PSBudWxsID8gdm9pZCAwIDogb25NZXNzYWdlU2Vlbih7IGxhc3RNZXNzYWdlOiBtZXNzYWdlLCBjb252ZXJzYXRpb25JZCwgdXNlcklkIH0pO1xuICAgICAgICBpc1Byb2Nlc3NpbmdSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0sXG4gICAgW3VzZXJJZCwgY29udmVyc2F0aW9uSWQsIG1hcmtNZXNzYWdlQXNTZWVuLCBvbk1lc3NhZ2VTZWVuXVxuICApO1xuICB1c2VFZmZlY3Q0KCgpID0+IHtcbiAgICBpZiAoIW1lc3NhZ2VzLmxlbmd0aCB8fCAhb25NZXNzYWdlU2Vlbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBsYXN0TWVzc2FnZSA9IG1lc3NhZ2VzW21lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICAgIG1hcmtMYXN0TWVzc2FnZUFzU2VlbihsYXN0TWVzc2FnZSk7XG4gIH0sIFttZXNzYWdlcywgbWFya0xhc3RNZXNzYWdlQXNTZWVuXSk7XG4gIGNvbnN0IHNjcm9sbE1hbmFnZXIgPSB7XG4gICAgY29udGVudFJlZixcbiAgICBzY3JvbGxUb0JvdHRvbSxcbiAgICBpc0F0Qm90dG9tXG4gIH07XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4MihcbiAgICBDaGF0Q29udGV4dC5Qcm92aWRlcixcbiAgICB7XG4gICAgICB2YWx1ZToge1xuICAgICAgICB1c2VySWQsXG4gICAgICAgIG1lc3NhZ2VzLFxuICAgICAgICBsb2FkaW5nU2VuZE1lc3NhZ2UsXG4gICAgICAgIGxvYWRpbmdNb3JlLFxuICAgICAgICBoYXNNb3JlLFxuICAgICAgICB0eXBpbmdVc2VycyxcbiAgICAgICAgcGFydGljaXBhbnRzLFxuICAgICAgICBjb25maWc6IG1lcmdlZENvbmZpZyxcbiAgICAgICAgaXNMb2FkaW5nLFxuICAgICAgICB0b3RhbE1lc3NhZ2VzLFxuICAgICAgICBzZW5kTWVzc2FnZSxcbiAgICAgICAgbG9hZE1vcmVNZXNzYWdlcyxcbiAgICAgICAgdXBkYXRlVHlwaW5nU3RhdHVzOiB1cGRhdGVQdXNoZXJUeXBpbmdTdGF0dXMsXG4gICAgICAgIGdldFBhcnRpY2lwYW50LFxuICAgICAgICBzY3JvbGxNYW5hZ2VyLFxuICAgICAgICBjdXJyZW50TWVzc2FnZXNDb3VudDogbWVzc2FnZXMubGVuZ3RoXG4gICAgICB9LFxuICAgICAgY2hpbGRyZW5cbiAgICB9XG4gICk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9zdHlsZS50c1xuaW1wb3J0IHsgQm94IH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcbmltcG9ydCB7IHN0eWxlZCB9IGZyb20gXCJAbXVpL21hdGVyaWFsL3N0eWxlc1wiO1xudmFyIENvbnRlbnQgPSBzdHlsZWQoQm94KSgoeyB0aGVtZSB9KSA9PiAoe1xuICBmbGV4OiAxLFxuICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDIpLFxuICBvdmVyZmxvd1k6IFwiYXV0b1wiLFxuICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLnBhbGV0dGUuYmFja2dyb3VuZC5wYXBlcixcbiAgXCImOjotd2Via2l0LXNjcm9sbGJhclwiOiB7XG4gICAgd2lkdGg6IFwiOHB4XCJcbiAgfSxcbiAgXCImOjotd2Via2l0LXNjcm9sbGJhci10cmFja1wiOiB7XG4gICAgYmFja2dyb3VuZDogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLmRlZmF1bHQsXG4gICAgYm9yZGVyUmFkaXVzOiBcIjRweFwiXG4gIH0sXG4gIFwiJjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWJcIjoge1xuICAgIGJhY2tncm91bmQ6IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5tYWluLFxuICAgIGJvcmRlclJhZGl1czogXCI0cHhcIixcbiAgICBcIiY6aG92ZXJcIjoge1xuICAgICAgYmFja2dyb3VuZDogdGhlbWUucGFsZXR0ZS5wcmltYXJ5LmRhcmtcbiAgICB9XG4gIH1cbn0pKTtcbnZhciBXYWl0aW5nTWVzc2FnZUNvbnRhaW5lciA9IHN0eWxlZChCb3gpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBmbGV4RGlyZWN0aW9uOiBcImNvbHVtblwiLFxuICBhbGlnbkl0ZW1zOiBcImNlbnRlclwiLFxuICBqdXN0aWZ5Q29udGVudDogXCJjZW50ZXJcIixcbiAgcGFkZGluZzogdGhlbWUuc3BhY2luZyg0KSxcbiAgdGV4dEFsaWduOiBcImNlbnRlclwiLFxuICBjb2xvcjogdGhlbWUucGFsZXR0ZS50ZXh0LnNlY29uZGFyeSxcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDIpXG59KSk7XG52YXIgV2FpdGluZ01lc3NhZ2VFbW9qaSA9IHN0eWxlZChCb3gpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGZvbnRTaXplOiBcIjNyZW1cIixcbiAgbWFyZ2luQm90dG9tOiB0aGVtZS5zcGFjaW5nKDIpXG59KSk7XG52YXIgV2FpdGluZ01lc3NhZ2VUaXRsZSA9IHN0eWxlZChCb3gpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGZvbnRTaXplOiBcIjEuNXJlbVwiLFxuICBtYXJnaW46IDAsXG4gIGNvbG9yOiB0aGVtZS5wYWxldHRlLnRleHQucHJpbWFyeVxufSkpO1xudmFyIFdhaXRpbmdNZXNzYWdlVGV4dCA9IHN0eWxlZChCb3gpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGZvbnRTaXplOiBcIjFyZW1cIixcbiAgbWF4V2lkdGg6IFwiNDAwcHhcIixcbiAgbGluZUhlaWdodDogMS41XG59KSk7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvQ2hhdEFjdGlvbnMvc3R5bGUudHNcbmltcG9ydCB7IEJveCBhcyBCb3gyLCBCdXR0b24gfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDIgfSBmcm9tIFwiQG11aS9tYXRlcmlhbC9zdHlsZXNcIjtcbnZhciBBY3Rpb25zQ29udGFpbmVyID0gc3R5bGVkMihCb3gyKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiLFxuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgZmxleERpcmVjdGlvbjogXCJjb2x1bW5cIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDEpLFxuICB6SW5kZXg6IDFcbn0pKTtcbnZhciBTY3JvbGxCdXR0b24gPSBzdHlsZWQyKEJ1dHRvbikoKHsgdGhlbWUgfSkgPT4gKHtcbiAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgYm90dG9tOiB0aGVtZS5zcGFjaW5nKDIpLFxuICByaWdodDogdGhlbWUuc3BhY2luZygyKSxcbiAgYmFja2dyb3VuZENvbG9yOiB0aGVtZS5wYWxldHRlLnByaW1hcnkubWFpbixcbiAgY29sb3I6IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5jb250cmFzdFRleHQsXG4gIFwiJjpob3ZlclwiOiB7XG4gICAgYmFja2dyb3VuZENvbG9yOiB0aGVtZS5wYWxldHRlLnByaW1hcnkuZGFya1xuICB9LFxuICBib3hTaGFkb3c6IHRoZW1lLnNoYWRvd3NbMl0sXG4gIHdpZHRoOiBcIjQwcHhcIixcbiAgaGVpZ2h0OiBcIjQwcHhcIixcbiAgbWluV2lkdGg6IFwiNDBweFwiLFxuICBwYWRkaW5nOiAwLFxuICBib3JkZXJSYWRpdXM6IFwiNTAlXCIsXG4gIGJhY2tkcm9wRmlsdGVyOiBcImJsdXIoOHB4KVwiLFxuICBib3JkZXI6IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLnByaW1hcnkuZGFya30zM2AsXG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBhbGlnbkl0ZW1zOiBcImNlbnRlclwiLFxuICBqdXN0aWZ5Q29udGVudDogXCJjZW50ZXJcIlxufSkpO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL0NoYXRBY3Rpb25zL2luZGV4LnRzeFxuaW1wb3J0IHsgdXNlRWZmZWN0IGFzIHVzZUVmZmVjdDUsIHVzZVN0YXRlIGFzIHVzZVN0YXRlMiB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgRmFkZSB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgS2V5Ym9hcmRBcnJvd0Rvd25JY29uIGZyb20gXCJAbXVpL2ljb25zLW1hdGVyaWFsL0tleWJvYXJkQXJyb3dEb3duXCI7XG5pbXBvcnQgeyBqc3ggYXMganN4MyB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xudmFyIENoYXRBY3Rpb25zID0gKCkgPT4ge1xuICBjb25zdCB7IHNjcm9sbE1hbmFnZXIgfSA9IHVzZUNoYXRDb250ZXh0KCk7XG4gIGNvbnN0IHsgc2Nyb2xsVG9Cb3R0b20sIGlzQXRCb3R0b20gfSA9IHNjcm9sbE1hbmFnZXI7XG4gIGNvbnN0IFtzaG93QnV0dG9uLCBzZXRTaG93QnV0dG9uXSA9IHVzZVN0YXRlMihmYWxzZSk7XG4gIHVzZUVmZmVjdDUoKCkgPT4ge1xuICAgIGxldCB0aW1lb3V0SWQ7XG4gICAgaWYgKCFpc0F0Qm90dG9tKSB7XG4gICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgc2V0U2hvd0J1dHRvbih0cnVlKTtcbiAgICAgIH0sIDUwMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzZXRTaG93QnV0dG9uKGZhbHNlKTtcbiAgICAgIH0sIDEwMCk7XG4gICAgfVxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICB9O1xuICB9LCBbaXNBdEJvdHRvbV0pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeDMoQWN0aW9uc0NvbnRhaW5lciwgeyBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDMoRmFkZSwgeyBpbjogc2hvd0J1dHRvbiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gzKFxuICAgIFNjcm9sbEJ1dHRvbixcbiAgICB7XG4gICAgICBvbkNsaWNrOiAoKSA9PiBzY3JvbGxUb0JvdHRvbShcInNtb290aFwiKSxcbiAgICAgIHZhcmlhbnQ6IFwiY29udGFpbmVkXCIsXG4gICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDMoS2V5Ym9hcmRBcnJvd0Rvd25JY29uLCB7fSlcbiAgICB9XG4gICkgfSkgfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL0xvYWRNb3JlTWVzc2FnZXMvc3R5bGUudHNcbmltcG9ydCB7IEJveCBhcyBCb3gzLCBCdXR0b24gYXMgQnV0dG9uMiB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgeyBzdHlsZWQgYXMgc3R5bGVkMyB9IGZyb20gXCJAbXVpL21hdGVyaWFsL3N0eWxlc1wiO1xudmFyIExvYWRNb3JlQ29udGFpbmVyID0gc3R5bGVkMyhCb3gzKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBkaXNwbGF5OiBcImZsZXhcIixcbiAganVzdGlmeUNvbnRlbnQ6IFwiY2VudGVyXCIsXG4gIHBhZGRpbmc6IHRoZW1lLnNwYWNpbmcoMilcbn0pKTtcbnZhciBMb2FkTW9yZUJ1dHRvbiA9IHN0eWxlZDMoQnV0dG9uMikoKHsgdGhlbWUgfSkgPT4gKHtcbiAgYm9yZGVyUmFkaXVzOiBcIjIwcHhcIixcbiAgdGV4dFRyYW5zZm9ybTogXCJub25lXCIsXG4gIG1pbldpZHRoOiBcIjE1MHB4XCIsXG4gIG1heFdpZHRoOiBcIjEwMCVcIixcbiAgZm9udFNpemU6IFwiMC45cmVtXCIsXG4gIHBhZGRpbmc6IFwiNnB4IDE2cHhcIixcbiAgW3RoZW1lLmJyZWFrcG9pbnRzLnVwKFwic21cIildOiB7XG4gICAgbWluV2lkdGg6IFwiMTgwcHhcIixcbiAgICBmb250U2l6ZTogXCIwLjlyZW1cIixcbiAgICBwYWRkaW5nOiBcIjZweCAxNnB4XCJcbiAgfSxcbiAgW3RoZW1lLmJyZWFrcG9pbnRzLmRvd24oXCJzbVwiKV06IHtcbiAgICBtaW5XaWR0aDogXCIxNTBweFwiLFxuICAgIGZvbnRTaXplOiBcIjAuOHJlbVwiLFxuICAgIHBhZGRpbmc6IFwiNHB4IDhweFwiXG4gIH1cbn0pKTtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXQvY29tcG9uZW50cy9Mb2FkTW9yZU1lc3NhZ2VzL2luZGV4LnRzeFxuaW1wb3J0IHsgQ2lyY3VsYXJQcm9ncmVzcyB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgS2V5Ym9hcmRBcnJvd1VwSWNvbiBmcm9tIFwiQG11aS9pY29ucy1tYXRlcmlhbC9LZXlib2FyZEFycm93VXBcIjtcbmltcG9ydCB7IHVzZVJlZiBhcyB1c2VSZWY0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBqc3ggYXMganN4NCB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xudmFyIExvYWRNb3JlTWVzc2FnZXMgPSAoKSA9PiB7XG4gIGNvbnN0IHtcbiAgICBpc0xvYWRpbmcsXG4gICAgbG9hZGluZ01vcmUsXG4gICAgaGFzTW9yZSxcbiAgICB0b3RhbE1lc3NhZ2VzLFxuICAgIGN1cnJlbnRNZXNzYWdlc0NvdW50LFxuICAgIGxvYWRNb3JlTWVzc2FnZXMsXG4gICAgc2Nyb2xsTWFuYWdlclxuICB9ID0gdXNlQ2hhdENvbnRleHQoKTtcbiAgY29uc3QgcHJldmlvdXNTY3JvbGxIZWlnaHQgPSB1c2VSZWY0KDApO1xuICBjb25zdCBwcmV2aW91c1Njcm9sbFRvcCA9IHVzZVJlZjQoMCk7XG4gIGNvbnN0IGhhbmRsZUxvYWRNb3JlID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmIChzY3JvbGxNYW5hZ2VyLmNvbnRlbnRSZWYuY3VycmVudCkge1xuICAgICAgcHJldmlvdXNTY3JvbGxIZWlnaHQuY3VycmVudCA9IHNjcm9sbE1hbmFnZXIuY29udGVudFJlZi5jdXJyZW50LnNjcm9sbEhlaWdodDtcbiAgICAgIHByZXZpb3VzU2Nyb2xsVG9wLmN1cnJlbnQgPSBzY3JvbGxNYW5hZ2VyLmNvbnRlbnRSZWYuY3VycmVudC5zY3JvbGxUb3A7XG4gICAgfVxuICAgIGF3YWl0IGxvYWRNb3JlTWVzc2FnZXMoKTtcbiAgICBpZiAoc2Nyb2xsTWFuYWdlci5jb250ZW50UmVmLmN1cnJlbnQpIHtcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3QgbmV3U2Nyb2xsSGVpZ2h0ID0gKChfYSA9IHNjcm9sbE1hbmFnZXIuY29udGVudFJlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2Euc2Nyb2xsSGVpZ2h0KSB8fCAwO1xuICAgICAgICBjb25zdCBzY3JvbGxEaWZmID0gbmV3U2Nyb2xsSGVpZ2h0IC0gcHJldmlvdXNTY3JvbGxIZWlnaHQuY3VycmVudDtcbiAgICAgICAgaWYgKHNjcm9sbE1hbmFnZXIuY29udGVudFJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgc2Nyb2xsTWFuYWdlci5jb250ZW50UmVmLmN1cnJlbnQuc2Nyb2xsVG9wID0gcHJldmlvdXNTY3JvbGxUb3AuY3VycmVudCArIHNjcm9sbERpZmY7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgaWYgKCFoYXNNb3JlIHx8IGlzTG9hZGluZyB8fCB0b3RhbE1lc3NhZ2VzICE9PSB2b2lkIDAgJiYgY3VycmVudE1lc3NhZ2VzQ291bnQgPj0gdG90YWxNZXNzYWdlcylcbiAgICByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3g0KExvYWRNb3JlQ29udGFpbmVyLCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4NChcbiAgICBMb2FkTW9yZUJ1dHRvbixcbiAgICB7XG4gICAgICB2YXJpYW50OiBcIm91dGxpbmVkXCIsXG4gICAgICBvbkNsaWNrOiBoYW5kbGVMb2FkTW9yZSxcbiAgICAgIGRpc2FibGVkOiBsb2FkaW5nTW9yZSxcbiAgICAgIHN0YXJ0SWNvbjogbG9hZGluZ01vcmUgPyAvKiBAX19QVVJFX18gKi8ganN4NChDaXJjdWxhclByb2dyZXNzLCB7IHNpemU6IDIwIH0pIDogLyogQF9fUFVSRV9fICovIGpzeDQoS2V5Ym9hcmRBcnJvd1VwSWNvbiwge30pLFxuICAgICAgY2hpbGRyZW46IGxvYWRpbmdNb3JlID8gXCJDaGFyZ2VtZW50Li4uXCIgOiBcIk1lc3NhZ2VzIHBsdXMgYW5jaWVuc1wiXG4gICAgfVxuICApIH0pO1xufTtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXQvY29tcG9uZW50cy9NZXNzYWdlSW5wdXQvc3R5bGUudHNcbmltcG9ydCB7IEJveCBhcyBCb3g0LCBJbnB1dEJhc2UgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDQgfSBmcm9tIFwiQG11aS9tYXRlcmlhbC9zdHlsZXNcIjtcbnZhciBJbnB1dENvbnRhaW5lciA9IHN0eWxlZDQoQm94NCkoKHsgdGhlbWUgfSkgPT4gKHtcbiAgcGFkZGluZzogdGhlbWUuc3BhY2luZygxKSxcbiAgYm9yZGVyVG9wOiBgMXB4IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5kaXZpZGVyfWAsXG4gIGJhY2tncm91bmQ6IHRoZW1lLnBhbGV0dGUuYmFja2dyb3VuZC5wYXBlcixcbiAgZGlzcGxheTogXCJmbGV4XCIsXG4gIGFsaWduSXRlbXM6IFwiY2VudGVyXCIsXG4gIGdhcDogdGhlbWUuc3BhY2luZygwLjUpLFxuICBbdGhlbWUuYnJlYWtwb2ludHMudXAoXCJzbVwiKV06IHtcbiAgICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDEuNSksXG4gICAgZ2FwOiB0aGVtZS5zcGFjaW5nKDEpXG4gIH1cbn0pKTtcbnZhciBTdHlsZWRJbnB1dCA9IHN0eWxlZDQoSW5wdXRCYXNlKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBmbGV4OiAxLFxuICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDAuNSwgMSksXG4gIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLmRlZmF1bHQsXG4gIGJvcmRlclJhZGl1czogMjAsXG4gIGZvbnRTaXplOiBcIjAuOXJlbVwiLFxuICBcIiYgaW5wdXRcIjoge1xuICAgIHBhZGRpbmc6IHRoZW1lLnNwYWNpbmcoMC41LCAwKVxuICB9LFxuICBbdGhlbWUuYnJlYWtwb2ludHMudXAoXCJzbVwiKV06IHtcbiAgICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDAuNSwgMS41KVxuICB9XG59KSk7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvTWVzc2FnZUlucHV0L2luZGV4LnRzeFxuaW1wb3J0IHsgdXNlRWZmZWN0IGFzIHVzZUVmZmVjdDYsIHVzZVJlZiBhcyB1c2VSZWY3LCB1c2VTdGF0ZSBhcyB1c2VTdGF0ZTYgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEJveCBhcyBCb3g5IH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcbmltcG9ydCB7IEJ1dHRvbiBhcyBCdXR0b24zIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXQvY29tcG9uZW50cy9FbW9qaVBpY2tlci9pbmRleC50c3hcbmltcG9ydCB7IEJveCBhcyBCb3g1LCBJY29uQnV0dG9uLCBQb3BvdmVyIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcbmltcG9ydCBFbW9qaVBpY2tlciBmcm9tIFwiZW1vamktcGlja2VyLXJlYWN0XCI7XG5pbXBvcnQgU2VudGltZW50U2F0aXNmaWVkQWx0SWNvbiBmcm9tIFwiQG11aS9pY29ucy1tYXRlcmlhbC9TZW50aW1lbnRTYXRpc2ZpZWRBbHRcIjtcbmltcG9ydCB7IHVzZVN0YXRlIGFzIHVzZVN0YXRlMyB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsganN4IGFzIGpzeDUsIGpzeHMgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBFbW9qaVBpY2tlckNvbXBvbmVudCA9ICh7XG4gIG9uRW1vamlDbGljayxcbiAgZGlzYWJsZWQgPSBmYWxzZVxufSkgPT4ge1xuICBjb25zdCBbYW5jaG9yRWwsIHNldEFuY2hvckVsXSA9IHVzZVN0YXRlMyhudWxsKTtcbiAgY29uc3QgaGFuZGxlQ2xpY2sgPSAoZXZlbnQpID0+IHtcbiAgICBzZXRBbmNob3JFbChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlQ2xvc2UgPSAoKSA9PiB7XG4gICAgc2V0QW5jaG9yRWwobnVsbCk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZUVtb2ppQ2xpY2sgPSAoZW1vamlEYXRhKSA9PiB7XG4gICAgb25FbW9qaUNsaWNrKGVtb2ppRGF0YS5lbW9qaSk7XG4gICAgaGFuZGxlQ2xvc2UoKTtcbiAgfTtcbiAgY29uc3Qgb3BlbiA9IEJvb2xlYW4oYW5jaG9yRWwpO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMoQm94NSwgeyBjaGlsZHJlbjogW1xuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3g1KFxuICAgICAgSWNvbkJ1dHRvbixcbiAgICAgIHtcbiAgICAgICAgZGlzYWJsZWQsXG4gICAgICAgIG9uQ2xpY2s6IGhhbmRsZUNsaWNrLFxuICAgICAgICBzaXplOiBcInNtYWxsXCIsXG4gICAgICAgIHN4OiB7XG4gICAgICAgICAgY29sb3I6IFwidGV4dC5zZWNvbmRhcnlcIixcbiAgICAgICAgICBcIiY6aG92ZXJcIjoge1xuICAgICAgICAgICAgY29sb3I6IFwicHJpbWFyeS5tYWluXCJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4NShTZW50aW1lbnRTYXRpc2ZpZWRBbHRJY29uLCB7fSlcbiAgICAgIH1cbiAgICApLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3g1KFxuICAgICAgUG9wb3ZlcixcbiAgICAgIHtcbiAgICAgICAgb3BlbixcbiAgICAgICAgYW5jaG9yRWwsXG4gICAgICAgIG9uQ2xvc2U6IGhhbmRsZUNsb3NlLFxuICAgICAgICBhbmNob3JPcmlnaW46IHtcbiAgICAgICAgICB2ZXJ0aWNhbDogXCJ0b3BcIixcbiAgICAgICAgICBob3Jpem9udGFsOiBcInJpZ2h0XCJcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmb3JtT3JpZ2luOiB7XG4gICAgICAgICAgdmVydGljYWw6IFwiYm90dG9tXCIsXG4gICAgICAgICAgaG9yaXpvbnRhbDogXCJsZWZ0XCJcbiAgICAgICAgfSxcbiAgICAgICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3g1KFxuICAgICAgICAgIEVtb2ppUGlja2VyLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIG9uRW1vamlDbGljazogaGFuZGxlRW1vamlDbGljayxcbiAgICAgICAgICAgIHdpZHRoOiAzMDAsXG4gICAgICAgICAgICBoZWlnaHQ6IDQwMCxcbiAgICAgICAgICAgIHNlYXJjaFBsYWNlaG9sZGVyOiBcIlJlY2hlcmNoZXIgdW4gZW1vamkuLi5cIlxuICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgfVxuICAgIClcbiAgXSB9KTtcbn07XG52YXIgRW1vamlQaWNrZXJfZGVmYXVsdCA9IEVtb2ppUGlja2VyQ29tcG9uZW50O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL0ZpbGVMaXN0L2luZGV4LnRzeFxuaW1wb3J0IHsgQm94IGFzIEJveDYsIENoaXAgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsganN4IGFzIGpzeDYgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBGaWxlTGlzdCA9ICh7IGF0dGFjaG1lbnRzLCBvblJlbW92ZUZpbGUgfSkgPT4ge1xuICBpZiAoYXR0YWNobWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3g2KFxuICAgIEJveDYsXG4gICAge1xuICAgICAgc3g6IHtcbiAgICAgICAgZGlzcGxheTogXCJmbGV4XCIsXG4gICAgICAgIGZsZXhXcmFwOiBcIndyYXBcIixcbiAgICAgICAgZ2FwOiAxLFxuICAgICAgICBwOiAxLFxuICAgICAgICBib3JkZXJCb3R0b206IFwiMXB4IHNvbGlkXCIsXG4gICAgICAgIGJvcmRlckNvbG9yOiBcImRpdmlkZXJcIlxuICAgICAgfSxcbiAgICAgIGNoaWxkcmVuOiBhdHRhY2htZW50cy5tYXAoKGF0dGFjaG1lbnQsIGluZGV4KSA9PiAvKiBAX19QVVJFX18gKi8ganN4NihcbiAgICAgICAgQ2hpcCxcbiAgICAgICAge1xuICAgICAgICAgIGxhYmVsOiBhdHRhY2htZW50Lm5hbWUsXG4gICAgICAgICAgb25EZWxldGU6ICgpID0+IG9uUmVtb3ZlRmlsZShhdHRhY2htZW50KSxcbiAgICAgICAgICBzaXplOiBcInNtYWxsXCIsXG4gICAgICAgICAgc3g6IHtcbiAgICAgICAgICAgIG1heFdpZHRoOiAyMDAsXG4gICAgICAgICAgICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiLFxuICAgICAgICAgICAgekluZGV4OiAxLFxuICAgICAgICAgICAgXCImOmhvdmVyXCI6IHtcbiAgICAgICAgICAgICAgekluZGV4OiAyXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCImIC5NdWlDaGlwLWxhYmVsXCI6IHtcbiAgICAgICAgICAgICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gICAgICAgICAgICAgIHRleHRPdmVyZmxvdzogXCJlbGxpcHNpc1wiLFxuICAgICAgICAgICAgICB3aGl0ZVNwYWNlOiBcIm5vd3JhcFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCImIC5NdWlDaGlwLWRlbGV0ZUljb25cIjoge1xuICAgICAgICAgICAgICB6SW5kZXg6IDNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGluZGV4XG4gICAgICApKVxuICAgIH1cbiAgKTtcbn07XG52YXIgRmlsZUxpc3RfZGVmYXVsdCA9IEZpbGVMaXN0O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL0ZpbGVQaWNrZXIvaW5kZXgudHN4XG5pbXBvcnQgeyBCb3ggYXMgQm94NywgSWNvbkJ1dHRvbiBhcyBJY29uQnV0dG9uMiB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgeyB1c2VSZWYgYXMgdXNlUmVmNSwgdXNlU3RhdGUgYXMgdXNlU3RhdGU0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgQXR0YWNoRmlsZUljb24gZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvQXR0YWNoRmlsZVwiO1xuaW1wb3J0IHsganN4IGFzIGpzeDcsIGpzeHMgYXMganN4czIgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbmZ1bmN0aW9uIEZpbGVQaWNrZXIoe1xuICBvbkZpbGVzU2VsZWN0LFxuICBkaXNhYmxlZCA9IGZhbHNlXG59KSB7XG4gIGNvbnN0IFthbmNob3JFbCwgc2V0QW5jaG9yRWxdID0gdXNlU3RhdGU0KG51bGwpO1xuICBjb25zdCBmaWxlSW5wdXRSZWYgPSB1c2VSZWY1KG51bGwpO1xuICBjb25zdCBoYW5kbGVDbGljayA9IChldmVudCkgPT4ge1xuICAgIHZhciBfYTtcbiAgICBzZXRBbmNob3JFbChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAoX2EgPSBmaWxlSW5wdXRSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNsaWNrKCk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZUNsb3NlID0gKCkgPT4ge1xuICAgIHNldEFuY2hvckVsKG51bGwpO1xuICB9O1xuICBjb25zdCBoYW5kbGVGaWxlQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgY29uc3QgYXR0YWNobWVudHMgPSBldmVudC50YXJnZXQuZmlsZXM7XG4gICAgaWYgKGF0dGFjaG1lbnRzICYmIGF0dGFjaG1lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIG9uRmlsZXNTZWxlY3QoQXJyYXkuZnJvbShhdHRhY2htZW50cykpO1xuICAgIH1cbiAgICBoYW5kbGVDbG9zZSgpO1xuICB9O1xuICBjb25zdCBvcGVuID0gQm9vbGVhbihhbmNob3JFbCk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4czIoQm94NywgeyBjaGlsZHJlbjogW1xuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3g3KFxuICAgICAgXCJpbnB1dFwiLFxuICAgICAge1xuICAgICAgICB0eXBlOiBcImZpbGVcIixcbiAgICAgICAgcmVmOiBmaWxlSW5wdXRSZWYsXG4gICAgICAgIG9uQ2hhbmdlOiBoYW5kbGVGaWxlQ2hhbmdlLFxuICAgICAgICBtdWx0aXBsZTogdHJ1ZSxcbiAgICAgICAgc3R5bGU6IHsgZGlzcGxheTogXCJub25lXCIgfVxuICAgICAgfVxuICAgICksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeDcoXG4gICAgICBJY29uQnV0dG9uMixcbiAgICAgIHtcbiAgICAgICAgb25DbGljazogaGFuZGxlQ2xpY2ssXG4gICAgICAgIHNpemU6IFwic21hbGxcIixcbiAgICAgICAgc3g6IHtcbiAgICAgICAgICBjb2xvcjogXCJ0ZXh0LnNlY29uZGFyeVwiLFxuICAgICAgICAgIFwiJjpob3ZlclwiOiB7XG4gICAgICAgICAgICBjb2xvcjogXCJwcmltYXJ5Lm1haW5cIlxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZGlzYWJsZWQsXG4gICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4NyhBdHRhY2hGaWxlSWNvbiwge30pXG4gICAgICB9XG4gICAgKVxuICBdIH0pO1xufVxuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VJbnB1dC9pbmRleC50c3hcbmltcG9ydCBTZW5kSWNvbiBmcm9tIFwiQG11aS9pY29ucy1tYXRlcmlhbC9TZW5kXCI7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvVm9pY2VSZWNvcmRlci9pbmRleC50c3hcbmltcG9ydCB7IEJveCBhcyBCb3g4LCBDaXJjdWxhclByb2dyZXNzIGFzIENpcmN1bGFyUHJvZ3Jlc3MyLCBJY29uQnV0dG9uIGFzIEljb25CdXR0b24zIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcbmltcG9ydCB7IHVzZVJlZiBhcyB1c2VSZWY2LCB1c2VTdGF0ZSBhcyB1c2VTdGF0ZTUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBNaWNJY29uIGZyb20gXCJAbXVpL2ljb25zLW1hdGVyaWFsL01pY1wiO1xuaW1wb3J0IFN0b3BJY29uIGZyb20gXCJAbXVpL2ljb25zLW1hdGVyaWFsL1N0b3BcIjtcbmltcG9ydCB7IGpzeCBhcyBqc3g4LCBqc3hzIGFzIGpzeHMzIH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG5mdW5jdGlvbiBWb2ljZVJlY29yZGVyKHtcbiAgb25SZWNvcmRpbmdDb21wbGV0ZSxcbiAgZGlzYWJsZWQgPSBmYWxzZVxufSkge1xuICBjb25zdCBbaXNSZWNvcmRpbmcsIHNldElzUmVjb3JkaW5nXSA9IHVzZVN0YXRlNShmYWxzZSk7XG4gIGNvbnN0IFtyZWNvcmRpbmdUaW1lLCBzZXRSZWNvcmRpbmdUaW1lXSA9IHVzZVN0YXRlNSgwKTtcbiAgY29uc3QgbWVkaWFSZWNvcmRlclJlZiA9IHVzZVJlZjYobnVsbCk7XG4gIGNvbnN0IHRpbWVyUmVmID0gdXNlUmVmNigpO1xuICBjb25zdCBhdWRpb0NodW5rc1JlZiA9IHVzZVJlZjYoW10pO1xuICBjb25zdCBzdGFydFJlY29yZGluZyA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RyZWFtID0gYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoeyBhdWRpbzogdHJ1ZSB9KTtcbiAgICAgIGNvbnN0IG1lZGlhUmVjb3JkZXIgPSBuZXcgTWVkaWFSZWNvcmRlcihzdHJlYW0pO1xuICAgICAgbWVkaWFSZWNvcmRlclJlZi5jdXJyZW50ID0gbWVkaWFSZWNvcmRlcjtcbiAgICAgIGF1ZGlvQ2h1bmtzUmVmLmN1cnJlbnQgPSBbXTtcbiAgICAgIG1lZGlhUmVjb3JkZXIub25kYXRhYXZhaWxhYmxlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChldmVudC5kYXRhLnNpemUgPiAwKSB7XG4gICAgICAgICAgYXVkaW9DaHVua3NSZWYuY3VycmVudC5wdXNoKGV2ZW50LmRhdGEpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgbWVkaWFSZWNvcmRlci5vbnN0b3AgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGF1ZGlvQmxvYiA9IG5ldyBCbG9iKGF1ZGlvQ2h1bmtzUmVmLmN1cnJlbnQsIHtcbiAgICAgICAgICB0eXBlOiBcImF1ZGlvL3dlYm1cIlxuICAgICAgICB9KTtcbiAgICAgICAgb25SZWNvcmRpbmdDb21wbGV0ZShhdWRpb0Jsb2IpO1xuICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCgodHJhY2spID0+IHRyYWNrLnN0b3AoKSk7XG4gICAgICAgIHNldFJlY29yZGluZ1RpbWUoMCk7XG4gICAgICB9O1xuICAgICAgbWVkaWFSZWNvcmRlci5zdGFydCgpO1xuICAgICAgc2V0SXNSZWNvcmRpbmcodHJ1ZSk7XG4gICAgICB0aW1lclJlZi5jdXJyZW50ID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBzZXRSZWNvcmRpbmdUaW1lKChwcmV2KSA9PiBwcmV2ICsgMSk7XG4gICAgICB9LCAxZTMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGxvcnMgZGUgbCdhY2NcXHhFOHMgYXUgbWljcm9waG9uZTpcIiwgZXJyb3IpO1xuICAgIH1cbiAgfTtcbiAgY29uc3Qgc3RvcFJlY29yZGluZyA9ICgpID0+IHtcbiAgICBpZiAobWVkaWFSZWNvcmRlclJlZi5jdXJyZW50ICYmIGlzUmVjb3JkaW5nKSB7XG4gICAgICBtZWRpYVJlY29yZGVyUmVmLmN1cnJlbnQuc3RvcCgpO1xuICAgICAgc2V0SXNSZWNvcmRpbmcoZmFsc2UpO1xuICAgICAgaWYgKHRpbWVyUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lclJlZi5jdXJyZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIGNvbnN0IGZvcm1hdFRpbWUyID0gKHNlY29uZHMpID0+IHtcbiAgICBjb25zdCBtaW5zID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gNjApO1xuICAgIGNvbnN0IHNlY3MgPSBzZWNvbmRzICUgNjA7XG4gICAgcmV0dXJuIGAke21pbnN9OiR7c2Vjcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX1gO1xuICB9O1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMzKEJveDgsIHsgc3g6IHsgZGlzcGxheTogXCJmbGV4XCIsIGFsaWduSXRlbXM6IFwiY2VudGVyXCIsIGdhcDogMSB9LCBjaGlsZHJlbjogW1xuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3g4KFxuICAgICAgSWNvbkJ1dHRvbjMsXG4gICAgICB7XG4gICAgICAgIG9uQ2xpY2s6IGlzUmVjb3JkaW5nID8gc3RvcFJlY29yZGluZyA6IHN0YXJ0UmVjb3JkaW5nLFxuICAgICAgICBzaXplOiBcInNtYWxsXCIsXG4gICAgICAgIHN4OiB7XG4gICAgICAgICAgY29sb3I6IGlzUmVjb3JkaW5nID8gXCJlcnJvci5tYWluXCIgOiBcInRleHQuc2Vjb25kYXJ5XCIsXG4gICAgICAgICAgXCImOmhvdmVyXCI6IHtcbiAgICAgICAgICAgIGNvbG9yOiBpc1JlY29yZGluZyA/IFwiZXJyb3IuZGFya1wiIDogXCJwcmltYXJ5Lm1haW5cIlxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZGlzYWJsZWQsXG4gICAgICAgIGNoaWxkcmVuOiBpc1JlY29yZGluZyA/IC8qIEBfX1BVUkVfXyAqLyBqc3g4KFN0b3BJY29uLCB7fSkgOiAvKiBAX19QVVJFX18gKi8ganN4OChNaWNJY29uLCB7fSlcbiAgICAgIH1cbiAgICApLFxuICAgIGlzUmVjb3JkaW5nICYmIC8qIEBfX1BVUkVfXyAqLyBqc3hzMyhCb3g4LCB7IHN4OiB7IGRpc3BsYXk6IFwiZmxleFwiLCBhbGlnbkl0ZW1zOiBcImNlbnRlclwiLCBnYXA6IDEgfSwgY2hpbGRyZW46IFtcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3g4KENpcmN1bGFyUHJvZ3Jlc3MyLCB7IHNpemU6IDE2LCBjb2xvcjogXCJlcnJvclwiIH0pLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeDgoXCJzcGFuXCIsIHsgc3R5bGU6IHsgZm9udFNpemU6IFwiMC44cmVtXCIsIGNvbG9yOiBcImVycm9yLm1haW5cIiB9LCBjaGlsZHJlbjogZm9ybWF0VGltZTIocmVjb3JkaW5nVGltZSkgfSlcbiAgICBdIH0pXG4gIF0gfSk7XG59XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvTWVzc2FnZUlucHV0L2luZGV4LnRzeFxuaW1wb3J0IHsganN4IGFzIGpzeDksIGpzeHMgYXMganN4czQgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbmZ1bmN0aW9uIE1lc3NhZ2VJbnB1dCgpIHtcbiAgY29uc3QgeyBzZW5kTWVzc2FnZSwgdXBkYXRlVHlwaW5nU3RhdHVzLCBjb25maWcsIGxvYWRpbmdTZW5kTWVzc2FnZSB9ID0gdXNlQ2hhdENvbnRleHQoKTtcbiAgY29uc3QgaW5wdXRSZWYgPSB1c2VSZWY3KG51bGwpO1xuICBjb25zdCBbbWVzc2FnZSwgc2V0TWVzc2FnZV0gPSB1c2VTdGF0ZTYoXCJcIik7XG4gIGNvbnN0IFtpc1R5cGluZywgc2V0SXNUeXBpbmddID0gdXNlU3RhdGU2KGZhbHNlKTtcbiAgY29uc3QgdHlwaW5nVGltZW91dFJlZiA9IHVzZVJlZjcoKTtcbiAgY29uc3QgaXNUeXBpbmdEaXNhYmxlZFJlZiA9IHVzZVJlZjcoZmFsc2UpO1xuICBjb25zdCBbc2VsZWN0ZWRGaWxlcywgc2V0U2VsZWN0ZWRGaWxlc10gPSB1c2VTdGF0ZTYoW10pO1xuICBjb25zdCBjbGVhclR5cGluZ1RpbWVvdXQgPSAoKSA9PiB7XG4gICAgaWYgKHR5cGluZ1RpbWVvdXRSZWYuY3VycmVudCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHR5cGluZ1RpbWVvdXRSZWYuY3VycmVudCk7XG4gICAgfVxuICB9O1xuICBjb25zdCBoYW5kbGVTZW5kID0gKCkgPT4ge1xuICAgIGNvbnN0IHRyaW1tZWRNZXNzYWdlID0gbWVzc2FnZS50cmltKCk7XG4gICAgaWYgKHRyaW1tZWRNZXNzYWdlLnRyaW0oKSB8fCBzZWxlY3RlZEZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNsZWFyVHlwaW5nVGltZW91dCgpO1xuICAgICAgaXNUeXBpbmdEaXNhYmxlZFJlZi5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgIHNldElzVHlwaW5nKGZhbHNlKTtcbiAgICAgIHVwZGF0ZVR5cGluZ1N0YXR1cyhmYWxzZSk7XG4gICAgICBzZW5kTWVzc2FnZSh7XG4gICAgICAgIGNvbnRlbnQ6IHRyaW1tZWRNZXNzYWdlLFxuICAgICAgICBhdHRhY2htZW50czogc2VsZWN0ZWRGaWxlcyxcbiAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgfSkuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHNldE1lc3NhZ2UoXCJcIik7XG4gICAgICAgIHNldFNlbGVjdGVkRmlsZXMoW10pO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgKF9hID0gaW5wdXRSZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmZvY3VzKCk7XG4gICAgICAgIH0sIDApO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICBjb25zdCBoYW5kbGVLZXlQcmVzcyA9IChldmVudCkgPT4ge1xuICAgIGlmIChldmVudC5rZXkgPT09IFwiRW50ZXJcIiAmJiAhZXZlbnQuY3RybEtleSAmJiAhZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBoYW5kbGVTZW5kKCk7XG4gICAgfVxuICB9O1xuICBjb25zdCBoYW5kbGVFbW9qaUNsaWNrID0gKGVtb2ppKSA9PiB7XG4gICAgc2V0TWVzc2FnZSgocHJldikgPT4gcHJldiArIGVtb2ppKTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlTWVzc2FnZUNoYW5nZSA9IChlKSA9PiB7XG4gICAgY29uc3QgbmV3VmFsdWUgPSBlLnRhcmdldC52YWx1ZTtcbiAgICBjb25zdCBjYXBpdGFsaXplZFZhbHVlID0gbmV3VmFsdWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuZXdWYWx1ZS5zbGljZSgxKTtcbiAgICBzZXRNZXNzYWdlKGNhcGl0YWxpemVkVmFsdWUpO1xuICAgIGlmIChuZXdWYWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICBpc1R5cGluZ0Rpc2FibGVkUmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgIGlmICghaXNUeXBpbmcpIHtcbiAgICAgICAgc2V0SXNUeXBpbmcodHJ1ZSk7XG4gICAgICAgIHVwZGF0ZVR5cGluZ1N0YXR1cyh0cnVlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHVzZUVmZmVjdDYoKCkgPT4ge1xuICAgIGNvbnN0IG5ld0lzVHlwaW5nID0gbWVzc2FnZS5sZW5ndGggPiAwICYmICFpc1R5cGluZ0Rpc2FibGVkUmVmLmN1cnJlbnQ7XG4gICAgaWYgKG5ld0lzVHlwaW5nICE9PSBpc1R5cGluZykge1xuICAgICAgc2V0SXNUeXBpbmcobmV3SXNUeXBpbmcpO1xuICAgICAgdXBkYXRlVHlwaW5nU3RhdHVzKG5ld0lzVHlwaW5nKTtcbiAgICB9XG4gIH0sIFttZXNzYWdlLCBpc1R5cGluZywgdXBkYXRlVHlwaW5nU3RhdHVzXSk7XG4gIGNvbnN0IGhhbmRsZUJsdXIgPSAoKSA9PiB7XG4gICAgY2xlYXJUeXBpbmdUaW1lb3V0KCk7XG4gICAgdHlwaW5nVGltZW91dFJlZi5jdXJyZW50ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpc1R5cGluZ0Rpc2FibGVkUmVmLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgc2V0SXNUeXBpbmcoZmFsc2UpO1xuICAgICAgdXBkYXRlVHlwaW5nU3RhdHVzKGZhbHNlKTtcbiAgICB9LCBjb25maWcgPT0gbnVsbCA/IHZvaWQgMCA6IGNvbmZpZy50eXBpbmdUaW1lb3V0KTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlRm9jdXMgPSAoKSA9PiB7XG4gICAgaWYgKHR5cGluZ1RpbWVvdXRSZWYuY3VycmVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpc1R5cGluZ0Rpc2FibGVkUmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgICBpZiAobWVzc2FnZS5sZW5ndGggPiAwKSB7XG4gICAgICBzZXRJc1R5cGluZyh0cnVlKTtcbiAgICAgIHVwZGF0ZVR5cGluZ1N0YXR1cyh0cnVlKTtcbiAgICB9XG4gIH07XG4gIHVzZUVmZmVjdDYoKCkgPT4ge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjbGVhclR5cGluZ1RpbWVvdXQoKTtcbiAgICB9O1xuICB9LCBbXSk7XG4gIGNvbnN0IGhhbmRsZUZpbGVzU2VsZWN0ID0gKGF0dGFjaG1lbnRzKSA9PiB7XG4gICAgc2V0U2VsZWN0ZWRGaWxlcygocHJldikgPT4gWy4uLnByZXYsIC4uLmF0dGFjaG1lbnRzXSk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZVJlbW92ZUZpbGUgPSAoZmlsZVRvUmVtb3ZlKSA9PiB7XG4gICAgc2V0U2VsZWN0ZWRGaWxlcygocHJldikgPT4gcHJldi5maWx0ZXIoKGZpbGUpID0+IGZpbGUgIT09IGZpbGVUb1JlbW92ZSkpO1xuICB9O1xuICBjb25zdCBoYW5kbGVWb2ljZVJlY29yZGluZyA9IChhdWRpb0Jsb2IpID0+IHtcbiAgICBjb25zdCBhdWRpb0ZpbGUgPSBuZXcgRmlsZShcbiAgICAgIFthdWRpb0Jsb2JdLFxuICAgICAgYHZvaWNlLW1lc3NhZ2UtJHtEYXRlLm5vdygpfS53ZWJtYCxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogXCJhdWRpby93ZWJtXCJcbiAgICAgIH1cbiAgICApO1xuICAgIHNldFNlbGVjdGVkRmlsZXMoKHByZXYpID0+IFsuLi5wcmV2LCBhdWRpb0ZpbGVdKTtcbiAgfTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzNChCb3g5LCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeDkoRmlsZUxpc3RfZGVmYXVsdCwgeyBhdHRhY2htZW50czogc2VsZWN0ZWRGaWxlcywgb25SZW1vdmVGaWxlOiBoYW5kbGVSZW1vdmVGaWxlIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzNChJbnB1dENvbnRhaW5lciwgeyBjaGlsZHJlbjogW1xuICAgICAgKGNvbmZpZyA9PSBudWxsID8gdm9pZCAwIDogY29uZmlnLmFjdGl2ZUVtb2ppKSAmJiAvKiBAX19QVVJFX18gKi8ganN4OShcbiAgICAgICAgRW1vamlQaWNrZXJfZGVmYXVsdCxcbiAgICAgICAge1xuICAgICAgICAgIG9uRW1vamlDbGljazogaGFuZGxlRW1vamlDbGljayxcbiAgICAgICAgICBkaXNhYmxlZDogbG9hZGluZ1NlbmRNZXNzYWdlXG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICAoY29uZmlnID09IG51bGwgPyB2b2lkIDAgOiBjb25maWcuYWN0aXZlRmlsZSkgJiYgLyogQF9fUFVSRV9fICovIGpzeDkoXG4gICAgICAgIEZpbGVQaWNrZXIsXG4gICAgICAgIHtcbiAgICAgICAgICBvbkZpbGVzU2VsZWN0OiBoYW5kbGVGaWxlc1NlbGVjdCxcbiAgICAgICAgICBkaXNhYmxlZDogbG9hZGluZ1NlbmRNZXNzYWdlXG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICAoY29uZmlnID09IG51bGwgPyB2b2lkIDAgOiBjb25maWcuYWN0aXZlVm9pY2UpICYmIC8qIEBfX1BVUkVfXyAqLyBqc3g5KFxuICAgICAgICBWb2ljZVJlY29yZGVyLFxuICAgICAgICB7XG4gICAgICAgICAgb25SZWNvcmRpbmdDb21wbGV0ZTogaGFuZGxlVm9pY2VSZWNvcmRpbmcsXG4gICAgICAgICAgZGlzYWJsZWQ6IGxvYWRpbmdTZW5kTWVzc2FnZVxuICAgICAgICB9XG4gICAgICApLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeDkoXG4gICAgICAgIFN0eWxlZElucHV0LFxuICAgICAgICB7XG4gICAgICAgICAgaW5wdXRQcm9wczogeyByZWY6IGlucHV0UmVmIH0sXG4gICAgICAgICAgZGlzYWJsZWQ6IGxvYWRpbmdTZW5kTWVzc2FnZSxcbiAgICAgICAgICBmdWxsV2lkdGg6IHRydWUsXG4gICAgICAgICAgcGxhY2Vob2xkZXI6IFwiXFx4Qzljcml2ZXogdW4gbWVzc2FnZS4uLlwiLFxuICAgICAgICAgIHZhbHVlOiBtZXNzYWdlLFxuICAgICAgICAgIG9uQ2hhbmdlOiBoYW5kbGVNZXNzYWdlQ2hhbmdlLFxuICAgICAgICAgIG9uRm9jdXM6IGhhbmRsZUZvY3VzLFxuICAgICAgICAgIG9uQmx1cjogaGFuZGxlQmx1cixcbiAgICAgICAgICBvbktleURvd246IGhhbmRsZUtleVByZXNzLFxuICAgICAgICAgIG11bHRpbGluZTogdHJ1ZSxcbiAgICAgICAgICBhdXRvRm9jdXM6IHRydWUsXG4gICAgICAgICAgbWF4Um93czogNFxuICAgICAgICB9XG4gICAgICApLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeDkoXG4gICAgICAgIEJ1dHRvbjMsXG4gICAgICAgIHtcbiAgICAgICAgICBsb2FkaW5nOiBsb2FkaW5nU2VuZE1lc3NhZ2UsXG4gICAgICAgICAgc2l6ZTogXCJzbWFsbFwiLFxuICAgICAgICAgIG9uQ2xpY2s6IGhhbmRsZVNlbmQsXG4gICAgICAgICAgY29sb3I6IFwicHJpbWFyeVwiLFxuICAgICAgICAgIHN4OiB7XG4gICAgICAgICAgICBtaW5XaWR0aDogeyB4czogXCIzNnB4XCIsIHNtOiBcIjQ4cHhcIiB9LFxuICAgICAgICAgICAgaGVpZ2h0OiB7IHhzOiBcIjM2cHhcIiwgc206IFwiNDhweFwiIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4OShTZW5kSWNvbiwgeyBmb250U2l6ZTogXCJzbWFsbFwiIH0pXG4gICAgICAgIH1cbiAgICAgIClcbiAgICBdIH0pXG4gIF0gfSk7XG59XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvTWVzc2FnZUxpc3QvaW5kZXgudHN4XG5pbXBvcnQgXCJtb21lbnQvbG9jYWxlL2ZyXCI7XG5pbXBvcnQgeyBCb3ggYXMgQm94MTksIENpcmN1bGFyUHJvZ3Jlc3MgYXMgQ2lyY3VsYXJQcm9ncmVzczMsIFR5cG9ncmFwaHkgYXMgVHlwb2dyYXBoeTggfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VMaXN0L3N0eWxlcy50c1xuaW1wb3J0IHsgQm94IGFzIEJveDEwLCBEaWFsb2csIExpbmssIFR5cG9ncmFwaHkgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDUgfSBmcm9tIFwiQG11aS9tYXRlcmlhbC9zdHlsZXNcIjtcbnZhciBNZXNzYWdlQ29udGFpbmVyID0gc3R5bGVkNShCb3gxMCkoKHsgdGhlbWUgfSkgPT4gKHtcbiAgZGlzcGxheTogXCJmbGV4XCIsXG4gIGZsZXhEaXJlY3Rpb246IFwiY29sdW1uXCIsXG4gIGdhcDogdGhlbWUuc3BhY2luZygxKSxcbiAgd2lkdGg6IFwiMTAwJVwiLFxuICBvdmVyZmxvd1g6IFwiaGlkZGVuXCIsXG4gIG92ZXJmbG93WTogXCJhdXRvXCIsXG4gIFwiJi5sb2FkaW5nXCI6IHtcbiAgICBvdmVyZmxvdzogXCJoaWRkZW5cIlxuICB9XG59KSk7XG52YXIgTWVzc2FnZVRpbWUgPSBzdHlsZWQ1KFR5cG9ncmFwaHkpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGZvbnRTaXplOiBcIjAuN3JlbVwiLFxuICBjb2xvcjogdGhlbWUucGFsZXR0ZS50ZXh0LnNlY29uZGFyeSxcbiAgbWFyZ2luVG9wOiB0aGVtZS5zcGFjaW5nKDAuNSksXG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBnYXA6IHRoZW1lLnNwYWNpbmcoMSksXG4gIGFsaWduSXRlbXM6IFwiY2VudGVyXCJcbn0pKTtcbnZhciBNZXNzYWdlR3JvdXAgPSBzdHlsZWQ1KEJveDEwKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgZmxleERpcmVjdGlvbjogXCJjb2x1bW5cIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDAuNSksXG4gIG1hcmdpbkJvdHRvbTogdGhlbWUuc3BhY2luZygyKSxcbiAgd2lkdGg6IFwiMTAwJVwiLFxuICBvdmVyZmxvdzogXCJoaWRkZW5cIlxufSkpO1xudmFyIFN5c3RlbU1lc3NhZ2UgPSBzdHlsZWQ1KEJveDEwKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAganVzdGlmeUNvbnRlbnQ6IFwiY2VudGVyXCIsXG4gIHdpZHRoOiBcIjEwMCVcIixcbiAgbWFyZ2luOiB0aGVtZS5zcGFjaW5nKDIsIDApLFxuICBcIiY6OmJlZm9yZSwgJjo6YWZ0ZXJcIjoge1xuICAgIGNvbnRlbnQ6ICdcIlwiJyxcbiAgICBmbGV4OiAxLFxuICAgIGhlaWdodDogXCIxcHhcIixcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLnBhbGV0dGUuZGl2aWRlcixcbiAgICBtYXJnaW46IHRoZW1lLnNwYWNpbmcoMCwgMiksXG4gICAgb3BhY2l0eTogMC41XG4gIH1cbn0pKTtcbnZhciBNZXNzYWdlQ29udGVudCA9IHN0eWxlZDUoQm94MTApKCh7IHRoZW1lIH0pID0+ICh7XG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBnYXA6IHRoZW1lLnNwYWNpbmcoMSksXG4gIGFsaWduSXRlbXM6IFwiZmxleC1zdGFydFwiLFxuICB3aWR0aDogXCIxMDAlXCIsXG4gIG92ZXJmbG93OiBcImhpZGRlblwiXG59KSk7XG52YXIgQXVkaW9Db250YWluZXIgPSBzdHlsZWQ1KEJveDEwKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDEpLFxuICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDEuNSksXG4gIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLmRlZmF1bHQsXG4gIGJvcmRlclJhZGl1czogdGhlbWUuc2hhcGUuYm9yZGVyUmFkaXVzLFxuICB3aWR0aDogXCIxMDAlXCIsXG4gIG92ZXJmbG93OiBcImhpZGRlblwiLFxuICBib3hTaXppbmc6IFwiYm9yZGVyLWJveFwiXG59KSk7XG52YXIgQXVkaW9Qcm9ncmVzcyA9IHN0eWxlZDUoQm94MTApKCh7IHRoZW1lIH0pID0+ICh7XG4gIGZsZXg6IDEsXG4gIGhlaWdodDogNixcbiAgYmFja2dyb3VuZENvbG9yOiB0aGVtZS5wYWxldHRlLmdyZXlbMzAwXSxcbiAgYm9yZGVyUmFkaXVzOiAzLFxuICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiLFxuICBvdmVyZmxvdzogXCJoaWRkZW5cIixcbiAgbWluV2lkdGg6IDBcbn0pKTtcbnZhciBBdWRpb1Byb2dyZXNzQmFyID0gc3R5bGVkNShCb3gxMCkoXG4gICh7IHRoZW1lLCBwcm9ncmVzcyB9KSA9PiAoe1xuICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgbGVmdDogMCxcbiAgICB0b3A6IDAsXG4gICAgaGVpZ2h0OiBcIjEwMCVcIixcbiAgICB3aWR0aDogYCR7cHJvZ3Jlc3N9JWAsXG4gICAgYmFja2dyb3VuZENvbG9yOiB0aGVtZS5wYWxldHRlLnByaW1hcnkubWFpbixcbiAgICB0cmFuc2l0aW9uOiBcIndpZHRoIDAuMXMgbGluZWFyXCJcbiAgfSlcbik7XG52YXIgSW1hZ2VDb250YWluZXIgPSBzdHlsZWQ1KEJveDEwKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiLFxuICB3aWR0aDogXCIxMDAlXCIsXG4gIG1heEhlaWdodDogXCIzMDBweFwiLFxuICBib3JkZXJSYWRpdXM6IHRoZW1lLnNoYXBlLmJvcmRlclJhZGl1cyxcbiAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gIFwiJjpob3ZlclwiOiB7XG4gICAgXCImIC5pbWFnZS1vdmVybGF5XCI6IHtcbiAgICAgIG9wYWNpdHk6IDFcbiAgICB9XG4gIH1cbn0pKTtcbnZhciBTdHlsZWRJbWFnZSA9IHN0eWxlZDUoXCJpbWdcIikoe1xuICB3aWR0aDogXCIxMDAlXCIsXG4gIGhlaWdodDogXCIxMDAlXCIsXG4gIG9iamVjdEZpdDogXCJjb3ZlclwiXG59KTtcbnZhciBJbWFnZU92ZXJsYXkgPSBzdHlsZWQ1KEJveDEwKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICB0b3A6IDAsXG4gIGxlZnQ6IDAsXG4gIHJpZ2h0OiAwLFxuICBib3R0b206IDAsXG4gIGJhY2tncm91bmRDb2xvcjogXCJyZ2JhKDAsIDAsIDAsIDAuMylcIixcbiAgZGlzcGxheTogXCJmbGV4XCIsXG4gIGFsaWduSXRlbXM6IFwiY2VudGVyXCIsXG4gIGp1c3RpZnlDb250ZW50OiBcImNlbnRlclwiLFxuICBvcGFjaXR5OiAwLFxuICB0cmFuc2l0aW9uOiBcIm9wYWNpdHkgMC4ycyBlYXNlLWluLW91dFwiXG59KSk7XG52YXIgU3R5bGVkRGlhbG9nID0gc3R5bGVkNShEaWFsb2cpKCh7IHRoZW1lIH0pID0+ICh7XG4gIFwiJiAuTXVpRGlhbG9nLXBhcGVyXCI6IHtcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgwLCAwLCAwLCAwLjkpXCIsXG4gICAgbWF4V2lkdGg6IFwiMTAwdndcIixcbiAgICBtYXhIZWlnaHQ6IFwiMTAwdmhcIixcbiAgICBtYXJnaW46IDAsXG4gICAgYm9yZGVyUmFkaXVzOiAwLFxuICAgIG92ZXJmbG93OiBcImhpZGRlblwiXG4gIH0sXG4gIFwiJiAuTXVpRGlhbG9nLWNvbnRhaW5lclwiOiB7XG4gICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCJcbiAgfSxcbiAgXCImIC5NdWlCYWNrZHJvcC1yb290XCI6IHtcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgwLCAwLCAwLCAwLjkpXCJcbiAgfVxufSkpO1xudmFyIFZpZXdlckltYWdlQ29udGFpbmVyID0gc3R5bGVkNShCb3gxMCkoKHsgdGhlbWUgfSkgPT4gKHtcbiAgcG9zaXRpb246IFwicmVsYXRpdmVcIixcbiAgd2lkdGg6IFwiMTAwJVwiLFxuICBoZWlnaHQ6IFwiMTAwJVwiLFxuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAganVzdGlmeUNvbnRlbnQ6IFwiY2VudGVyXCIsXG4gIHBhZGRpbmc6IHRoZW1lLnNwYWNpbmcoMiksXG4gIG92ZXJmbG93OiBcImhpZGRlblwiXG59KSk7XG52YXIgVmlld2VySW1hZ2UgPSBzdHlsZWQ1KFwiaW1nXCIpKFxuICAoeyBzY2FsZSB9KSA9PiAoe1xuICAgIG1heFdpZHRoOiBcIjEwMCVcIixcbiAgICBtYXhIZWlnaHQ6IFwiMTAwJVwiLFxuICAgIG9iamVjdEZpdDogXCJjb250YWluXCIsXG4gICAgdHJhbnNmb3JtOiBgc2NhbGUoJHtzY2FsZX0pYCxcbiAgICB0cmFuc2l0aW9uOiBcInRyYW5zZm9ybSAwLjJzIGVhc2UtaW4tb3V0XCJcbiAgfSlcbik7XG52YXIgQ29udHJvbHNDb250YWluZXIgPSBzdHlsZWQ1KEJveDEwKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICB0b3A6IHRoZW1lLnNwYWNpbmcoMiksXG4gIGxlZnQ6IFwiNTAlXCIsXG4gIHRyYW5zZm9ybTogXCJ0cmFuc2xhdGVYKC01MCUpXCIsXG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBnYXA6IHRoZW1lLnNwYWNpbmcoMSksXG4gIHpJbmRleDogMSxcbiAgYmFja2dyb3VuZENvbG9yOiBcInJnYmEoMCwgMCwgMCwgMC41KVwiLFxuICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDEpLFxuICBib3JkZXJSYWRpdXM6IHRoZW1lLnNoYXBlLmJvcmRlclJhZGl1c1xufSkpO1xudmFyIEZpbGVDb250YWluZXIgPSBzdHlsZWQ1KEJveDEwKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgZmxleERpcmVjdGlvbjogXCJjb2x1bW5cIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDEpLFxuICBtYXJnaW5Ub3A6IHRoZW1lLnNwYWNpbmcoMSksXG4gIHBhZGRpbmc6IHRoZW1lLnNwYWNpbmcoMSksXG4gIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLmRlZmF1bHQsXG4gIGJvcmRlclJhZGl1czogdGhlbWUuc2hhcGUuYm9yZGVyUmFkaXVzLFxuICBib3JkZXI6IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLmRpdmlkZXJ9YFxufSkpO1xudmFyIEZpbGVMaW5rID0gc3R5bGVkNShMaW5rKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDEpLFxuICBjb2xvcjogdGhlbWUucGFsZXR0ZS50ZXh0LnByaW1hcnksXG4gIHRleHREZWNvcmF0aW9uOiBcIm5vbmVcIixcbiAgcGFkZGluZzogdGhlbWUuc3BhY2luZygxKSxcbiAgYm9yZGVyUmFkaXVzOiB0aGVtZS5zaGFwZS5ib3JkZXJSYWRpdXMsXG4gIHRyYW5zaXRpb246IFwiYWxsIDAuMnMgZWFzZS1pbi1vdXRcIixcbiAgXCImOmhvdmVyXCI6IHtcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLnBhbGV0dGUuYWN0aW9uLmhvdmVyLFxuICAgIHRleHREZWNvcmF0aW9uOiBcIm5vbmVcIlxuICB9XG59KSk7XG52YXIgRmlsZU5hbWUgPSBzdHlsZWQ1KFR5cG9ncmFwaHkpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGZvbnRTaXplOiBcIjAuODVyZW1cIixcbiAgZm9udFdlaWdodDogNTAwLFxuICBvdmVyZmxvdzogXCJoaWRkZW5cIixcbiAgdGV4dE92ZXJmbG93OiBcImVsbGlwc2lzXCIsXG4gIHdoaXRlU3BhY2U6IFwibm93cmFwXCIsXG4gIG1heFdpZHRoOiBcIjIwMHB4XCJcbn0pKTtcbnZhciBJY29uV3JhcHBlciA9IHN0eWxlZDUoXCJkaXZcIikoKHsgdGhlbWUgfSkgPT4gKHtcbiAgZGlzcGxheTogXCJmbGV4XCIsXG4gIGFsaWduSXRlbXM6IFwiY2VudGVyXCIsXG4gIGp1c3RpZnlDb250ZW50OiBcImNlbnRlclwiLFxuICB3aWR0aDogXCIyNHB4XCIsXG4gIGhlaWdodDogXCIyNHB4XCJcbn0pKTtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXQvY29tcG9uZW50cy9NZXNzYWdlQnViYmxlL2luZGV4LnRzeFxuaW1wb3J0IHsgQm94IGFzIEJveDE2LCBMaW5rIGFzIExpbms0LCBUeXBvZ3JhcGh5IGFzIFR5cG9ncmFwaHk2IH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXQvY29tcG9uZW50cy9NZXNzYWdlQnViYmxlL3N0eWxlLnRzXG5pbXBvcnQgeyBCb3ggYXMgQm94MTEgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDYgfSBmcm9tIFwiQG11aS9tYXRlcmlhbC9zdHlsZXNcIjtcbnZhciBTdHlsZWRNZXNzYWdlQnViYmxlID0gc3R5bGVkNihCb3gxMSwge1xuICBzaG91bGRGb3J3YXJkUHJvcDogKHByb3ApID0+IHByb3AgIT09IFwiaXNDdXJyZW50VXNlclwiICYmIHByb3AgIT09IFwidXNlckNvbG9yXCIgJiYgcHJvcCAhPT0gXCJoYXNTcGVjaWFsQ29udGVudFwiICYmIHByb3AgIT09IFwiaGFzQXVkaW9cIlxufSkoXG4gICh7XG4gICAgdGhlbWUsXG4gICAgaXNDdXJyZW50VXNlcixcbiAgICB1c2VyQ29sb3IsXG4gICAgaGFzU3BlY2lhbENvbnRlbnQgPSBmYWxzZSxcbiAgICBoYXNBdWRpbyA9IGZhbHNlXG4gIH0pID0+ICh7XG4gICAgcG9zaXRpb246IFwicmVsYXRpdmVcIixcbiAgICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDEuNSwgMiksXG4gICAgYm9yZGVyUmFkaXVzOiBpc0N1cnJlbnRVc2VyID8gYCR7dGhlbWUuc3BhY2luZygyKX0gMCAke3RoZW1lLnNwYWNpbmcoMil9ICR7dGhlbWUuc3BhY2luZygyKX1gIDogYDAgJHt0aGVtZS5zcGFjaW5nKDIpfSAke3RoZW1lLnNwYWNpbmcoMil9ICR7dGhlbWUuc3BhY2luZygyKX1gLFxuICAgIHdpZHRoOiBoYXNBdWRpbyA/IFwiY2FsYygxMDAlIC0gNDhweClcIiA6IFwiZml0LWNvbnRlbnRcIixcbiAgICBtYXhXaWR0aDogaGFzQXVkaW8gPyBcImNhbGMoMTAwJSAtIDQ4cHgpXCIgOiBcIjcwJVwiLFxuICAgIHdvcmRCcmVhazogXCJicmVhay13b3JkXCIsXG4gICAgbWFyZ2luQm90dG9tOiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgIGFsaWduU2VsZjogaXNDdXJyZW50VXNlciA/IFwiZmxleC1lbmRcIiA6IFwiZmxleC1zdGFydFwiLFxuICAgIGJhY2tncm91bmRDb2xvcjogaXNDdXJyZW50VXNlciA/IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5tYWluIDogdXNlckNvbG9yIHx8IHRoZW1lLnBhbGV0dGUuZ3JleVsxMDBdLFxuICAgIGNvbG9yOiBpc0N1cnJlbnRVc2VyID8gdGhlbWUucGFsZXR0ZS5wcmltYXJ5LmNvbnRyYXN0VGV4dCA6IFwiaW5oZXJpdFwiLFxuICAgIHRleHRBbGlnbjogXCJsZWZ0XCIsXG4gICAgXCImOjphZnRlclwiOiB7XG4gICAgICBjb250ZW50OiAnXCJcIicsXG4gICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgICAgYm90dG9tOiAwLFxuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDAsXG4gICAgICBib3JkZXI6IFwiNnB4IHNvbGlkIHRyYW5zcGFyZW50XCIsXG4gICAgICBib3JkZXJCb3R0b206IDAsXG4gICAgICBbaXNDdXJyZW50VXNlciA/IFwicmlnaHRcIiA6IFwibGVmdFwiXTogMTIsXG4gICAgICBib3JkZXJUb3BDb2xvcjogaXNDdXJyZW50VXNlciA/IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5tYWluIDogdXNlckNvbG9yIHx8IHRoZW1lLnBhbGV0dGUuZ3JleVsxMDBdXG4gICAgfSxcbiAgICBbdGhlbWUuYnJlYWtwb2ludHMudXAoXCJzbVwiKV06IHtcbiAgICAgIHdpZHRoOiBoYXNBdWRpbyA/IFwiNzAlXCIgOiBcImZpdC1jb250ZW50XCIsXG4gICAgICBtYXhXaWR0aDogXCI3MCVcIlxuICAgIH1cbiAgfSlcbik7XG52YXIgTGlua0NvbnRhaW5lciA9IHN0eWxlZDYoQm94MTEpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGRpc3BsYXk6IFwiaW5saW5lLWZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDAuNSksXG4gIFwiJiAuTXVpU3ZnSWNvbi1yb290XCI6IHtcbiAgICBmb250U2l6ZTogXCIwLjllbVwiLFxuICAgIGN1cnNvcjogXCJwb2ludGVyXCJcbiAgfVxufSkpO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VCdWJibGUvaW5kZXgudHN4XG5pbXBvcnQgTGlua0ljb24gZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvTGlua1wiO1xuXG4vLyBzcmMvY2xpZW50L3V0aWxzL2ZpbGVVdGlscy50c1xudmFyIGlzSW1hZ2UgPSAoZmlsZU5hbWUpID0+IHtcbiAgY29uc3QgaW1hZ2VFeHRlbnNpb25zID0gW1wiLmpwZ1wiLCBcIi5qcGVnXCIsIFwiLnBuZ1wiLCBcIi5naWZcIiwgXCIud2VicFwiXTtcbiAgcmV0dXJuIGltYWdlRXh0ZW5zaW9ucy5zb21lKChleHQpID0+IGZpbGVOYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoZXh0KSk7XG59O1xudmFyIGlzQXVkaW8gPSAoZmlsZU5hbWUpID0+IHtcbiAgY29uc3QgYXVkaW9FeHRlbnNpb25zID0gW1wiLm1wM1wiLCBcIi53YXZcIiwgXCIub2dnXCIsIFwiLndlYm1cIl07XG4gIHJldHVybiBhdWRpb0V4dGVuc2lvbnMuc29tZSgoZXh0KSA9PiBmaWxlTmFtZS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKGV4dCkpO1xufTtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXQvY29tcG9uZW50cy9NZXNzYWdlTGlzdC9BdWRpb01lc3NhZ2UudHN4XG5pbXBvcnQgeyBCb3ggYXMgQm94MTIsIEljb25CdXR0b24gYXMgSWNvbkJ1dHRvbjQsIFR5cG9ncmFwaHkgYXMgVHlwb2dyYXBoeTMgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgdXNlUmVmIGFzIHVzZVJlZjgsIHVzZVN0YXRlIGFzIHVzZVN0YXRlNyB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFBhdXNlSWNvbiBmcm9tIFwiQG11aS9pY29ucy1tYXRlcmlhbC9QYXVzZVwiO1xuaW1wb3J0IFBsYXlBcnJvd0ljb24gZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvUGxheUFycm93XCI7XG5pbXBvcnQgeyBqc3ggYXMganN4MTAsIGpzeHMgYXMganN4czUgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBmb3JtYXRUaW1lID0gKHNlY29uZHMpID0+IHtcbiAgaWYgKCFpc0Zpbml0ZShzZWNvbmRzKSB8fCBpc05hTihzZWNvbmRzKSkge1xuICAgIHJldHVybiBcIjA6MDBcIjtcbiAgfVxuICBjb25zdCBtaW5zID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gNjApO1xuICBjb25zdCBzZWNzID0gTWF0aC5mbG9vcihzZWNvbmRzICUgNjApO1xuICByZXR1cm4gYCR7bWluc306JHtzZWNzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfWA7XG59O1xudmFyIEF1ZGlvTWVzc2FnZSA9ICh7IHVybCB9KSA9PiB7XG4gIGNvbnN0IFtpc1BsYXlpbmcsIHNldElzUGxheWluZ10gPSB1c2VTdGF0ZTcoZmFsc2UpO1xuICBjb25zdCBbY3VycmVudFRpbWUsIHNldEN1cnJlbnRUaW1lXSA9IHVzZVN0YXRlNygwKTtcbiAgY29uc3QgW2R1cmF0aW9uLCBzZXREdXJhdGlvbl0gPSB1c2VTdGF0ZTcoMCk7XG4gIGNvbnN0IGF1ZGlvUmVmID0gdXNlUmVmOChudWxsKTtcbiAgY29uc3QgaGFuZGxlUGxheVBhdXNlID0gKCkgPT4ge1xuICAgIHZhciBfYSwgX2I7XG4gICAgaWYgKCFhdWRpb1JlZi5jdXJyZW50KSB7XG4gICAgICBhdWRpb1JlZi5jdXJyZW50ID0gbmV3IEF1ZGlvKHVybCk7XG4gICAgICBhdWRpb1JlZi5jdXJyZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCAoZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGRlIGNoYXJnZW1lbnQgYXVkaW86XCIsIGUpO1xuICAgICAgfSk7XG4gICAgICBhdWRpb1JlZi5jdXJyZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkdXJhdGlvbmNoYW5nZVwiLCAoKSA9PiB7XG4gICAgICAgIGlmIChhdWRpb1JlZi5jdXJyZW50ICYmIGlzRmluaXRlKGF1ZGlvUmVmLmN1cnJlbnQuZHVyYXRpb24pICYmIGF1ZGlvUmVmLmN1cnJlbnQuZHVyYXRpb24gPiAwKSB7XG4gICAgICAgICAgc2V0RHVyYXRpb24oYXVkaW9SZWYuY3VycmVudC5kdXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgYXVkaW9SZWYuY3VycmVudC5hZGRFdmVudExpc3RlbmVyKFwicHJvZ3Jlc3NcIiwgKCkgPT4ge1xuICAgICAgICBpZiAoYXVkaW9SZWYuY3VycmVudCAmJiBpc0Zpbml0ZShhdWRpb1JlZi5jdXJyZW50LmR1cmF0aW9uKSAmJiBhdWRpb1JlZi5jdXJyZW50LmR1cmF0aW9uID4gMCkge1xuICAgICAgICAgIHNldER1cmF0aW9uKGF1ZGlvUmVmLmN1cnJlbnQuZHVyYXRpb24pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGF1ZGlvUmVmLmN1cnJlbnQubG9hZCgpO1xuICAgICAgYXVkaW9SZWYuY3VycmVudC5hZGRFdmVudExpc3RlbmVyKFwidGltZXVwZGF0ZVwiLCAoKSA9PiB7XG4gICAgICAgIGlmIChhdWRpb1JlZi5jdXJyZW50KSB7XG4gICAgICAgICAgc2V0Q3VycmVudFRpbWUoYXVkaW9SZWYuY3VycmVudC5jdXJyZW50VGltZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgYXVkaW9SZWYuY3VycmVudC5hZGRFdmVudExpc3RlbmVyKFwiZW5kZWRcIiwgKCkgPT4ge1xuICAgICAgICBzZXRJc1BsYXlpbmcoZmFsc2UpO1xuICAgICAgICBzZXRDdXJyZW50VGltZSgwKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaXNQbGF5aW5nKSB7XG4gICAgICAoX2EgPSBhdWRpb1JlZi5jdXJyZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EucGF1c2UoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgKF9iID0gYXVkaW9SZWYuY3VycmVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLnBsYXkoKTtcbiAgICB9XG4gICAgc2V0SXNQbGF5aW5nKCFpc1BsYXlpbmcpO1xuICB9O1xuICBjb25zdCBwcm9ncmVzcyA9IGR1cmF0aW9uID4gMCA/IGN1cnJlbnRUaW1lIC8gZHVyYXRpb24gKiAxMDAgOiAwO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHM1KEF1ZGlvQ29udGFpbmVyLCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeDEwKFxuICAgICAgSWNvbkJ1dHRvbjQsXG4gICAgICB7XG4gICAgICAgIHNpemU6IFwibWVkaXVtXCIsXG4gICAgICAgIG9uQ2xpY2s6IGhhbmRsZVBsYXlQYXVzZSxcbiAgICAgICAgc3g6IHtcbiAgICAgICAgICBjb2xvcjogXCJwcmltYXJ5Lm1haW5cIixcbiAgICAgICAgICBcIiY6aG92ZXJcIjoge1xuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBcImFjdGlvbi5ob3ZlclwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBmbGV4U2hyaW5rOiAwLFxuICAgICAgICAgIHdpZHRoOiB7IHhzOiAzNiwgc206IDQwIH0sXG4gICAgICAgICAgaGVpZ2h0OiB7IHhzOiAzNiwgc206IDQwIH1cbiAgICAgICAgfSxcbiAgICAgICAgY2hpbGRyZW46IGlzUGxheWluZyA/IC8qIEBfX1BVUkVfXyAqLyBqc3gxMChQYXVzZUljb24sIHt9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3gxMChQbGF5QXJyb3dJY29uLCB7fSlcbiAgICAgIH1cbiAgICApLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzNShCb3gxMiwgeyBzeDogeyBmbGV4OiAxLCBtaW5XaWR0aDogMCwgcHI6IDEsIG92ZXJmbG93OiBcImhpZGRlblwiIH0sIGNoaWxkcmVuOiBbXG4gICAgICAvKiBAX19QVVJFX18gKi8ganN4MTAoQXVkaW9Qcm9ncmVzcywgeyBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDEwKEF1ZGlvUHJvZ3Jlc3NCYXIsIHsgcHJvZ3Jlc3MgfSkgfSksXG4gICAgICAvKiBAX19QVVJFX18gKi8ganN4czUoXG4gICAgICAgIEJveDEyLFxuICAgICAgICB7XG4gICAgICAgICAgc3g6IHtcbiAgICAgICAgICAgIGRpc3BsYXk6IFwiZmxleFwiLFxuICAgICAgICAgICAganVzdGlmeUNvbnRlbnQ6IFwic3BhY2UtYmV0d2VlblwiLFxuICAgICAgICAgICAgbXQ6IDEsXG4gICAgICAgICAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgICAgICAgICBnYXA6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MTAoXG4gICAgICAgICAgICAgIFR5cG9ncmFwaHkzLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyaWFudDogXCJjYXB0aW9uXCIsXG4gICAgICAgICAgICAgICAgY29sb3I6IFwidGV4dC5zZWNvbmRhcnlcIixcbiAgICAgICAgICAgICAgICBzeDoge1xuICAgICAgICAgICAgICAgICAgZm9udFNpemU6IHsgeHM6IFwiMC43cmVtXCIsIHNtOiBcIjAuOHJlbVwiIH0sXG4gICAgICAgICAgICAgICAgICBtaW5XaWR0aDogeyB4czogXCIzMHB4XCIsIHNtOiBcIjQwcHhcIiB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogZm9ybWF0VGltZShjdXJyZW50VGltZSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gxMChcbiAgICAgICAgICAgICAgVHlwb2dyYXBoeTMsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXJpYW50OiBcImNhcHRpb25cIixcbiAgICAgICAgICAgICAgICBjb2xvcjogXCJ0ZXh0LnNlY29uZGFyeVwiLFxuICAgICAgICAgICAgICAgIHN4OiB7XG4gICAgICAgICAgICAgICAgICBmb250U2l6ZTogeyB4czogXCIwLjdyZW1cIiwgc206IFwiMC44cmVtXCIgfSxcbiAgICAgICAgICAgICAgICAgIG1pbldpZHRoOiB7IHhzOiBcIjMwcHhcIiwgc206IFwiNDBweFwiIH0sXG4gICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IFwicmlnaHRcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IGZvcm1hdFRpbWUoZHVyYXRpb24pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICAgIClcbiAgICBdIH0pXG4gIF0gfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VMaXN0L0ltYWdlRmlsZS50c3hcbmltcG9ydCB7IFR5cG9ncmFwaHkgYXMgVHlwb2dyYXBoeTQgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VMaXN0L0ltYWdlVmlld2VyLnRzeFxuaW1wb3J0IHsgSWNvbkJ1dHRvbiBhcyBJY29uQnV0dG9uNSwgVG9vbHRpcCB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgQ2xvc2VJY29uIGZyb20gXCJAbXVpL2ljb25zLW1hdGVyaWFsL0Nsb3NlXCI7XG5pbXBvcnQgRG93bmxvYWRJY29uIGZyb20gXCJAbXVpL2ljb25zLW1hdGVyaWFsL0Rvd25sb2FkXCI7XG5pbXBvcnQgUmVhY3Q0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFpvb21Jbkljb24gZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvWm9vbUluXCI7XG5pbXBvcnQgWm9vbU91dEljb24gZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvWm9vbU91dFwiO1xuaW1wb3J0IHsganN4IGFzIGpzeDExLCBqc3hzIGFzIGpzeHM2IH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG52YXIgSW1hZ2VWaWV3ZXIgPSAoe1xuICBvcGVuLFxuICBvbkNsb3NlLFxuICBpbWFnZVVybCxcbiAgaW1hZ2VOYW1lXG59KSA9PiB7XG4gIGNvbnN0IFtzY2FsZSwgc2V0U2NhbGVdID0gUmVhY3Q0LnVzZVN0YXRlKDEpO1xuICBjb25zdCBoYW5kbGVab29tSW4gPSAoKSA9PiB7XG4gICAgc2V0U2NhbGUoKHByZXYpID0+IE1hdGgubWluKHByZXYgKyAwLjI1LCAzKSk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZVpvb21PdXQgPSAoKSA9PiB7XG4gICAgc2V0U2NhbGUoKHByZXYpID0+IE1hdGgubWF4KHByZXYgLSAwLjI1LCAwLjUpKTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlQ2xvc2UgPSAoKSA9PiB7XG4gICAgc2V0U2NhbGUoMSk7XG4gICAgb25DbG9zZSgpO1xuICB9O1xuICBjb25zdCBoYW5kbGVEb3dubG9hZCA9ICgpID0+IHtcbiAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XG4gICAgbGluay5ocmVmID0gaW1hZ2VVcmw7XG4gICAgbGluay5kb3dubG9hZCA9IGltYWdlTmFtZTtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspO1xuICAgIGxpbmsuY2xpY2soKTtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xuICB9O1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeDExKFxuICAgIFN0eWxlZERpYWxvZyxcbiAgICB7XG4gICAgICBvcGVuLFxuICAgICAgb25DbG9zZTogaGFuZGxlQ2xvc2UsXG4gICAgICBmdWxsU2NyZWVuOiB0cnVlLFxuICAgICAgb25DbGljazogaGFuZGxlQ2xvc2UsXG4gICAgICBkaXNhYmxlRW5mb3JjZUZvY3VzOiB0cnVlLFxuICAgICAgZGlzYWJsZUF1dG9Gb2N1czogdHJ1ZSxcbiAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4czYoVmlld2VySW1hZ2VDb250YWluZXIsIHsgb25DbGljazogKGUpID0+IGUuc3RvcFByb3BhZ2F0aW9uKCksIGNoaWxkcmVuOiBbXG4gICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzNihDb250cm9sc0NvbnRhaW5lciwgeyBjaGlsZHJlbjogW1xuICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gxMShUb29sdGlwLCB7IHRpdGxlOiBcIlpvb20gYXZhbnRcIiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxMShJY29uQnV0dG9uNSwgeyBvbkNsaWNrOiBoYW5kbGVab29tSW4sIHN4OiB7IGNvbG9yOiBcIndoaXRlXCIgfSwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxMShab29tSW5JY29uLCB7fSkgfSkgfSksXG4gICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeDExKFRvb2x0aXAsIHsgdGl0bGU6IFwiWm9vbSBhcnJpXFx4RThyZVwiLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDExKEljb25CdXR0b241LCB7IG9uQ2xpY2s6IGhhbmRsZVpvb21PdXQsIHN4OiB7IGNvbG9yOiBcIndoaXRlXCIgfSwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxMShab29tT3V0SWNvbiwge30pIH0pIH0pLFxuICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gxMShUb29sdGlwLCB7IHRpdGxlOiBcIlRcXHhFOWxcXHhFOWNoYXJnZXJcIiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxMShJY29uQnV0dG9uNSwgeyBvbkNsaWNrOiBoYW5kbGVEb3dubG9hZCwgc3g6IHsgY29sb3I6IFwid2hpdGVcIiB9LCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDExKERvd25sb2FkSWNvbiwge30pIH0pIH0pLFxuICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gxMShUb29sdGlwLCB7IHRpdGxlOiBcIkZlcm1lclwiLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDExKEljb25CdXR0b241LCB7IG9uQ2xpY2s6IGhhbmRsZUNsb3NlLCBzeDogeyBjb2xvcjogXCJ3aGl0ZVwiIH0sIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4MTEoQ2xvc2VJY29uLCB7fSkgfSkgfSlcbiAgICAgICAgXSB9KSxcbiAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeDExKFxuICAgICAgICAgIFZpZXdlckltYWdlLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHNyYzogaW1hZ2VVcmwsXG4gICAgICAgICAgICBhbHQ6IGltYWdlTmFtZSxcbiAgICAgICAgICAgIHNjYWxlLFxuICAgICAgICAgICAgb25DbGljazogKGUpID0+IGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgIF0gfSlcbiAgICB9XG4gICk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VMaXN0L0ltYWdlRmlsZS50c3hcbmltcG9ydCBSZWFjdDUgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBGcmFnbWVudCwganN4IGFzIGpzeDEyLCBqc3hzIGFzIGpzeHM3IH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG52YXIgSW1hZ2VGaWxlID0gKHsgdXJsLCBuYW1lLCBvbkxvYWQgfSkgPT4ge1xuICBjb25zdCBbaXNWaWV3ZXJPcGVuLCBzZXRJc1ZpZXdlck9wZW5dID0gUmVhY3Q1LnVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgaGFuZGxlQ2xpY2sgPSAoZSkgPT4ge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgc2V0SXNWaWV3ZXJPcGVuKHRydWUpO1xuICB9O1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHM3KEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeHM3KEltYWdlQ29udGFpbmVyLCB7IG9uQ2xpY2s6IGhhbmRsZUNsaWNrLCBjaGlsZHJlbjogW1xuICAgICAgLyogQF9fUFVSRV9fICovIGpzeDEyKFN0eWxlZEltYWdlLCB7IHNyYzogdXJsLCBhbHQ6IG5hbWUsIG9uTG9hZCB9KSxcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gxMihJbWFnZU92ZXJsYXksIHsgY2xhc3NOYW1lOiBcImltYWdlLW92ZXJsYXlcIiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxMihUeXBvZ3JhcGh5NCwgeyB2YXJpYW50OiBcImJvZHkyXCIsIGNvbG9yOiBcIndoaXRlXCIsIGNoaWxkcmVuOiBcIkNsaXF1ZXogcG91ciBhZ3JhbmRpclwiIH0pIH0pXG4gICAgXSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MTIoXG4gICAgICBJbWFnZVZpZXdlcixcbiAgICAgIHtcbiAgICAgICAgb3BlbjogaXNWaWV3ZXJPcGVuLFxuICAgICAgICBvbkNsb3NlOiAoKSA9PiBzZXRJc1ZpZXdlck9wZW4oZmFsc2UpLFxuICAgICAgICBpbWFnZVVybDogdXJsLFxuICAgICAgICBpbWFnZU5hbWU6IG5hbWVcbiAgICAgIH1cbiAgICApXG4gIF0gfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VMaXN0L1JlZ3VsYXJGaWxlLnRzeFxuaW1wb3J0IHsgQm94IGFzIEJveDE1IH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcbmltcG9ydCBJbnNlcnREcml2ZUZpbGVJY29uIGZyb20gXCJAbXVpL2ljb25zLW1hdGVyaWFsL0luc2VydERyaXZlRmlsZVwiO1xuaW1wb3J0IHsganN4IGFzIGpzeDEzLCBqc3hzIGFzIGpzeHM4IH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG52YXIgUmVndWxhckZpbGUgPSAoeyBuYW1lLCB1cmwgfSkgPT4ge1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHM4KEZpbGVDb250YWluZXIsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MTMoSWNvbldyYXBwZXIsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxMyhJbnNlcnREcml2ZUZpbGVJY29uLCB7fSkgfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeDEzKEJveDE1LCB7IHN4OiB7IGZsZXg6IDEsIG1pbldpZHRoOiAwIH0sIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4MTMoRmlsZUxpbmssIHsgaHJlZjogdXJsLCB0YXJnZXQ6IFwiX2JsYW5rXCIsIHJlbDogXCJub29wZW5lciBub3JlZmVycmVyXCIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4MTMoRmlsZU5hbWUsIHsgdmFyaWFudDogXCJib2R5MlwiLCBub1dyYXA6IHRydWUsIGNoaWxkcmVuOiBuYW1lIH0pIH0pIH0pXG4gIF0gfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VMaXN0L01lc3NhZ2VGaWxlcy50c3hcbmltcG9ydCB7IGpzeCBhcyBqc3gxNCB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xudmFyIE1lc3NhZ2VGaWxlcyA9ICh7XG4gIGF0dGFjaG1lbnRzLFxuICBvbkltYWdlTG9hZFxufSkgPT4ge1xuICBpZiAoIWF0dGFjaG1lbnRzIHx8IGF0dGFjaG1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4MTQoRmlsZUNvbnRhaW5lciwgeyBjaGlsZHJlbjogYXR0YWNobWVudHMubWFwKChhdHRhY2htZW50LCBpbmRleCkgPT4ge1xuICAgIGlmIChpc0ltYWdlKGF0dGFjaG1lbnQubmFtZSkpIHtcbiAgICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4MTQoXG4gICAgICAgIEltYWdlRmlsZSxcbiAgICAgICAge1xuICAgICAgICAgIHVybDogYXR0YWNobWVudC51cmwsXG4gICAgICAgICAgbmFtZTogYXR0YWNobWVudC5uYW1lLFxuICAgICAgICAgIG9uTG9hZDogb25JbWFnZUxvYWRcbiAgICAgICAgfSxcbiAgICAgICAgaW5kZXhcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChpc0F1ZGlvKGF0dGFjaG1lbnQubmFtZSkpIHtcbiAgICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4MTQoQXVkaW9NZXNzYWdlLCB7IHVybDogYXR0YWNobWVudC51cmwgfSwgaW5kZXgpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeDE0KFxuICAgICAgICBSZWd1bGFyRmlsZSxcbiAgICAgICAge1xuICAgICAgICAgIHVybDogYXR0YWNobWVudC51cmwsXG4gICAgICAgICAgbmFtZTogYXR0YWNobWVudC5uYW1lXG4gICAgICAgIH0sXG4gICAgICAgIGluZGV4XG4gICAgICApO1xuICAgIH1cbiAgfSkgfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL01lc3NhZ2VCdWJibGUvaW5kZXgudHN4XG5pbXBvcnQgUmVhY3Q2IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsganN4IGFzIGpzeDE1LCBqc3hzIGFzIGpzeHM5IH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG52YXIgZGV0ZWN0VXJscyA9ICh0ZXh0LCBpc0N1cnJlbnRVc2VyKSA9PiB7XG4gIGNvbnN0IHVybFJlZ2V4ID0gLyhodHRwcz86XFwvXFwvW15cXHNdKykvZztcbiAgY29uc3QgcGFydHMgPSB0ZXh0LnNwbGl0KHVybFJlZ2V4KTtcbiAgY29uc3QgbWF0Y2hlcyA9IEFycmF5LmZyb20odGV4dC5tYXRjaEFsbCh1cmxSZWdleCkpLm1hcCgobWF0Y2gpID0+IG1hdGNoWzBdKTtcbiAgcmV0dXJuIHBhcnRzLm1hcCgocGFydCwgaW5kZXgpID0+IHtcbiAgICBpZiAobWF0Y2hlcy5pbmNsdWRlcyhwYXJ0KSkge1xuICAgICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzOShMaW5rQ29udGFpbmVyLCB7IGNoaWxkcmVuOiBbXG4gICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gxNShcbiAgICAgICAgICBMaW5rNCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBocmVmOiBwYXJ0LFxuICAgICAgICAgICAgdGFyZ2V0OiBcIl9ibGFua1wiLFxuICAgICAgICAgICAgcmVsOiBcIm5vb3BlbmVyIG5vcmVmZXJyZXJcIixcbiAgICAgICAgICAgIHVuZGVybGluZTogXCJob3ZlclwiLFxuICAgICAgICAgICAgc3g6IHtcbiAgICAgICAgICAgICAgY29sb3I6IGlzQ3VycmVudFVzZXIgPyBcImluaGVyaXRcIiA6IFwicHJpbWFyeS5tYWluXCIsXG4gICAgICAgICAgICAgIFwiJjpob3ZlclwiOiB7XG4gICAgICAgICAgICAgICAgY29sb3I6IGlzQ3VycmVudFVzZXIgPyBcImluaGVyaXRcIiA6IFwicHJpbWFyeS5kYXJrXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBwYXJ0XG4gICAgICAgICAgfVxuICAgICAgICApLFxuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MTUoXG4gICAgICAgICAgTGlua0ljb24sXG4gICAgICAgICAge1xuICAgICAgICAgICAgb25DbGljazogKCkgPT4gd2luZG93Lm9wZW4ocGFydCwgXCJfYmxhbmtcIiwgXCJub29wZW5lcixub3JlZmVycmVyXCIpLFxuICAgICAgICAgICAgc3g6IHtcbiAgICAgICAgICAgICAgY29sb3I6IGlzQ3VycmVudFVzZXIgPyBcImluaGVyaXRcIiA6IFwicHJpbWFyeS5tYWluXCIsXG4gICAgICAgICAgICAgIG9wYWNpdHk6IDAuOCxcbiAgICAgICAgICAgICAgXCImOmhvdmVyXCI6IHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAxXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgIF0gfSwgaW5kZXgpO1xuICAgIH1cbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeDE1KFJlYWN0Ni5GcmFnbWVudCwgeyBjaGlsZHJlbjogcGFydCB9LCBpbmRleCk7XG4gIH0pO1xufTtcbnZhciBNZXNzYWdlQnViYmxlID0gKHtcbiAgaXNDdXJyZW50VXNlcixcbiAgdXNlckNvbG9yLFxuICBoYXNTcGVjaWFsQ29udGVudCxcbiAgaGFzQXVkaW8sXG4gIGNvbnRlbnQsXG4gIGF0dGFjaG1lbnRzLFxuICBvbkltYWdlTG9hZFxufSkgPT4ge1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeDE1KFxuICAgIFN0eWxlZE1lc3NhZ2VCdWJibGUsXG4gICAge1xuICAgICAgaXNDdXJyZW50VXNlcixcbiAgICAgIHVzZXJDb2xvcixcbiAgICAgIGhhc1NwZWNpYWxDb250ZW50LFxuICAgICAgaGFzQXVkaW8sXG4gICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeHM5KEJveDE2LCB7IGNvbXBvbmVudDogXCJkaXZcIiwgY2hpbGRyZW46IFtcbiAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeDE1KFxuICAgICAgICAgIFR5cG9ncmFwaHk2LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvbXBvbmVudDogXCJzcGFuXCIsXG4gICAgICAgICAgICB2YXJpYW50OiBcImJvZHkxXCIsXG4gICAgICAgICAgICBzeDogeyB3aGl0ZVNwYWNlOiBcInByZS13cmFwXCIgfSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBkZXRlY3RVcmxzKGNvbnRlbnQsIGlzQ3VycmVudFVzZXIpXG4gICAgICAgICAgfVxuICAgICAgICApLFxuICAgICAgICBhdHRhY2htZW50cyAmJiAvKiBAX19QVVJFX18gKi8ganN4MTUoTWVzc2FnZUZpbGVzLCB7IGF0dGFjaG1lbnRzLCBvbkltYWdlTG9hZCB9KVxuICAgICAgXSB9KVxuICAgIH1cbiAgKTtcbn07XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvTWVzc2FnZUxpc3QvaW5kZXgudHN4XG5pbXBvcnQgUmVhY3Q4IGZyb20gXCJyZWFjdFwiO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL1NlZW5CeS9pbmRleC50c3hcbmltcG9ydCB7IEJveCBhcyBCb3gxOCwgVG9vbHRpcCBhcyBUb29sdGlwMiwgVHlwb2dyYXBoeSBhcyBUeXBvZ3JhcGh5NyB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgQ2hlY2tDaXJjbGVJY29uIGZyb20gXCJAbXVpL2ljb25zLW1hdGVyaWFsL0NoZWNrQ2lyY2xlXCI7XG5pbXBvcnQgQ2hlY2tDaXJjbGVPdXRsaW5lSWNvbiBmcm9tIFwiQG11aS9pY29ucy1tYXRlcmlhbC9DaGVja0NpcmNsZU91dGxpbmVcIjtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXQvY29tcG9uZW50cy9TZWVuQnkvc3R5bGUudHNcbmltcG9ydCB7IEJveCBhcyBCb3gxNyB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgeyBzdHlsZWQgYXMgc3R5bGVkNyB9IGZyb20gXCJAbXVpL21hdGVyaWFsL3N0eWxlc1wiO1xudmFyIFNlZW5Db250YWluZXIgPSBzdHlsZWQ3KEJveDE3KSgoeyB0aGVtZSB9KSA9PiAoe1xuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDAuNSksXG4gIFwiJiAuTXVpU3ZnSWNvbi1yb290XCI6IHtcbiAgICBmb250U2l6ZTogXCIxcmVtXCIsXG4gICAgY29sb3I6IHRoZW1lLnBhbGV0dGUudGV4dC5zZWNvbmRhcnlcbiAgfVxufSkpO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL1NlZW5CeS9pbmRleC50c3hcbmltcG9ydCBtb21lbnQgZnJvbSBcIm1vbWVudFwiO1xuaW1wb3J0IHsganN4IGFzIGpzeDE2LCBqc3hzIGFzIGpzeHMxMCB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xudmFyIFNlZW5CeSA9ICh7XG4gIG1lc3NhZ2UsXG4gIHVzZXJJZCxcbiAgZ2V0UGFydGljaXBhbnQsXG4gIHRvdGFsUGFydGljaXBhbnRzXG59KSA9PiB7XG4gIHZhciBfYTtcbiAgaWYgKCEoKF9hID0gbWVzc2FnZS5zZWVuQnkpID09IG51bGwgPyB2b2lkIDAgOiBfYS5sZW5ndGgpKSByZXR1cm4gbnVsbDtcbiAgY29uc3Qgc2VlblBhcnRpY2lwYW50cyA9IG1lc3NhZ2Uuc2VlbkJ5LmZpbHRlcigoc2VlbikgPT4gc2Vlbi51c2VySWQgIT09IHVzZXJJZCkubWFwKChzZWVuKSA9PiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBnZXRQYXJ0aWNpcGFudChzZWVuLnVzZXJJZCkpLCB7XG4gICAgc2VlbkF0OiBzZWVuLnNlZW5BdFxuICB9KSk7XG4gIGlmIChzZWVuUGFydGljaXBhbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IGFsbFBhcnRpY2lwYW50c0hhdmVTZWVuID0gc2VlblBhcnRpY2lwYW50cy5sZW5ndGggPT09IHRvdGFsUGFydGljaXBhbnRzIC0gMTtcbiAgY29uc3QgdG9vbHRpcENvbnRlbnQgPSAvKiBAX19QVVJFX18gKi8ganN4MTYoQm94MTgsIHsgY2hpbGRyZW46IHNlZW5QYXJ0aWNpcGFudHMubWFwKChwYXJ0aWNpcGFudCkgPT4gLyogQF9fUFVSRV9fICovIGpzeHMxMChcbiAgICBUeXBvZ3JhcGh5NyxcbiAgICB7XG4gICAgICB2YXJpYW50OiBcImNhcHRpb25cIixcbiAgICAgIHN4OiB7IGRpc3BsYXk6IFwiYmxvY2tcIiB9LFxuICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgcGFydGljaXBhbnQubmFtZSxcbiAgICAgICAgXCIgLSBcIixcbiAgICAgICAgbW9tZW50KHBhcnRpY2lwYW50LnNlZW5BdCkuZm9ybWF0KFwiSEg6bW1cIilcbiAgICAgIF1cbiAgICB9LFxuICAgIHBhcnRpY2lwYW50LmlkXG4gICkpIH0pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeDE2KFNlZW5Db250YWluZXIsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxNihUb29sdGlwMiwgeyB0aXRsZTogdG9vbHRpcENvbnRlbnQsIGNoaWxkcmVuOiBhbGxQYXJ0aWNpcGFudHNIYXZlU2VlbiA/IC8qIEBfX1BVUkVfXyAqLyBqc3gxNihDaGVja0NpcmNsZUljb24sIHt9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3gxNihDaGVja0NpcmNsZU91dGxpbmVJY29uLCB7fSkgfSkgfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdC9jb21wb25lbnRzL1VzZXJBdmF0YXIvaW5kZXgudHN4XG5pbXBvcnQgeyBBdmF0YXIsIFRvb2x0aXAgYXMgVG9vbHRpcDMgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IFJlYWN0NyBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGpzeCBhcyBqc3gxNyB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xudmFyIFVzZXJBdmF0YXIgPSBSZWFjdDcuZm9yd2FyZFJlZihcbiAgKHsgdXNlciwgc2l6ZSA9IDMyIH0sIHJlZikgPT4ge1xuICAgIGNvbnN0IGdldEluaXRpYWxzID0gKG5hbWUpID0+IHtcbiAgICAgIHJldHVybiBuYW1lLnNwbGl0KFwiIFwiKS5tYXAoKG4pID0+IG5bMF0pLmpvaW4oXCJcIikudG9VcHBlckNhc2UoKS5zbGljZSgwLCAyKTtcbiAgICB9O1xuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4MTcoVG9vbHRpcDMsIHsgdGl0bGU6IHVzZXIubmFtZSwgYXJyb3c6IHRydWUsIHBsYWNlbWVudDogXCJ0b3BcIiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxNyhcbiAgICAgIEF2YXRhcixcbiAgICAgIHtcbiAgICAgICAgcmVmLFxuICAgICAgICBzcmM6IHVzZXIuYXZhdGFyLFxuICAgICAgICBhbHQ6IHVzZXIubmFtZSxcbiAgICAgICAgc3g6IHtcbiAgICAgICAgICB3aWR0aDogc2l6ZSxcbiAgICAgICAgICBoZWlnaHQ6IHNpemUsXG4gICAgICAgICAgYmdjb2xvcjogXCJncmV5LjMwMFwiLFxuICAgICAgICAgIGZvbnRTaXplOiBgJHtzaXplICogMC40fXB4YCxcbiAgICAgICAgICBjdXJzb3I6IFwicG9pbnRlclwiXG4gICAgICAgIH0sXG4gICAgICAgIGNoaWxkcmVuOiAhdXNlci5hdmF0YXIgJiYgZ2V0SW5pdGlhbHModXNlci5uYW1lKVxuICAgICAgfVxuICAgICkgfSk7XG4gIH1cbik7XG5Vc2VyQXZhdGFyLmRpc3BsYXlOYW1lID0gXCJVc2VyQXZhdGFyXCI7XG5cbi8vIHNyYy9jbGllbnQvdXRpbHMvY29sb3IudHNcbnZhciBnZW5lcmF0ZUNvbG9yRnJvbUlkID0gKGlkKSA9PiB7XG4gIGNvbnN0IGhhc2ggPSBpZC5zcGxpdChcIlwiKS5yZWR1Y2UoKGFjYywgY2hhcikgPT4ge1xuICAgIGNvbnN0IGNoYXJDb2RlID0gY2hhci5jaGFyQ29kZUF0KDApO1xuICAgIHJldHVybiAoYWNjIDw8IDUpIC0gYWNjICsgY2hhckNvZGU7XG4gIH0sIDApO1xuICBjb25zdCBnb2xkZW5SYXRpbyA9IDAuNjE4MDMzOTg4NzQ5ODk1O1xuICBjb25zdCBodWUgPSBoYXNoICogZ29sZGVuUmF0aW8gJSAzNjA7XG4gIHJldHVybiBgaHNsKCR7aHVlfSwgODUlLCA3NSUpYDtcbn07XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvTWVzc2FnZUxpc3QvaW5kZXgudHN4XG5pbXBvcnQgbW9tZW50MiBmcm9tIFwibW9tZW50XCI7XG5pbXBvcnQgeyBqc3ggYXMganN4MTgsIGpzeHMgYXMganN4czExIH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG5tb21lbnQyLmxvY2FsZShcImZyXCIpO1xudmFyIE1lc3NhZ2VMaXN0ID0gKCkgPT4ge1xuICBjb25zdCB7XG4gICAgbWVzc2FnZXMsXG4gICAgcGFydGljaXBhbnRzLFxuICAgIGdldFBhcnRpY2lwYW50LFxuICAgIGlzTG9hZGluZyxcbiAgICBjb25maWcsXG4gICAgdXNlcklkLFxuICAgIHNjcm9sbE1hbmFnZXJcbiAgfSA9IHVzZUNoYXRDb250ZXh0KCk7XG4gIGNvbnN0IG1lc3NhZ2VFbmRSZWYgPSBSZWFjdDgudXNlUmVmKG51bGwpO1xuICBjb25zdCBjb250YWluZXJSZWYgPSBSZWFjdDgudXNlUmVmKG51bGwpO1xuICBjb25zdCBbc2hvdWxkU2hvd0NvbnRlbnQsIHNldFNob3VsZFNob3dDb250ZW50XSA9IFJlYWN0OC51c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGlzRmlyc3RMb2FkUmVmID0gUmVhY3Q4LnVzZVJlZih0cnVlKTtcbiAgUmVhY3Q4LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFpc0xvYWRpbmcpIHtcbiAgICAgIHNldFNob3VsZFNob3dDb250ZW50KHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRTaG91bGRTaG93Q29udGVudChmYWxzZSk7XG4gICAgfVxuICB9LCBbaXNMb2FkaW5nXSk7XG4gIFJlYWN0OC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChzaG91bGRTaG93Q29udGVudCAmJiBpc0ZpcnN0TG9hZFJlZi5jdXJyZW50ICYmIG1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGNoZWNrQW5kU2Nyb2xsID0gKCkgPT4ge1xuICAgICAgICBpZiAoY29udGFpbmVyUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICBjb25zdCBjb250YWluZXJIZWlnaHQgPSBjb250YWluZXJSZWYuY3VycmVudC5zY3JvbGxIZWlnaHQ7XG4gICAgICAgICAgaWYgKGNvbnRhaW5lckhlaWdodCA+IDApIHtcbiAgICAgICAgICAgIHNjcm9sbE1hbmFnZXIuc2Nyb2xsVG9Cb3R0b20oXCJpbnN0YW50XCIpO1xuICAgICAgICAgICAgaXNGaXJzdExvYWRSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2hlY2tBbmRTY3JvbGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShjaGVja0FuZFNjcm9sbCk7XG4gICAgfVxuICB9LCBbc2hvdWxkU2hvd0NvbnRlbnQsIG1lc3NhZ2VzLmxlbmd0aCwgc2Nyb2xsTWFuYWdlcl0pO1xuICBpZiAoaXNMb2FkaW5nIHx8ICFzaG91bGRTaG93Q29udGVudCkge1xuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4MTgoXG4gICAgICBCb3gxOSxcbiAgICAgIHtcbiAgICAgICAgc3g6IHtcbiAgICAgICAgICBkaXNwbGF5OiBcImZsZXhcIixcbiAgICAgICAgICBqdXN0aWZ5Q29udGVudDogXCJjZW50ZXJcIixcbiAgICAgICAgICBhbGlnbkl0ZW1zOiBcImNlbnRlclwiLFxuICAgICAgICAgIGhlaWdodDogXCIxMDAlXCIsXG4gICAgICAgICAgbWluSGVpZ2h0OiBcIjIwMHB4XCJcbiAgICAgICAgfSxcbiAgICAgICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxOChDaXJjdWxhclByb2dyZXNzMywge30pXG4gICAgICB9XG4gICAgKTtcbiAgfVxuICBpZiAoIWlzTG9hZGluZyAmJiBtZXNzYWdlcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMxMShNZXNzYWdlQ29udGFpbmVyLCB7IHJlZjogY29udGFpbmVyUmVmLCBjaGlsZHJlbjogW1xuICAgICAgLyogQF9fUFVSRV9fICovIGpzeDE4KFN5c3RlbU1lc3NhZ2UsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gxOChcbiAgICAgICAgVHlwb2dyYXBoeTgsXG4gICAgICAgIHtcbiAgICAgICAgICB2YXJpYW50OiBcImJvZHkyXCIsXG4gICAgICAgICAgY29sb3I6IFwidGV4dC5zZWNvbmRhcnlcIixcbiAgICAgICAgICBzeDoge1xuICAgICAgICAgICAgZm9udFN0eWxlOiBcIml0YWxpY1wiLFxuICAgICAgICAgICAgb3BhY2l0eTogMC43LFxuICAgICAgICAgICAgZm9udFNpemU6IFwiMC44NXJlbVwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjaGlsZHJlbjogKGNvbmZpZyA9PSBudWxsID8gdm9pZCAwIDogY29uZmlnLndlbGNvbWVNZXNzYWdlKSB8fCBcIkF1Y3VuIG1lc3NhZ2UgcG91ciBsZSBtb21lbnRcIlxuICAgICAgICB9XG4gICAgICApIH0pLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeDE4KFwiZGl2XCIsIHsgcmVmOiBtZXNzYWdlRW5kUmVmIH0pXG4gICAgXSB9KTtcbiAgfVxuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMxMShNZXNzYWdlQ29udGFpbmVyLCB7IHJlZjogY29udGFpbmVyUmVmLCBjbGFzc05hbWU6IGlzTG9hZGluZyA/IFwibG9hZGluZ1wiIDogXCJcIiwgY2hpbGRyZW46IFtcbiAgICBtZXNzYWdlcy5tYXAoKG1lc3NhZ2UsIGluZGV4KSA9PiB7XG4gICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICBjb25zdCBpc0N1cnJlbnRVc2VyID0gbWVzc2FnZS51c2VySWQgPT09IHVzZXJJZDtcbiAgICAgIGNvbnN0IHVzZXJDb2xvciA9ICFpc0N1cnJlbnRVc2VyICYmIChjb25maWcgPT0gbnVsbCA/IHZvaWQgMCA6IGNvbmZpZy5hY3RpdmVVc2VyQ29sb3IpID8gZ2VuZXJhdGVDb2xvckZyb21JZChtZXNzYWdlLnVzZXJJZCkgOiB2b2lkIDA7XG4gICAgICBjb25zdCBzaG93VGltZSA9IGluZGV4ID09PSBtZXNzYWdlcy5sZW5ndGggLSAxIHx8ICgoX2EgPSBtZXNzYWdlc1tpbmRleCArIDFdKSA9PSBudWxsID8gdm9pZCAwIDogX2EudXNlcklkKSAhPT0gbWVzc2FnZS51c2VySWQgfHwgbW9tZW50MigoX2IgPSBtZXNzYWdlc1tpbmRleCArIDFdKSA9PSBudWxsID8gdm9pZCAwIDogX2IuY3JlYXRlZEF0KS5kaWZmKFxuICAgICAgICBtb21lbnQyKG1lc3NhZ2UuY3JlYXRlZEF0KSxcbiAgICAgICAgXCJtaW51dGVzXCJcbiAgICAgICkgPiA1O1xuICAgICAgY29uc3QgaGFzU3BlY2lhbENvbnRlbnQgPSBtZXNzYWdlLmF0dGFjaG1lbnRzICYmIG1lc3NhZ2UuYXR0YWNobWVudHMubGVuZ3RoID4gMDtcbiAgICAgIGNvbnN0IGhhc0F1ZGlvID0gKF9jID0gbWVzc2FnZS5hdHRhY2htZW50cykgPT0gbnVsbCA/IHZvaWQgMCA6IF9jLnNvbWUoXG4gICAgICAgIChhdHRhY2htZW50KSA9PiBhdHRhY2htZW50Lm5hbWUubWF0Y2goL1xcLihtcDN8d2F2fG9nZ3xtNGEpJC9pKVxuICAgICAgKTtcbiAgICAgIGlmICgoKF9kID0gbWVzc2FnZS50eXBlKSA9PSBudWxsID8gdm9pZCAwIDogX2QudG9Mb3dlckNhc2UoKSkgPT09IFwic3lzdGVtXCIpIHtcbiAgICAgICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3gxOChTeXN0ZW1NZXNzYWdlLCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4MTgoXG4gICAgICAgICAgVHlwb2dyYXBoeTgsXG4gICAgICAgICAge1xuICAgICAgICAgICAgdmFyaWFudDogXCJib2R5MlwiLFxuICAgICAgICAgICAgY29sb3I6IFwidGV4dC5zZWNvbmRhcnlcIixcbiAgICAgICAgICAgIHN4OiB7XG4gICAgICAgICAgICAgIGZvbnRTdHlsZTogXCJpdGFsaWNcIixcbiAgICAgICAgICAgICAgb3BhY2l0eTogMC43LFxuICAgICAgICAgICAgICBmb250U2l6ZTogXCIwLjg1cmVtXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjaGlsZHJlbjogbWVzc2FnZS5jb250ZW50XG4gICAgICAgICAgfVxuICAgICAgICApIH0sIG1lc3NhZ2UuaWQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3gxOChcbiAgICAgICAgTWVzc2FnZUdyb3VwLFxuICAgICAgICB7XG4gICAgICAgICAgY2xhc3NOYW1lOiBcIm1lc3NhZ2UtZ3JvdXBcIixcbiAgICAgICAgICBcImRhdGEtbWVzc2FnZS1pZFwiOiBtZXNzYWdlLmlkLFxuICAgICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4czExKE1lc3NhZ2VDb250ZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAhaXNDdXJyZW50VXNlciAmJiAvKiBAX19QVVJFX18gKi8ganN4MTgoQm94MTksIHsgc3g6IHsgZmxleFNocmluazogMCB9LCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDE4KFVzZXJBdmF0YXIsIHsgdXNlcjogZ2V0UGFydGljaXBhbnQobWVzc2FnZS51c2VySWQpIH0pIH0pLFxuICAgICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeHMxMShCb3gxOSwgeyBzeDogeyBkaXNwbGF5OiBcImZsZXhcIiwgZmxleERpcmVjdGlvbjogXCJjb2x1bW5cIiwgZmxleDogMSB9LCBjaGlsZHJlbjogW1xuICAgICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MTgoXG4gICAgICAgICAgICAgICAgTWVzc2FnZUJ1YmJsZSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBpc0N1cnJlbnRVc2VyLFxuICAgICAgICAgICAgICAgICAgdXNlckNvbG9yLFxuICAgICAgICAgICAgICAgICAgaGFzU3BlY2lhbENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICBoYXNBdWRpbyxcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UuY29udGVudCxcbiAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnRzOiBtZXNzYWdlLmF0dGFjaG1lbnRzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICBzaG93VGltZSAmJiAvKiBAX19QVVJFX18gKi8ganN4czExKFxuICAgICAgICAgICAgICAgIE1lc3NhZ2VUaW1lLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6IFwiY2FwdGlvblwiLFxuICAgICAgICAgICAgICAgICAgc3g6IHtcbiAgICAgICAgICAgICAgICAgICAgYWxpZ25TZWxmOiBpc0N1cnJlbnRVc2VyID8gXCJmbGV4LWVuZFwiIDogXCJmbGV4LXN0YXJ0XCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MTgoXCJzcGFuXCIsIHsgY2hpbGRyZW46IG1vbWVudDIobmV3IERhdGUobWVzc2FnZS5jcmVhdGVkQXQpKS5mb3JtYXQoXCJISDptbVwiKSB9KSxcbiAgICAgICAgICAgICAgICAgICAgaXNDdXJyZW50VXNlciAmJiAvKiBAX19QVVJFX18gKi8ganN4MTgoXG4gICAgICAgICAgICAgICAgICAgICAgU2VlbkJ5LFxuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRQYXJ0aWNpcGFudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsUGFydGljaXBhbnRzOiBwYXJ0aWNpcGFudHMubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICBdIH0pLFxuICAgICAgICAgICAgaXNDdXJyZW50VXNlciAmJiAvKiBAX19QVVJFX18gKi8ganN4MTgoQm94MTksIHsgc3g6IHsgZmxleFNocmluazogMCB9LCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDE4KFVzZXJBdmF0YXIsIHsgdXNlcjogZ2V0UGFydGljaXBhbnQobWVzc2FnZS51c2VySWQpIH0pIH0pXG4gICAgICAgICAgXSB9KVxuICAgICAgICB9LFxuICAgICAgICBtZXNzYWdlLmlkXG4gICAgICApO1xuICAgIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gxOChcImRpdlwiLCB7IHJlZjogbWVzc2FnZUVuZFJlZiB9KVxuICBdIH0pO1xufTtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXQvY29tcG9uZW50cy9UeXBpbmdJbmRpY2F0b3IvaW5kZXgudHN4XG5pbXBvcnQgeyBDb2xsYXBzZSwgVHlwb2dyYXBoeSBhcyBUeXBvZ3JhcGh5OSB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgeyB1c2VFZmZlY3QgYXMgdXNlRWZmZWN0NywgdXNlU3RhdGUgYXMgdXNlU3RhdGU4IH0gZnJvbSBcInJlYWN0XCI7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvVHlwaW5nSW5kaWNhdG9yL3N0eWxlcy50c1xuaW1wb3J0IHsgQm94IGFzIEJveDIwIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcbmltcG9ydCB7IHN0eWxlZCBhcyBzdHlsZWQ4IH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWwvc3R5bGVzXCI7XG52YXIgQ29udGFpbmVyID0gc3R5bGVkOChCb3gyMCkoKHsgdGhlbWUgfSkgPT4gKHtcbiAgcGFkZGluZzogdGhlbWUuc3BhY2luZygwLjUpLFxuICBtYXJnaW5Ub3A6IHRoZW1lLnNwYWNpbmcoMC41KSxcbiAgbWFyZ2luQm90dG9tOiB0aGVtZS5zcGFjaW5nKDAuNSksXG4gIGhlaWdodDogXCIyNHB4XCIsXG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBhbGlnbkl0ZW1zOiBcImNlbnRlclwiXG59KSk7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2NvbXBvbmVudHMvVHlwaW5nSW5kaWNhdG9yL2luZGV4LnRzeFxuaW1wb3J0IHsganN4IGFzIGpzeDE5IH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG52YXIgVHlwaW5nSW5kaWNhdG9yID0gKCkgPT4ge1xuICBjb25zdCB7IHR5cGluZ1VzZXJzLCBwYXJ0aWNpcGFudHMsIHVzZXJJZCB9ID0gdXNlQ2hhdENvbnRleHQoKTtcbiAgY29uc3QgW2lzVmlzaWJsZSwgc2V0SXNWaXNpYmxlXSA9IHVzZVN0YXRlOChmYWxzZSk7XG4gIGNvbnN0IHR5cGluZ1VzZXJzV2l0aG91dEN1cnJlbnRVc2VyID0gdHlwaW5nVXNlcnMuZmlsdGVyKFxuICAgICh1c2VyKSA9PiB1c2VyICE9PSB1c2VySWRcbiAgKTtcbiAgdXNlRWZmZWN0NygoKSA9PiB7XG4gICAgaWYgKHR5cGluZ1VzZXJzV2l0aG91dEN1cnJlbnRVc2VyLmxlbmd0aCA+IDApIHtcbiAgICAgIHNldElzVmlzaWJsZSh0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgc2V0SXNWaXNpYmxlKGZhbHNlKTtcbiAgICAgIH0sIDFlMyk7XG4gICAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICB9XG4gIH0sIFt0eXBpbmdVc2Vyc1dpdGhvdXRDdXJyZW50VXNlcl0pO1xuICBjb25zdCBnZXRUeXBpbmdVc2Vyc05hbWVzID0gKCkgPT4ge1xuICAgIGlmICghdHlwaW5nVXNlcnNXaXRob3V0Q3VycmVudFVzZXIubGVuZ3RoKSByZXR1cm4gXCJcIjtcbiAgICBjb25zdCB0eXBpbmdQYXJ0aWNpcGFudHMgPSBwYXJ0aWNpcGFudHMuZmlsdGVyKFxuICAgICAgKHVzZXIpID0+IHR5cGluZ1VzZXJzV2l0aG91dEN1cnJlbnRVc2VyLmluY2x1ZGVzKHVzZXIuaWQpICYmIHVzZXIuaWQgIT09IHVzZXJJZFxuICAgICk7XG4gICAgaWYgKHR5cGluZ1BhcnRpY2lwYW50cy5sZW5ndGggPT09IDApIHJldHVybiBcIlwiO1xuICAgIGNvbnN0IG5hbWVzID0gdHlwaW5nUGFydGljaXBhbnRzLm1hcCgodXNlcikgPT4gdXNlci5uYW1lKTtcbiAgICBpZiAobmFtZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICByZXR1cm4gYCR7bmFtZXNbMF19IFxceEU5Y3JpdC4uLmA7XG4gICAgfSBlbHNlIGlmIChuYW1lcy5sZW5ndGggPT09IDIpIHtcbiAgICAgIHJldHVybiBgJHtuYW1lc1swXX0gZXQgJHtuYW1lc1sxXX0gXFx4RTljcml2ZW50Li4uYDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGAke25hbWVzWzBdfSwgJHtuYW1lc1sxXX0gZXQgJHtuYW1lcy5sZW5ndGggLSAyfSBhdXRyZShzKSBcXHhFOWNyaXZlbnQuLi5gO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgdHlwaW5nVGV4dCA9IGdldFR5cGluZ1VzZXJzTmFtZXMoKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3gxOShDb2xsYXBzZSwgeyBpbjogaXNWaXNpYmxlLCBzeDogeyBwbDogMiB9LCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDE5KENvbnRhaW5lciwgeyBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDE5KFxuICAgIFR5cG9ncmFwaHk5LFxuICAgIHtcbiAgICAgIHZhcmlhbnQ6IFwiY2FwdGlvblwiLFxuICAgICAgY29sb3I6IFwidGV4dC5zZWNvbmRhcnlcIixcbiAgICAgIHN4OiB7XG4gICAgICAgIGZvbnRTdHlsZTogXCJpdGFsaWNcIixcbiAgICAgICAgZm9udFNpemU6IFwiMC43NXJlbVwiLFxuICAgICAgICBvcGFjaXR5OiB0eXBpbmdUZXh0ID8gMSA6IDAsXG4gICAgICAgIHRyYW5zaXRpb246IFwib3BhY2l0eSAwLjNzIGVhc2UtaW4tb3V0XCJcbiAgICAgIH0sXG4gICAgICBjaGlsZHJlbjogdHlwaW5nVGV4dFxuICAgIH1cbiAgKSB9KSB9KTtcbn07XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0L2luZGV4LnRzeFxuaW1wb3J0IHsgRnJhZ21lbnQgYXMgRnJhZ21lbnQyLCBqc3ggYXMganN4MjAsIGpzeHMgYXMganN4czEyIH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG52YXIgQ2hhdENvbnZlcnNhdGlvbkNvbnRlbnQgPSAoKSA9PiB7XG4gIGNvbnN0IHsgc2Nyb2xsTWFuYWdlciB9ID0gdXNlQ2hhdENvbnRleHQoKTtcbiAgY29uc3QgeyBjb250ZW50UmVmIH0gPSBzY3JvbGxNYW5hZ2VyO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMxMihGcmFnbWVudDIsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4czEyKENvbnRlbnQsIHsgcmVmOiBjb250ZW50UmVmLCBjaGlsZHJlbjogW1xuICAgICAgLyogQF9fUFVSRV9fICovIGpzeDIwKExvYWRNb3JlTWVzc2FnZXMsIHt9KSxcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gyMChNZXNzYWdlTGlzdCwge30pXG4gICAgXSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MjAoQ2hhdEFjdGlvbnMsIHt9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MjAoVHlwaW5nSW5kaWNhdG9yLCB7fSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeDIwKE1lc3NhZ2VJbnB1dCwge30pXG4gIF0gfSk7XG59O1xudmFyIENoYXROb0NvbnZlcnNhdGlvbkNvbnRlbnQgPSAoeyBidXR0b25Kb2luIH0pID0+IHtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3gyMChGcmFnbWVudDIsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gyMChDb250ZW50LCB7IGNoaWxkcmVuOiBidXR0b25Kb2luID8gYnV0dG9uSm9pbiA6IC8qIEBfX1BVUkVfXyAqLyBqc3hzMTIoV2FpdGluZ01lc3NhZ2VDb250YWluZXIsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MjAoV2FpdGluZ01lc3NhZ2VFbW9qaSwgeyBjaGlsZHJlbjogXCJcXHV7MUY0QUR9XCIgfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeDIwKFdhaXRpbmdNZXNzYWdlVGl0bGUsIHsgY2hpbGRyZW46IFwiRW4gYXR0ZW50ZSBkZSBjb252ZXJzYXRpb25cIiB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MjAoV2FpdGluZ01lc3NhZ2VUZXh0LCB7IGNoaWxkcmVuOiBcIkxhIGNvbnZlcnNhdGlvbiBuJ2VzdCBwYXMgZW5jb3JlIGFjdGl2ZS4gUmV2ZW5leiBiaWVudFxceEY0dCBwb3VyIGRpc2N1dGVyICFcIiB9KVxuICBdIH0pIH0pIH0pO1xufTtcbnZhciBDaGF0ID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0IF9hID0gcHJvcHMsIHsgY29udmVyc2F0aW9uSWQsIGJ1dHRvbkpvaW4gfSA9IF9hLCByZXN0ID0gX19vYmpSZXN0KF9hLCBbXCJjb252ZXJzYXRpb25JZFwiLCBcImJ1dHRvbkpvaW5cIl0pO1xuICBpZiAoY29udmVyc2F0aW9uSWQpIHtcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeDIwKENoYXRQcm92aWRlciwgX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgcmVzdCksIHsgY29udmVyc2F0aW9uSWQsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4MjAoQ2hhdENvbnZlcnNhdGlvbkNvbnRlbnQsIHt9KSB9KSk7XG4gIH1cbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3gyMChDaGF0Tm9Db252ZXJzYXRpb25Db250ZW50LCB7IGJ1dHRvbkpvaW4gfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdEJ1YmJsZS9pbmRleC50c3hcbmltcG9ydCB7IHVzZVN0YXRlIGFzIHVzZVN0YXRlMTEgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEJhZGdlIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcbmltcG9ydCBDaGF0SWNvbiBmcm9tIFwiQG11aS9pY29ucy1tYXRlcmlhbC9DaGF0XCI7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0UG9wdXAvaW5kZXgudHN4XG5pbXBvcnQgUmVhY3QxMywgeyB1c2VFZmZlY3QgYXMgdXNlRWZmZWN0OCB9IGZyb20gXCJyZWFjdFwiO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdFBvcHVwL2NvbXBvbmVudHMvSGVhZGVyL2luZGV4LnRzeFxuaW1wb3J0IHsgQm94IGFzIEJveDI3LCBJY29uQnV0dG9uIGFzIEljb25CdXR0b245LCBUeXBvZ3JhcGh5IGFzIFR5cG9ncmFwaHkxMyB9IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5pbXBvcnQgeyB1c2VTdGF0ZSBhcyB1c2VTdGF0ZTEwIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgQ2xvc2UgZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvQ2xvc2VcIjtcbmltcG9ydCBDbG9zZUZ1bGxzY3JlZW4gZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvQ2xvc2VGdWxsc2NyZWVuXCI7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0UG9wdXAvY29tcG9uZW50cy9IZWFkZXIvRG9jdW1lbnRzTWVudS9pbmRleC50c3hcbmltcG9ydCB7IEJveCBhcyBCb3gyMywgSWNvbkJ1dHRvbiBhcyBJY29uQnV0dG9uNiwgVHlwb2dyYXBoeSBhcyBUeXBvZ3JhcGh5MTAgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdFBvcHVwL2NvbXBvbmVudHMvSGVhZGVyL0RvY3VtZW50c01lbnUvc3R5bGVzLnRzXG5pbXBvcnQgeyBCb3ggYXMgQm94MjEsIExpc3QsIFBvcG92ZXIgYXMgUG9wb3ZlcjIgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDkgfSBmcm9tIFwiQG11aS9tYXRlcmlhbC9zdHlsZXNcIjtcbnZhciBTdHlsZWRQb3BvdmVyID0gc3R5bGVkOShQb3BvdmVyMikoKHsgdGhlbWUgfSkgPT4gKHtcbiAgXCImIC5NdWlQYXBlci1yb290XCI6IHtcbiAgICB3aWR0aDogMjgwLFxuICAgIG1heEhlaWdodDogMzYwLFxuICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLnBhcGVyLFxuICAgIGJvcmRlclJhZGl1czogdGhlbWUuc2hhcGUuYm9yZGVyUmFkaXVzLFxuICAgIGJveFNoYWRvdzogdGhlbWUuc2hhZG93c1szXSxcbiAgICBkaXNwbGF5OiBcImZsZXhcIixcbiAgICBmbGV4RGlyZWN0aW9uOiBcImNvbHVtblwiXG4gIH1cbn0pKTtcbnZhciBNZW51SGVhZGVyID0gc3R5bGVkOShCb3gyMSkoKHsgdGhlbWUgfSkgPT4gKHtcbiAgcGFkZGluZzogdGhlbWUuc3BhY2luZygxLjUpLFxuICBib3JkZXJCb3R0b206IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLmRpdmlkZXJ9YCxcbiAgZGlzcGxheTogXCJmbGV4XCIsXG4gIGFsaWduSXRlbXM6IFwiY2VudGVyXCIsXG4gIGp1c3RpZnlDb250ZW50OiBcInNwYWNlLWJldHdlZW5cIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDEpLFxuICBwb3NpdGlvbjogXCJzdGlja3lcIixcbiAgdG9wOiAwLFxuICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLnBhbGV0dGUuYmFja2dyb3VuZC5wYXBlcixcbiAgekluZGV4OiAxXG59KSk7XG52YXIgU3R5bGVkTGlzdCA9IHN0eWxlZDkoTGlzdCkoKHsgdGhlbWUgfSkgPT4gKHtcbiAgZmxleDogMSxcbiAgb3ZlcmZsb3c6IFwiYXV0b1wiLFxuICBweTogMFxufSkpO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdFBvcHVwL2NvbXBvbmVudHMvSGVhZGVyL0RvY3VtZW50c01lbnUvaW5kZXgudHN4XG5pbXBvcnQgeyB1c2VSZWYgYXMgdXNlUmVmOSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IENsb3NlSWNvbjIgZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvQ2xvc2VcIjtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0ZpbGVNYW5hZ2VyL3N0eWxlcy50c1xuaW1wb3J0IHsgQm94IGFzIEJveDIyIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWxcIjtcbmltcG9ydCB7IHN0eWxlZCBhcyBzdHlsZWQxMCB9IGZyb20gXCJAbXVpL21hdGVyaWFsL3N0eWxlc1wiO1xudmFyIEZpbGVDb250YWluZXIyID0gc3R5bGVkMTAoQm94MjIpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBmbGV4RGlyZWN0aW9uOiBcImNvbHVtblwiLFxuICBnYXA6IHRoZW1lLnNwYWNpbmcoMSksXG4gIHBhZGRpbmc6IHRoZW1lLnNwYWNpbmcoMSksXG4gIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLmRlZmF1bHQsXG4gIGJvcmRlclJhZGl1czogdGhlbWUuc2hhcGUuYm9yZGVyUmFkaXVzLFxuICBib3JkZXI6IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLmRpdmlkZXJ9YCxcbiAgY3Vyc29yOiBcInBvaW50ZXJcIixcbiAgXCImOmhvdmVyXCI6IHtcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IHRoZW1lLnBhbGV0dGUuYWN0aW9uLmhvdmVyXG4gIH1cbn0pKTtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0ZpbGVNYW5hZ2VyL0ZpbGVJdGVtLnRzeFxuaW1wb3J0IHsganN4IGFzIGpzeDIxIH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG52YXIgRmlsZUl0ZW0gPSAoeyBmaWxlLCBvbkNsaWNrIH0pID0+IHtcbiAgY29uc3QgaGFuZGxlQ2xpY2sgPSAoZSkgPT4ge1xuICAgIGlmIChpc0F1ZGlvKGZpbGUubmFtZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKG9uQ2xpY2spIHtcbiAgICAgIG9uQ2xpY2soZmlsZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbmRvdy5vcGVuKGZpbGUudXJsLCBcIl9ibGFua1wiKTtcbiAgICB9XG4gIH07XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4MjEoRmlsZUNvbnRhaW5lcjIsIHsgb25DbGljazogaGFuZGxlQ2xpY2ssIGNoaWxkcmVuOiBpc0ltYWdlKGZpbGUubmFtZSkgPyAvKiBAX19QVVJFX18gKi8ganN4MjEoSW1hZ2VGaWxlLCB7IHVybDogZmlsZS51cmwsIG5hbWU6IGZpbGUubmFtZSB9KSA6IGlzQXVkaW8oZmlsZS5uYW1lKSA/IC8qIEBfX1BVUkVfXyAqLyBqc3gyMShBdWRpb01lc3NhZ2UsIHsgdXJsOiBmaWxlLnVybCB9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3gyMShSZWd1bGFyRmlsZSwgeyB1cmw6IGZpbGUudXJsLCBuYW1lOiBmaWxlLm5hbWUgfSkgfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdFBvcHVwL2NvbXBvbmVudHMvSGVhZGVyL0RvY3VtZW50c01lbnUvaW5kZXgudHN4XG5pbXBvcnQgSW5zZXJ0RHJpdmVGaWxlSWNvbjIgZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvSW5zZXJ0RHJpdmVGaWxlXCI7XG5pbXBvcnQgeyBGcmFnbWVudCBhcyBGcmFnbWVudDMsIGpzeCBhcyBqc3gyMiwganN4cyBhcyBqc3hzMTMgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBEb2N1bWVudHNNZW51ID0gKHtcbiAgYWxsQXR0YWNobWVudHMsXG4gIG9wZW4sXG4gIG9uQ2xvc2Vcbn0pID0+IHtcbiAgY29uc3QgYW5jaG9yUmVmID0gdXNlUmVmOShudWxsKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzMTMoRnJhZ21lbnQzLCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeDIyKFxuICAgICAgSWNvbkJ1dHRvbjYsXG4gICAgICB7XG4gICAgICAgIHJlZjogYW5jaG9yUmVmLFxuICAgICAgICBzaXplOiBcInNtYWxsXCIsXG4gICAgICAgIHN4OiB7XG4gICAgICAgICAgY29sb3I6ICh0aGVtZSkgPT4gdGhlbWUucGFsZXR0ZS50ZXh0LnNlY29uZGFyeSxcbiAgICAgICAgICBwYWRkaW5nOiAwLjUsXG4gICAgICAgICAgXCImOmhvdmVyXCI6IHtcbiAgICAgICAgICAgIGNvbG9yOiAodGhlbWUpID0+IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5tYWluXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDIyKEluc2VydERyaXZlRmlsZUljb24yLCB7IGZvbnRTaXplOiBcInNtYWxsXCIgfSlcbiAgICAgIH1cbiAgICApLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzMTMoXG4gICAgICBTdHlsZWRQb3BvdmVyLFxuICAgICAge1xuICAgICAgICBvcGVuLFxuICAgICAgICBhbmNob3JFbDogYW5jaG9yUmVmLmN1cnJlbnQsXG4gICAgICAgIG9uQ2xvc2UsXG4gICAgICAgIGFuY2hvck9yaWdpbjoge1xuICAgICAgICAgIHZlcnRpY2FsOiBcImJvdHRvbVwiLFxuICAgICAgICAgIGhvcml6b250YWw6IFwicmlnaHRcIlxuICAgICAgICB9LFxuICAgICAgICB0cmFuc2Zvcm1PcmlnaW46IHtcbiAgICAgICAgICB2ZXJ0aWNhbDogXCJ0b3BcIixcbiAgICAgICAgICBob3Jpem9udGFsOiBcInJpZ2h0XCJcbiAgICAgICAgfSxcbiAgICAgICAgb25DbGljazogKGUpID0+IGUuc3RvcFByb3BhZ2F0aW9uKCksXG4gICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeHMxMyhNZW51SGVhZGVyLCB7IGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4czEzKEJveDIzLCB7IHN4OiB7IGRpc3BsYXk6IFwiZmxleFwiLCBhbGlnbkl0ZW1zOiBcImNlbnRlclwiLCBnYXA6IDEgfSwgY2hpbGRyZW46IFtcbiAgICAgICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeDIyKEluc2VydERyaXZlRmlsZUljb24yLCB7IGZvbnRTaXplOiBcInNtYWxsXCIsIGNvbG9yOiBcInByaW1hcnlcIiB9KSxcbiAgICAgICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeHMxMyhUeXBvZ3JhcGh5MTAsIHsgdmFyaWFudDogXCJzdWJ0aXRsZTJcIiwgZm9udFdlaWdodDogXCJib2xkXCIsIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAgICAgXCJEb2N1bWVudHMgKFwiLFxuICAgICAgICAgICAgICAgIChhbGxBdHRhY2htZW50cyA9PSBudWxsID8gdm9pZCAwIDogYWxsQXR0YWNobWVudHMubGVuZ3RoKSB8fCAwLFxuICAgICAgICAgICAgICAgIFwiKVwiXG4gICAgICAgICAgICAgIF0gfSlcbiAgICAgICAgICAgIF0gfSksXG4gICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjIoSWNvbkJ1dHRvbjYsIHsgc2l6ZTogXCJzbWFsbFwiLCBvbkNsaWNrOiBvbkNsb3NlLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDIyKENsb3NlSWNvbjIsIHsgZm9udFNpemU6IFwic21hbGxcIiB9KSB9KVxuICAgICAgICAgIF0gfSksXG4gICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeDIyKFN0eWxlZExpc3QsIHsgY2hpbGRyZW46IChhbGxBdHRhY2htZW50cyA9PSBudWxsID8gdm9pZCAwIDogYWxsQXR0YWNobWVudHMubGVuZ3RoKSA9PT0gMCA/IC8qIEBfX1BVUkVfXyAqLyBqc3gyMihCb3gyMywgeyBzeDogeyBwOiAyLCB0ZXh0QWxpZ246IFwiY2VudGVyXCIgfSwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gyMihUeXBvZ3JhcGh5MTAsIHsgdmFyaWFudDogXCJib2R5MlwiLCBjb2xvcjogXCJ0ZXh0LnNlY29uZGFyeVwiLCBjaGlsZHJlbjogXCJBdWN1biBkb2N1bWVudCBwYXJ0YWdcXHhFOSBkYW5zIGNldHRlIGNvbnZlcnNhdGlvblwiIH0pIH0pIDogYWxsQXR0YWNobWVudHMgPT0gbnVsbCA/IHZvaWQgMCA6IGFsbEF0dGFjaG1lbnRzLm1hcCgoZmlsZSwgaW5kZXgpID0+IC8qIEBfX1BVUkVfXyAqLyBqc3gyMihGaWxlSXRlbSwgeyBmaWxlIH0sIGluZGV4KSkgfSlcbiAgICAgICAgXVxuICAgICAgfVxuICAgIClcbiAgXSB9KTtcbn07XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0UG9wdXAvY29tcG9uZW50cy9IZWFkZXIvSGVhZGVyTWVudS50c3hcbmltcG9ydCB7XG4gIEljb25CdXR0b24gYXMgSWNvbkJ1dHRvbjgsXG4gIE1lbnUsXG4gIE1lbnVJdGVtLFxuICBUb29sdGlwIGFzIFRvb2x0aXA0LFxuICBUeXBvZ3JhcGh5IGFzIFR5cG9ncmFwaHkxMlxufSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgdXNlU3RhdGUgYXMgdXNlU3RhdGU5IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgTW9yZVZlcnRJY29uIGZyb20gXCJAbXVpL2ljb25zLW1hdGVyaWFsL01vcmVWZXJ0XCI7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0UG9wdXAvY29tcG9uZW50cy9IZWFkZXIvUGFydGljaXBhbnRzTWVudS9pbmRleC50c3hcbmltcG9ydCB7XG4gIEJveCBhcyBCb3gyNSxcbiAgSWNvbkJ1dHRvbiBhcyBJY29uQnV0dG9uNyxcbiAgTGlzdEl0ZW1JY29uLFxuICBMaXN0SXRlbVRleHQsXG4gIFR5cG9ncmFwaHkgYXMgVHlwb2dyYXBoeTExXG59IGZyb20gXCJAbXVpL21hdGVyaWFsXCI7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0UG9wdXAvY29tcG9uZW50cy9IZWFkZXIvUGFydGljaXBhbnRzTWVudS9zdHlsZXMudHNcbmltcG9ydCB7IEJveCBhcyBCb3gyNCwgTGlzdCBhcyBMaXN0MiwgTGlzdEl0ZW0sIFBvcG92ZXIgYXMgUG9wb3ZlcjMgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDExIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWwvc3R5bGVzXCI7XG52YXIgU3R5bGVkUG9wb3ZlcjIgPSBzdHlsZWQxMShQb3BvdmVyMykoKHsgdGhlbWUgfSkgPT4gKHtcbiAgXCImIC5NdWlQYXBlci1yb290XCI6IHtcbiAgICB3aWR0aDogMjgwLFxuICAgIG1heEhlaWdodDogMzYwLFxuICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLnBhcGVyLFxuICAgIGJvcmRlclJhZGl1czogdGhlbWUuc2hhcGUuYm9yZGVyUmFkaXVzLFxuICAgIGJveFNoYWRvdzogdGhlbWUuc2hhZG93c1szXSxcbiAgICBkaXNwbGF5OiBcImZsZXhcIixcbiAgICBmbGV4RGlyZWN0aW9uOiBcImNvbHVtblwiXG4gIH1cbn0pKTtcbnZhciBNZW51SGVhZGVyMiA9IHN0eWxlZDExKEJveDI0KSgoeyB0aGVtZSB9KSA9PiAoe1xuICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDEuNSksXG4gIGJvcmRlckJvdHRvbTogYDFweCBzb2xpZCAke3RoZW1lLnBhbGV0dGUuZGl2aWRlcn1gLFxuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAganVzdGlmeUNvbnRlbnQ6IFwic3BhY2UtYmV0d2VlblwiLFxuICBnYXA6IHRoZW1lLnNwYWNpbmcoMSksXG4gIHBvc2l0aW9uOiBcInN0aWNreVwiLFxuICB0b3A6IDAsXG4gIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLnBhcGVyLFxuICB6SW5kZXg6IDFcbn0pKTtcbnZhciBQYXJ0aWNpcGFudEF2YXRhciA9IHN0eWxlZDExKEJveDI0KSgoeyB0aGVtZSB9KSA9PiAoe1xuICB3aWR0aDogMzIsXG4gIGhlaWdodDogMzIsXG4gIGJvcmRlclJhZGl1czogXCI1MCVcIixcbiAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBhbGlnbkl0ZW1zOiBcImNlbnRlclwiLFxuICBqdXN0aWZ5Q29udGVudDogXCJjZW50ZXJcIixcbiAgYmFja2dyb3VuZENvbG9yOiB0aGVtZS5wYWxldHRlLnByaW1hcnkubWFpbixcbiAgY29sb3I6IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5jb250cmFzdFRleHQsXG4gIGZvbnRTaXplOiBcIjAuOXJlbVwiLFxuICBmb250V2VpZ2h0OiA1MDAsXG4gIFwiJiBpbWdcIjoge1xuICAgIHdpZHRoOiBcIjEwMCVcIixcbiAgICBoZWlnaHQ6IFwiMTAwJVwiLFxuICAgIG9iamVjdEZpdDogXCJjb3ZlclwiXG4gIH1cbn0pKTtcbnZhciBTdHlsZWRMaXN0SXRlbSA9IHN0eWxlZDExKExpc3RJdGVtKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBwYWRkaW5nOiB0aGVtZS5zcGFjaW5nKDAuNzUsIDEuNSksXG4gIFwiJjpob3ZlclwiOiB7XG4gICAgYmFja2dyb3VuZENvbG9yOiB0aGVtZS5wYWxldHRlLmFjdGlvbi5ob3ZlclxuICB9XG59KSk7XG52YXIgU3R5bGVkTGlzdDIgPSBzdHlsZWQxMShMaXN0MikoKHsgdGhlbWUgfSkgPT4gKHtcbiAgZmxleDogMSxcbiAgb3ZlcmZsb3c6IFwiYXV0b1wiLFxuICBweTogMFxufSkpO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdFBvcHVwL2NvbXBvbmVudHMvSGVhZGVyL1BhcnRpY2lwYW50c01lbnUvaW5kZXgudHN4XG5pbXBvcnQgeyB1c2VSZWYgYXMgdXNlUmVmMTAgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBHcm91cEljb24gZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvR3JvdXBcIjtcbmltcG9ydCB7IEZyYWdtZW50IGFzIEZyYWdtZW50NCwganN4IGFzIGpzeDIzLCBqc3hzIGFzIGpzeHMxNCB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xudmFyIFBhcnRpY2lwYW50c01lbnUgPSAoe1xuICBwYXJ0aWNpcGFudHMsXG4gIHJlbmRlclBhcnRpY2lwYW50LFxuICBvcGVuLFxuICBvbkNsb3NlXG59KSA9PiB7XG4gIGNvbnN0IGFuY2hvclJlZiA9IHVzZVJlZjEwKG51bGwpO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMxNChGcmFnbWVudDQsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MjMoXG4gICAgICBJY29uQnV0dG9uNyxcbiAgICAgIHtcbiAgICAgICAgcmVmOiBhbmNob3JSZWYsXG4gICAgICAgIHNpemU6IFwic21hbGxcIixcbiAgICAgICAgc3g6IHtcbiAgICAgICAgICBjb2xvcjogKHRoZW1lKSA9PiB0aGVtZS5wYWxldHRlLnRleHQuc2Vjb25kYXJ5LFxuICAgICAgICAgIHBhZGRpbmc6IDAuNSxcbiAgICAgICAgICBcIiY6aG92ZXJcIjoge1xuICAgICAgICAgICAgY29sb3I6ICh0aGVtZSkgPT4gdGhlbWUucGFsZXR0ZS5wcmltYXJ5Lm1haW5cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4MjMoR3JvdXBJY29uLCB7IGZvbnRTaXplOiBcInNtYWxsXCIgfSlcbiAgICAgIH1cbiAgICApLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzMTQoXG4gICAgICBTdHlsZWRQb3BvdmVyMixcbiAgICAgIHtcbiAgICAgICAgb3BlbixcbiAgICAgICAgYW5jaG9yRWw6IGFuY2hvclJlZi5jdXJyZW50LFxuICAgICAgICBvbkNsb3NlLFxuICAgICAgICBhbmNob3JPcmlnaW46IHtcbiAgICAgICAgICB2ZXJ0aWNhbDogXCJib3R0b21cIixcbiAgICAgICAgICBob3Jpem9udGFsOiBcInJpZ2h0XCJcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmb3JtT3JpZ2luOiB7XG4gICAgICAgICAgdmVydGljYWw6IFwidG9wXCIsXG4gICAgICAgICAgaG9yaXpvbnRhbDogXCJyaWdodFwiXG4gICAgICAgIH0sXG4gICAgICAgIG9uQ2xpY2s6IChlKSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpLFxuICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gyMyhNZW51SGVhZGVyMiwgeyBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeHMxNChCb3gyNSwgeyBzeDogeyBkaXNwbGF5OiBcImZsZXhcIiwgYWxpZ25JdGVtczogXCJjZW50ZXJcIiwgZ2FwOiAxIH0sIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjMoR3JvdXBJY29uLCB7IGZvbnRTaXplOiBcInNtYWxsXCIsIGNvbG9yOiBcInByaW1hcnlcIiB9KSxcbiAgICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzMTQoVHlwb2dyYXBoeTExLCB7IHZhcmlhbnQ6IFwic3VidGl0bGUyXCIsIGZvbnRXZWlnaHQ6IFwiYm9sZFwiLCBjaGlsZHJlbjogW1xuICAgICAgICAgICAgICBcIlBhcnRpY2lwYW50cyAoXCIsXG4gICAgICAgICAgICAgIHBhcnRpY2lwYW50cy5sZW5ndGgsXG4gICAgICAgICAgICAgIFwiKVwiXG4gICAgICAgICAgICBdIH0pXG4gICAgICAgICAgXSB9KSB9KSxcbiAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjMoU3R5bGVkTGlzdDIsIHsgY2hpbGRyZW46IHBhcnRpY2lwYW50cy5tYXAoKHBhcnRpY2lwYW50KSA9PiAvKiBAX19QVVJFX18gKi8ganN4czE0KFN0eWxlZExpc3RJdGVtLCB7IGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjMoTGlzdEl0ZW1JY29uLCB7IHN4OiB7IG1pbldpZHRoOiAzNiB9LCBjaGlsZHJlbjogcmVuZGVyUGFydGljaXBhbnQgPyByZW5kZXJQYXJ0aWNpcGFudChwYXJ0aWNpcGFudCkgOiAvKiBAX19QVVJFX18gKi8ganN4MjMoUGFydGljaXBhbnRBdmF0YXIsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gyMyhcbiAgICAgICAgICAgICAgVHlwb2dyYXBoeTExLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyaWFudDogXCJjYXB0aW9uXCIsXG4gICAgICAgICAgICAgICAgc3g6IHsgZm9udFNpemU6IFwiMC45cmVtXCIsIGZvbnRXZWlnaHQ6IDUwMCB9LFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBwYXJ0aWNpcGFudC5uYW1lLnNwbGl0KFwiIFwiKS5tYXAoKHdvcmQpID0+IHdvcmRbMF0pLmpvaW4oXCJcIikudG9VcHBlckNhc2UoKS5zbGljZSgwLCAyKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApIH0pIH0pLFxuICAgICAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeDIzKFxuICAgICAgICAgICAgICBMaXN0SXRlbVRleHQsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmltYXJ5OiAvKiBAX19QVVJFX18gKi8ganN4MjMoVHlwb2dyYXBoeTExLCB7IHZhcmlhbnQ6IFwiYm9keTJcIiwgZm9udFdlaWdodDogNTAwLCBjaGlsZHJlbjogcGFydGljaXBhbnQubmFtZSB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICAgXSB9LCBwYXJ0aWNpcGFudC5pZCkpIH0pXG4gICAgICAgIF1cbiAgICAgIH1cbiAgICApXG4gIF0gfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdFBvcHVwL2NvbXBvbmVudHMvSGVhZGVyL0hlYWRlck1lbnUudHN4XG5pbXBvcnQgeyBGcmFnbWVudCBhcyBGcmFnbWVudDUsIGpzeCBhcyBqc3gyNCwganN4cyBhcyBqc3hzMTUgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBIZWFkZXJNZW51ID0gKHtcbiAgcGFydGljaXBhbnRzLFxuICByZW5kZXJQYXJ0aWNpcGFudCxcbiAgYWxsQXR0YWNobWVudHNcbn0pID0+IHtcbiAgY29uc3QgW2FuY2hvckVsLCBzZXRBbmNob3JFbF0gPSB1c2VTdGF0ZTkobnVsbCk7XG4gIGNvbnN0IFtpc0RvY3VtZW50c09wZW4sIHNldElzRG9jdW1lbnRzT3Blbl0gPSB1c2VTdGF0ZTkoZmFsc2UpO1xuICBjb25zdCBbaXNQYXJ0aWNpcGFudHNPcGVuLCBzZXRJc1BhcnRpY2lwYW50c09wZW5dID0gdXNlU3RhdGU5KGZhbHNlKTtcbiAgY29uc3Qgb3BlbiA9IEJvb2xlYW4oYW5jaG9yRWwpO1xuICBjb25zdCBoYW5kbGVDbGljayA9IChldmVudCkgPT4ge1xuICAgIHNldEFuY2hvckVsKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICB9O1xuICBjb25zdCBoYW5kbGVDbG9zZSA9ICgpID0+IHtcbiAgICBzZXRBbmNob3JFbChudWxsKTtcbiAgICBzZXRJc0RvY3VtZW50c09wZW4oZmFsc2UpO1xuICAgIHNldElzUGFydGljaXBhbnRzT3BlbihmYWxzZSk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZURvY3VtZW50Q2xpY2sgPSAoZSkgPT4ge1xuICAgIHNldElzRG9jdW1lbnRzT3Blbih0cnVlKTtcbiAgICBzZXRJc1BhcnRpY2lwYW50c09wZW4oZmFsc2UpO1xuICB9O1xuICBjb25zdCBoYW5kbGVQYXJ0aWNpcGFudHNDbGljayA9IChlKSA9PiB7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBzZXRJc1BhcnRpY2lwYW50c09wZW4odHJ1ZSk7XG4gICAgc2V0SXNEb2N1bWVudHNPcGVuKGZhbHNlKTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlRG9jdW1lbnRDbG9zZSA9ICgpID0+IHtcbiAgICBzZXRJc0RvY3VtZW50c09wZW4oZmFsc2UpO1xuICB9O1xuICBjb25zdCBoYW5kbGVQYXJ0aWNpcGFudHNDbG9zZSA9ICgpID0+IHtcbiAgICBzZXRJc1BhcnRpY2lwYW50c09wZW4oZmFsc2UpO1xuICB9O1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMxNShGcmFnbWVudDUsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MjQoVG9vbHRpcDQsIHsgdGl0bGU6IFwiT3B0aW9uc1wiLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDI0KFxuICAgICAgSWNvbkJ1dHRvbjgsXG4gICAgICB7XG4gICAgICAgIG9uQ2xpY2s6IGhhbmRsZUNsaWNrLFxuICAgICAgICBzaXplOiBcInNtYWxsXCIsXG4gICAgICAgIHN4OiB7XG4gICAgICAgICAgY29sb3I6ICh0aGVtZSkgPT4gdGhlbWUucGFsZXR0ZS50ZXh0LnNlY29uZGFyeSxcbiAgICAgICAgICBwYWRkaW5nOiAwLjUsXG4gICAgICAgICAgXCImOmhvdmVyXCI6IHtcbiAgICAgICAgICAgIGNvbG9yOiAodGhlbWUpID0+IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5tYWluXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDI0KE1vcmVWZXJ0SWNvbiwgeyBmb250U2l6ZTogXCJzbWFsbFwiIH0pXG4gICAgICB9XG4gICAgKSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4czE1KFxuICAgICAgTWVudSxcbiAgICAgIHtcbiAgICAgICAgYW5jaG9yRWwsXG4gICAgICAgIG9wZW4sXG4gICAgICAgIG9uQ2xvc2U6IGhhbmRsZUNsb3NlLFxuICAgICAgICBhbmNob3JPcmlnaW46IHtcbiAgICAgICAgICB2ZXJ0aWNhbDogXCJib3R0b21cIixcbiAgICAgICAgICBob3Jpem9udGFsOiBcInJpZ2h0XCJcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmb3JtT3JpZ2luOiB7XG4gICAgICAgICAgdmVydGljYWw6IFwidG9wXCIsXG4gICAgICAgICAgaG9yaXpvbnRhbDogXCJyaWdodFwiXG4gICAgICAgIH0sXG4gICAgICAgIG9uQ2xpY2s6IChlKSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpLFxuICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzMTUoTWVudUl0ZW0sIHsgb25DbGljazogaGFuZGxlRG9jdW1lbnRDbGljaywgY2hpbGRyZW46IFtcbiAgICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3gyNChcbiAgICAgICAgICAgICAgRG9jdW1lbnRzTWVudSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFsbEF0dGFjaG1lbnRzLFxuICAgICAgICAgICAgICAgIG9wZW46IGlzRG9jdW1lbnRzT3BlbixcbiAgICAgICAgICAgICAgICBvbkNsb3NlOiBoYW5kbGVEb2N1bWVudENsb3NlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICksXG4gICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjQoVHlwb2dyYXBoeTEyLCB7IHZhcmlhbnQ6IFwiYm9keTJcIiwgY2hpbGRyZW46IFwiRG9jdW1lbnRzXCIgfSlcbiAgICAgICAgICBdIH0pLFxuICAgICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzMTUoTWVudUl0ZW0sIHsgb25DbGljazogaGFuZGxlUGFydGljaXBhbnRzQ2xpY2ssIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjQoXG4gICAgICAgICAgICAgIFBhcnRpY2lwYW50c01lbnUsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudHMsXG4gICAgICAgICAgICAgICAgcmVuZGVyUGFydGljaXBhbnQsXG4gICAgICAgICAgICAgICAgb3BlbjogaXNQYXJ0aWNpcGFudHNPcGVuLFxuICAgICAgICAgICAgICAgIG9uQ2xvc2U6IGhhbmRsZVBhcnRpY2lwYW50c0Nsb3NlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICksXG4gICAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjQoVHlwb2dyYXBoeTEyLCB7IHZhcmlhbnQ6IFwiYm9keTJcIiwgY2hpbGRyZW46IFwiUGFydGljaXBhbnRzXCIgfSlcbiAgICAgICAgICBdIH0pXG4gICAgICAgIF1cbiAgICAgIH1cbiAgICApXG4gIF0gfSk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdFBvcHVwL2NvbXBvbmVudHMvSGVhZGVyL2luZGV4LnRzeFxuaW1wb3J0IE9wZW5JbkZ1bGwgZnJvbSBcIkBtdWkvaWNvbnMtbWF0ZXJpYWwvT3BlbkluRnVsbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDEyIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWwvc3R5bGVzXCI7XG5pbXBvcnQgeyBGcmFnbWVudCBhcyBGcmFnbWVudDYsIGpzeCBhcyBqc3gyNSwganN4cyBhcyBqc3hzMTYgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBIZWFkZXJDb250YWluZXIgPSBzdHlsZWQxMihCb3gyNykoKHsgdGhlbWUgfSkgPT4gKHtcbiAgcGFkZGluZzogdGhlbWUuc3BhY2luZygxLjUpLFxuICBib3JkZXJCb3R0b206IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLmRpdmlkZXJ9YCxcbiAgYmFja2dyb3VuZDogdGhlbWUucGFsZXR0ZS5iYWNrZ3JvdW5kLnBhcGVyLFxuICBjb2xvcjogdGhlbWUucGFsZXR0ZS50ZXh0LnByaW1hcnksXG4gIGRpc3BsYXk6IFwiZmxleFwiLFxuICBqdXN0aWZ5Q29udGVudDogXCJzcGFjZS1iZXR3ZWVuXCIsXG4gIGFsaWduSXRlbXM6IFwiY2VudGVyXCIsXG4gIGJvcmRlclRvcExlZnRSYWRpdXM6IFwiMTZweFwiLFxuICBib3JkZXJUb3BSaWdodFJhZGl1czogXCIxNnB4XCJcbn0pKTtcbnZhciBVc2VySW5mbyA9IHN0eWxlZDEyKEJveDI3KSgoeyB0aGVtZSB9KSA9PiAoe1xuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAgZ2FwOiB0aGVtZS5zcGFjaW5nKDEpXG59KSk7XG52YXIgVXNlckF2YXRhcjIgPSBzdHlsZWQxMihCb3gyNykoKHsgdGhlbWUgfSkgPT4gKHtcbiAgd2lkdGg6IDMyLFxuICBoZWlnaHQ6IDMyLFxuICBib3JkZXJSYWRpdXM6IFwiNTAlXCIsXG4gIG92ZXJmbG93OiBcImhpZGRlblwiLFxuICBkaXNwbGF5OiBcImZsZXhcIixcbiAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAganVzdGlmeUNvbnRlbnQ6IFwiY2VudGVyXCIsXG4gIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5wcmltYXJ5Lm1haW4sXG4gIGNvbG9yOiB0aGVtZS5wYWxldHRlLnByaW1hcnkuY29udHJhc3RUZXh0LFxuICBmb250U2l6ZTogXCIwLjlyZW1cIixcbiAgZm9udFdlaWdodDogNTAwLFxuICBcIiYgaW1nXCI6IHtcbiAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgaGVpZ2h0OiBcIjEwMCVcIixcbiAgICBvYmplY3RGaXQ6IFwiY292ZXJcIlxuICB9XG59KSk7XG52YXIgVXNlck5hbWUgPSBzdHlsZWQxMihUeXBvZ3JhcGh5MTMpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGZvbnRTaXplOiBcIjAuOXJlbVwiLFxuICBmb250V2VpZ2h0OiA2MDAsXG4gIG1hcmdpbjogMCxcbiAgbGluZUhlaWdodDogMS4yXG59KSk7XG52YXIgQWN0aW9uQnV0dG9uID0gc3R5bGVkMTIoSWNvbkJ1dHRvbjkpKCh7IHRoZW1lIH0pID0+ICh7XG4gIGNvbG9yOiB0aGVtZS5wYWxldHRlLnRleHQuc2Vjb25kYXJ5LFxuICBwYWRkaW5nOiAwLjUsXG4gIFwiJjpob3ZlclwiOiB7XG4gICAgY29sb3I6IHRoZW1lLnBhbGV0dGUucHJpbWFyeS5tYWluXG4gIH1cbn0pKTtcbnZhciBIZWFkZXIgPSAoe1xuICB0aXRsZSxcbiAgb25DbG9zZSxcbiAgb25FeHBhbmQsXG4gIGlzRXhwYW5kZWQsXG4gIGF2YXRhcixcbiAgcGFydGljaXBhbnRzID0gW10sXG4gIHJlbmRlclBhcnRpY2lwYW50LFxuICBhbGxBdHRhY2htZW50cyxcbiAgY29udmVyc2F0aW9uSWRcbn0pID0+IHtcbiAgY29uc3QgW2lzRG9jdW1lbnRzT3Blbiwgc2V0SXNEb2N1bWVudHNPcGVuXSA9IHVzZVN0YXRlMTAoZmFsc2UpO1xuICBjb25zdCBbaXNQYXJ0aWNpcGFudHNPcGVuLCBzZXRJc1BhcnRpY2lwYW50c09wZW5dID0gdXNlU3RhdGUxMChmYWxzZSk7XG4gIGNvbnN0IGhhbmRsZURvY3VtZW50Q2xvc2UgPSAoKSA9PiBzZXRJc0RvY3VtZW50c09wZW4oZmFsc2UpO1xuICBjb25zdCBoYW5kbGVQYXJ0aWNpcGFudHNDbG9zZSA9ICgpID0+IHNldElzUGFydGljaXBhbnRzT3BlbihmYWxzZSk7XG4gIGNvbnN0IHJlbmRlckFjdGlvbkJ1dHRvbnMgPSAoKSA9PiB7XG4gICAgaWYgKGlzRXhwYW5kZWQgJiYgY29udmVyc2F0aW9uSWQpIHtcbiAgICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4czE2KEZyYWdtZW50NiwgeyBjaGlsZHJlbjogW1xuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjUoQWN0aW9uQnV0dG9uLCB7IHNpemU6IFwic21hbGxcIiwgb25DbGljazogKCkgPT4gc2V0SXNEb2N1bWVudHNPcGVuKHRydWUpLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDI1KFxuICAgICAgICAgIERvY3VtZW50c01lbnUsXG4gICAgICAgICAge1xuICAgICAgICAgICAgYWxsQXR0YWNobWVudHMsXG4gICAgICAgICAgICBvcGVuOiBpc0RvY3VtZW50c09wZW4sXG4gICAgICAgICAgICBvbkNsb3NlOiBoYW5kbGVEb2N1bWVudENsb3NlXG4gICAgICAgICAgfVxuICAgICAgICApIH0pLFxuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjUoXG4gICAgICAgICAgQWN0aW9uQnV0dG9uLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHNpemU6IFwic21hbGxcIixcbiAgICAgICAgICAgIG9uQ2xpY2s6ICgpID0+IHNldElzUGFydGljaXBhbnRzT3Blbih0cnVlKSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4MjUoXG4gICAgICAgICAgICAgIFBhcnRpY2lwYW50c01lbnUsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudHMsXG4gICAgICAgICAgICAgICAgcmVuZGVyUGFydGljaXBhbnQsXG4gICAgICAgICAgICAgICAgb3BlbjogaXNQYXJ0aWNpcGFudHNPcGVuLFxuICAgICAgICAgICAgICAgIG9uQ2xvc2U6IGhhbmRsZVBhcnRpY2lwYW50c0Nsb3NlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgIF0gfSk7XG4gICAgfVxuICAgIGlmIChjb252ZXJzYXRpb25JZCkge1xuICAgICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3gyNShcbiAgICAgICAgSGVhZGVyTWVudSxcbiAgICAgICAge1xuICAgICAgICAgIGFsbEF0dGFjaG1lbnRzLFxuICAgICAgICAgIHBhcnRpY2lwYW50cyxcbiAgICAgICAgICByZW5kZXJQYXJ0aWNpcGFudFxuICAgICAgICB9XG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzMTYoSGVhZGVyQ29udGFpbmVyLCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeHMxNihVc2VySW5mbywgeyBjaGlsZHJlbjogW1xuICAgICAgYXZhdGFyICYmIC8qIEBfX1BVUkVfXyAqLyBqc3gyNShVc2VyQXZhdGFyMiwgeyBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDI1KFwiaW1nXCIsIHsgc3JjOiBhdmF0YXIsIGFsdDogXCJ0aXRsZVwiIH0pIH0pLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeDI1KEJveDI3LCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4MjUoVXNlck5hbWUsIHsgdmFyaWFudDogXCJzdWJ0aXRsZTFcIiwgY2hpbGRyZW46IHRpdGxlIH0pIH0pXG4gICAgXSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4czE2KEJveDI3LCB7IHN4OiB7IGRpc3BsYXk6IFwiZmxleFwiLCBnYXA6IDEgfSwgY2hpbGRyZW46IFtcbiAgICAgIHJlbmRlckFjdGlvbkJ1dHRvbnMoKSxcbiAgICAgIG9uRXhwYW5kICYmIC8qIEBfX1BVUkVfXyAqLyBqc3gyNShcbiAgICAgICAgQWN0aW9uQnV0dG9uLFxuICAgICAgICB7XG4gICAgICAgICAgb25DbGljazogb25FeHBhbmQsXG4gICAgICAgICAgc2l6ZTogXCJzbWFsbFwiLFxuICAgICAgICAgIHN4OiB7XG4gICAgICAgICAgICB0cmFuc2Zvcm06IGlzRXhwYW5kZWQgPyBcInJvdGF0ZSgxODBkZWcpXCIgOiBcIm5vbmVcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgY2hpbGRyZW46IGlzRXhwYW5kZWQgPyAvKiBAX19QVVJFX18gKi8ganN4MjUoQ2xvc2VGdWxsc2NyZWVuLCB7IGZvbnRTaXplOiBcInNtYWxsXCIgfSkgOiAvKiBAX19QVVJFX18gKi8ganN4MjUoT3BlbkluRnVsbCwgeyBmb250U2l6ZTogXCJzbWFsbFwiIH0pXG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICAvKiBAX19QVVJFX18gKi8ganN4MjUoQWN0aW9uQnV0dG9uLCB7IG9uQ2xpY2s6IG9uQ2xvc2UsIHNpemU6IFwic21hbGxcIiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gyNShDbG9zZSwgeyBmb250U2l6ZTogXCJzbWFsbFwiIH0pIH0pXG4gICAgXSB9KVxuICBdIH0pO1xufTtcbnZhciBIZWFkZXJfZGVmYXVsdCA9IEhlYWRlcjtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0NoYXRQb3B1cC9zdHlsZS50c1xuaW1wb3J0IHsgUGFwZXIgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDEzIH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWwvc3R5bGVzXCI7XG52YXIgU3R5bGVkUGFwZXIgPSBzdHlsZWQxMyhQYXBlciwge1xuICBzaG91bGRGb3J3YXJkUHJvcDogKHByb3ApID0+IHByb3AgIT09IFwiaXNDbG9zaW5nXCIgJiYgcHJvcCAhPT0gXCJpc0V4cGFuZGVkXCJcbn0pKFxuICAoeyB0aGVtZSwgaXNDbG9zaW5nLCBpc0V4cGFuZGVkIH0pID0+ICh7XG4gICAgcG9zaXRpb246IFwiZml4ZWRcIixcbiAgICBib3R0b206IHRoZW1lLnNwYWNpbmcoMTIpLFxuICAgIHJpZ2h0OiB0aGVtZS5zcGFjaW5nKDQpLFxuICAgIHdpZHRoOiBpc0V4cGFuZGVkID8gXCI4MCVcIiA6IDM1MCxcbiAgICBoZWlnaHQ6IGlzRXhwYW5kZWQgPyBcIjgwdmhcIiA6IDUwMCxcbiAgICB6SW5kZXg6IDFlMyxcbiAgICBkaXNwbGF5OiBcImZsZXhcIixcbiAgICBmbGV4RGlyZWN0aW9uOiBcImNvbHVtblwiLFxuICAgIGdhcDogdGhlbWUuc3BhY2luZygxKSxcbiAgICBvdmVyZmxvdzogXCJoaWRkZW5cIixcbiAgICB0cmFuc2Zvcm1PcmlnaW46IFwiYm90dG9tIHJpZ2h0XCIsXG4gICAgYm9yZGVyUmFkaXVzOiBcIjE2cHhcIixcbiAgICBib3hTaGFkb3c6IGBcbiAgICAgIDAgOHB4IDMycHggcmdiYSgwLCAwLCAwLCAwLjEpLFxuICAgICAgMCAwIDAgMXB4ICR7dGhlbWUucGFsZXR0ZS5wcmltYXJ5LmRhcmt9MzMsXG4gICAgICAwIDAgMCAycHggJHt0aGVtZS5wYWxldHRlLnByaW1hcnkuZGFya30xMVxuICAgIGAsXG4gICAgYm9yZGVyOiBgMXB4IHNvbGlkICR7dGhlbWUucGFsZXR0ZS5wcmltYXJ5LmRhcmt9MzNgLFxuICAgIGJhY2tkcm9wRmlsdGVyOiBcImJsdXIoMTBweClcIixcbiAgICBiYWNrZ3JvdW5kOiBgbGluZWFyLWdyYWRpZW50KDE4MGRlZywgXG4gICAgICAke3RoZW1lLnBhbGV0dGUuYmFja2dyb3VuZC5wYXBlcn0gMCUsIFxuICAgICAgJHt0aGVtZS5wYWxldHRlLmJhY2tncm91bmQucGFwZXJ9IDEwMCVcbiAgICApYCxcbiAgICB0cmFuc2l0aW9uOiBcImFsbCAwLjNzIGVhc2UtaW4tb3V0XCIsXG4gICAgdHJhbnNmb3JtOiBpc0Nsb3NpbmcgPyBcInNjYWxlKDAuOTUpIHRyYW5zbGF0ZVkoMjBweClcIiA6IFwic2NhbGUoMSlcIixcbiAgICBvcGFjaXR5OiBpc0Nsb3NpbmcgPyAwIDogMSxcbiAgICB2aXNpYmlsaXR5OiBpc0Nsb3NpbmcgPyBcImhpZGRlblwiIDogXCJ2aXNpYmxlXCIsXG4gICAgYW5pbWF0aW9uOiAhaXNDbG9zaW5nID8gXCJwb3BJbiAwLjNzIGVhc2Utb3V0XCIgOiBcIm5vbmVcIixcbiAgICBcIiYubG9hZGluZ1wiOiB7XG4gICAgICBvdmVyZmxvdzogXCJoaWRkZW5cIlxuICAgIH0sXG4gICAgXCJAa2V5ZnJhbWVzIHBvcEluXCI6IHtcbiAgICAgIFwiMCVcIjoge1xuICAgICAgICB0cmFuc2Zvcm06IFwic2NhbGUoMC45NSkgdHJhbnNsYXRlWSgyMHB4KVwiLFxuICAgICAgICBvcGFjaXR5OiAwXG4gICAgICB9LFxuICAgICAgXCIxMDAlXCI6IHtcbiAgICAgICAgdHJhbnNmb3JtOiBcInNjYWxlKDEpIHRyYW5zbGF0ZVkoMClcIixcbiAgICAgICAgb3BhY2l0eTogMVxuICAgICAgfVxuICAgIH1cbiAgfSlcbik7XG5cbi8vIHNyYy9jbGllbnQvY29tcG9uZW50cy9DaGF0UG9wdXAvaW5kZXgudHN4XG5pbXBvcnQgeyBqc3ggYXMganN4MjYsIGpzeHMgYXMganN4czE3IH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG52YXIgQ2hhdFBvcHVwID0gKHtcbiAgb3BlbixcbiAgb25DbG9zZSxcbiAgY29udmVyc2F0aW9uSWQsXG4gIHRpdGxlID0gXCJDaGF0XCIsXG4gIGF2YXRhcixcbiAgZGVmYXVsdE1lc3NhZ2VzLFxuICBwYXJ0aWNpcGFudHMsXG4gIG9uUmVjZWl2ZU1lc3NhZ2UsXG4gIG9uU2VuZE1lc3NhZ2UsXG4gIGNvbmZpZyxcbiAgcmVuZGVyUGFydGljaXBhbnQsXG4gIGlzTG9hZGluZyxcbiAgb25NZXNzYWdlU2VlbixcbiAgb25Mb2FkTW9yZU1lc3NhZ2VzLFxuICBhbGxBdHRhY2htZW50cyxcbiAgdG90YWxNZXNzYWdlcyxcbiAgYnV0dG9uSm9pblxufSkgPT4ge1xuICBjb25zdCBbaXNDbG9zaW5nLCBzZXRJc0Nsb3NpbmddID0gUmVhY3QxMy51c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtpc0V4cGFuZGVkLCBzZXRJc0V4cGFuZGVkXSA9IFJlYWN0MTMudXNlU3RhdGUoZmFsc2UpO1xuICB1c2VFZmZlY3Q4KCgpID0+IHtcbiAgICBpZiAoIW9wZW4pIHtcbiAgICAgIHNldElzQ2xvc2luZyh0cnVlKTtcbiAgICAgIGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHNldElzQ2xvc2luZyhmYWxzZSk7XG4gICAgICB9LCAzMDApO1xuICAgICAgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgfVxuICB9LCBbb3Blbl0pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeHMxNyhcbiAgICBTdHlsZWRQYXBlcixcbiAgICB7XG4gICAgICBlbGV2YXRpb246IDMsXG4gICAgICBpc0Nsb3NpbmcsXG4gICAgICBpc0V4cGFuZGVkLFxuICAgICAgc3R5bGU6IHtcbiAgICAgICAgZGlzcGxheTogIW9wZW4gJiYgIWlzQ2xvc2luZyA/IFwibm9uZVwiIDogXCJmbGV4XCIsXG4gICAgICAgIHBvaW50ZXJFdmVudHM6ICFvcGVuICYmICFpc0Nsb3NpbmcgPyBcIm5vbmVcIiA6IFwiYXV0b1wiXG4gICAgICB9LFxuICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeDI2KFxuICAgICAgICAgIEhlYWRlcl9kZWZhdWx0LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgb25DbG9zZTogKCkgPT4ge1xuICAgICAgICAgICAgICBzZXRJc0Nsb3NpbmcodHJ1ZSk7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9uQ2xvc2UoKTtcbiAgICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhbGxBdHRhY2htZW50cyxcbiAgICAgICAgICAgIG9uRXhwYW5kOiAoKSA9PiBzZXRJc0V4cGFuZGVkKCFpc0V4cGFuZGVkKSxcbiAgICAgICAgICAgIGlzRXhwYW5kZWQsXG4gICAgICAgICAgICBhdmF0YXIsXG4gICAgICAgICAgICBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgICAgIHBhcnRpY2lwYW50cyxcbiAgICAgICAgICAgIHJlbmRlclBhcnRpY2lwYW50XG4gICAgICAgICAgfVxuICAgICAgICApLFxuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4MjYoXG4gICAgICAgICAgQ2hhdCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBjb25maWcsXG4gICAgICAgICAgICBwYXJ0aWNpcGFudHMsXG4gICAgICAgICAgICBpc0xvYWRpbmcsXG4gICAgICAgICAgICBkZWZhdWx0TWVzc2FnZXMsXG4gICAgICAgICAgICBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgICAgIG9uUmVjZWl2ZU1lc3NhZ2UsXG4gICAgICAgICAgICBvblNlbmRNZXNzYWdlLFxuICAgICAgICAgICAgb25NZXNzYWdlU2VlbixcbiAgICAgICAgICAgIG9uTG9hZE1vcmVNZXNzYWdlcyxcbiAgICAgICAgICAgIHRvdGFsTWVzc2FnZXMsXG4gICAgICAgICAgICBidXR0b25Kb2luXG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICBdXG4gICAgfVxuICApO1xufTtcblxuLy8gc3JjL2NsaWVudC9jb21wb25lbnRzL0Zsb2F0aW5nQnV0dG9uL2luZGV4LnRzeFxuaW1wb3J0IHsgWm9vbSwgdXNlVGhlbWUgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvRmxvYXRpbmdCdXR0b24vc3R5bGVzLnRzXG5pbXBvcnQgeyBGYWIgfSBmcm9tIFwiQG11aS9tYXRlcmlhbFwiO1xuaW1wb3J0IHsgc3R5bGVkIGFzIHN0eWxlZDE0IH0gZnJvbSBcIkBtdWkvbWF0ZXJpYWwvc3R5bGVzXCI7XG52YXIgU3R5bGVkRmFiID0gc3R5bGVkMTQoRmFiKSgoeyB0aGVtZSB9KSA9PiAoe1xuICBwb3NpdGlvbjogXCJmaXhlZFwiLFxuICBib3R0b206IHRoZW1lLnNwYWNpbmcoNCksXG4gIHJpZ2h0OiB0aGVtZS5zcGFjaW5nKDQpLFxuICB6SW5kZXg6IDFlM1xufSkpO1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvRmxvYXRpbmdCdXR0b24vaW5kZXgudHN4XG5pbXBvcnQgeyBqc3ggYXMganN4MjcgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbnZhciBGbG9hdGluZ0J1dHRvbiA9ICh7XG4gIGljb24sXG4gIG9uQ2xpY2ssXG4gIGNvbG9yID0gXCJwcmltYXJ5XCIsXG4gIHNpemUgPSBcImxhcmdlXCIsXG4gIHN4LFxuICB0b29sdGlwXG59KSA9PiB7XG4gIGNvbnN0IHRoZW1lID0gdXNlVGhlbWUoKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3gyNyhcbiAgICBab29tLFxuICAgIHtcbiAgICAgIGluOiB0cnVlLFxuICAgICAgdGltZW91dDoge1xuICAgICAgICBlbnRlcjogMjI1LFxuICAgICAgICBleGl0OiAxOTVcbiAgICAgIH0sXG4gICAgICBzdHlsZToge1xuICAgICAgICB0cmFuc2l0aW9uRGVsYXk6IFwiMG1zXCJcbiAgICAgIH0sXG4gICAgICB1bm1vdW50T25FeGl0OiB0cnVlLFxuICAgICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3gyNyhcbiAgICAgICAgU3R5bGVkRmFiLFxuICAgICAgICB7XG4gICAgICAgICAgb25DbGljayxcbiAgICAgICAgICBjb2xvcixcbiAgICAgICAgICBzaXplLFxuICAgICAgICAgIFwiYXJpYS1sYWJlbFwiOiB0b29sdGlwLFxuICAgICAgICAgIHN4LFxuICAgICAgICAgIGNoaWxkcmVuOiBpY29uXG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9XG4gICk7XG59O1xuXG4vLyBzcmMvY2xpZW50L2NvbXBvbmVudHMvQ2hhdEJ1YmJsZS9pbmRleC50c3hcbmltcG9ydCB7IEZyYWdtZW50IGFzIEZyYWdtZW50NywganN4IGFzIGpzeDI4LCBqc3hzIGFzIGpzeHMxOCB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xudmFyIENoYXRCdWJibGUgPSAoe1xuICBvbkNsaWNrLFxuICB1bnJlYWRDb3VudCA9IDAsXG4gIGNvbG9yID0gXCJwcmltYXJ5XCIsXG4gIHRpdGxlID0gXCJDaGF0XCIsXG4gIGNvbnZlcnNhdGlvbklkLFxuICBkZWZhdWx0TWVzc2FnZXMsXG4gIHBhcnRpY2lwYW50cyxcbiAgb25SZWNlaXZlTWVzc2FnZSxcbiAgb25TZW5kTWVzc2FnZSxcbiAgcmVuZGVyUGFydGljaXBhbnQsXG4gIGNvbmZpZyxcbiAgaXNMb2FkaW5nLFxuICBvbk1lc3NhZ2VTZWVuLFxuICBvbkxvYWRNb3JlTWVzc2FnZXMsXG4gIGFsbEF0dGFjaG1lbnRzLFxuICB0b3RhbE1lc3NhZ2VzLFxuICBidXR0b25Kb2luXG59KSA9PiB7XG4gIGNvbnN0IFtpc09wZW4sIHNldElzT3Blbl0gPSB1c2VTdGF0ZTExKGZhbHNlKTtcbiAgY29uc3QgaGFuZGxlQ2xpY2sgPSAoKSA9PiB7XG4gICAgc2V0SXNPcGVuKCFpc09wZW4pO1xuICAgIG9uQ2xpY2sgPT0gbnVsbCA/IHZvaWQgMCA6IG9uQ2xpY2soKTtcbiAgfTtcbiAgY29uc3QgaWNvbiA9IHVucmVhZENvdW50ID4gMCA/IC8qIEBfX1BVUkVfXyAqLyBqc3gyOChCYWRnZSwgeyBiYWRnZUNvbnRlbnQ6IHVucmVhZENvdW50LCBjb2xvcjogXCJlcnJvclwiLCBtYXg6IDk5LCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeDI4KENoYXRJY29uLCB7fSkgfSkgOiAvKiBAX19QVVJFX18gKi8ganN4MjgoQ2hhdEljb24sIHt9KTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzMTgoRnJhZ21lbnQ3LCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeDI4KFxuICAgICAgRmxvYXRpbmdCdXR0b24sXG4gICAgICB7XG4gICAgICAgIGljb24sXG4gICAgICAgIG9uQ2xpY2s6IGhhbmRsZUNsaWNrLFxuICAgICAgICBjb2xvcixcbiAgICAgICAgdG9vbHRpcDogXCJPdXZyaXIgbGUgY2hhdFwiLFxuICAgICAgICBzeDoge1xuICAgICAgICAgIFwiJjpob3ZlclwiOiB7XG4gICAgICAgICAgICB0cmFuc2Zvcm06IFwic2NhbGUoMS4xKVwiXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgKSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4MjgoXG4gICAgICBDaGF0UG9wdXAsXG4gICAgICB7XG4gICAgICAgIHBhcnRpY2lwYW50cyxcbiAgICAgICAgcmVuZGVyUGFydGljaXBhbnQsXG4gICAgICAgIG9wZW46IGlzT3BlbixcbiAgICAgICAgb25DbG9zZTogKCkgPT4gc2V0SXNPcGVuKGZhbHNlKSxcbiAgICAgICAgdGl0bGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgICBkZWZhdWx0TWVzc2FnZXMsXG4gICAgICAgIG9uUmVjZWl2ZU1lc3NhZ2UsXG4gICAgICAgIG9uU2VuZE1lc3NhZ2UsXG4gICAgICAgIG9uTWVzc2FnZVNlZW4sXG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgaXNMb2FkaW5nLFxuICAgICAgICBvbkxvYWRNb3JlTWVzc2FnZXMsXG4gICAgICAgIGFsbEF0dGFjaG1lbnRzLFxuICAgICAgICB0b3RhbE1lc3NhZ2VzLFxuICAgICAgICBidXR0b25Kb2luXG4gICAgICB9XG4gICAgKVxuICBdIH0pO1xufTtcbmV4cG9ydCB7XG4gIENoYXQsXG4gIENoYXRCdWJibGUsXG4gIEZpbGVJdGVtLFxuICBOZXh0UHVzaGVyQ2hhdFByb3ZpZGVyLFxuICBQT1NUMyBhcyBQT1NULFxuICBQYWdlc1JvdXRlckFkYXB0ZXIsXG4gIGdldE9yQ3JlYXRlU3Vic2NyaXB0aW9uLFxuICBwdXNoZXJFdmVudCxcbiAgcHVzaGVyU3Vic2NyaXB0aW9ucyxcbiAgdXNlQ2hhdCxcbiAgdXNlQ2hhdFN1YnNjcmliZSxcbiAgdXNlTmV4dFB1c2hlckNoYXRcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../packages/next-pusher-chat/dist/index.mjs\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.28_react-dom@18.3.1_react@18.3.1","vendor-chunks/emoji-picker-react@4.12.2_react@18.3.1","vendor-chunks/flairup@1.0.0","vendor-chunks/uuid@11.1.0"], () => (__webpack_exec__("(api)/../../node_modules/.pnpm/next@14.2.28_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cchat%5Cindex.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();